<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ ¡ç‰©ç† - åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡</title>
    <script>
      window.MathJax = {
      tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
     }
     };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .back-link {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        h1 {
            color: #333;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        .tab-btn:hover {
            background: #8899f0;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        h3 {
            color: #555;
            margin: 25px 0 15px 0;
            border-left: 4px solid #667eea;
            padding-left: 10px;
        }
        .pdf-placeholder {
            background: #f9f9f9;
            padding: 40px;
            text-align: center;
            border-radius: 5px;
            color: #666;
        }
        .explanation {
            line-height: 1.8;
            color: #333;
        }
        .explanation p {
            margin-bottom: 15px;
        }
        .key-point {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border-left: 5px solid #f39c12;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        .key-point-title {
            font-weight: bold;
            color: #d68910;
            margin-bottom: 8px;
        }
        .formula-box {
            background: linear-gradient(135deg, #e8f4fd 0%, #d6eaf8 100%);
            border: 2px solid #3498db;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: center;
        }
        .formula-box .formula-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 10px;
        }
        .diagram-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin: 20px 0;
        }
        .diagram-box {
            background: #f9f9f9;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            min-width: 280px;
            flex: 1;
            max-width: 400px;
        }
        .diagram-box canvas {
            display: block;
            margin: 0 auto 10px auto;
            border: 1px solid #eee;
            background: white;
        }
        .diagram-caption {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
        }
        
        /* ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        #sim-container, .sim-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        #physicsCanvas, .physics-canvas {
            display: block;
            width: 100%;
            background: white;
            border-radius: 5px;
            border: 2px solid #ddd;
        }
        .sim-controls {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .control-group input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .value-display {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 100px;
            text-align: center;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .sim-button {
            min-width: 120px;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .sim-button.start {
            background: #4CAF50;
            color: white;
        }
        .sim-button.start:hover {
            background: #45a049;
        }
        .sim-button.reset {
            background: #f44336;
            color: white;
        }
        .sim-button.reset:hover {
            background: #da190b;
        }
        .sim-button.stop {
            background: #ff9800;
            color: white;
        }
        .sim-button.stop:hover {
            background: #f57c00;
        }
        .energy-display {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 15px;
            justify-content: center;
        }
        .energy-bar-container {
            flex: 1;
            min-width: 200px;
            max-width: 300px;
        }
        .energy-bar-label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 14px;
        }
        .energy-bar {
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }
        .energy-bar-fill {
            height: 100%;
            border-radius: 15px;
            transition: width 0.1s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }
        .energy-bar-fill.kinetic {
            background: linear-gradient(90deg, #e74c3c, #c0392b);
        }
        .energy-bar-fill.potential {
            background: linear-gradient(90deg, #3498db, #2980b9);
        }
        .energy-bar-fill.elastic {
            background: linear-gradient(90deg, #2ecc71, #27ae60);
        }
        .sim-formula {
            background: #fff;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            text-align: center;
        }
        .sim-section {
            margin-bottom: 40px;
            padding-bottom: 30px;
            border-bottom: 2px dashed #ddd;
        }
        .sim-section:last-child {
            border-bottom: none;
        }
        .sim-title {
            color: #667eea;
            font-size: 1.3em;
            margin-bottom: 15px;
            text-align: center;
        }
        
        /* å•é¡Œã‚¿ãƒ–ç”¨ */
        .problem-box {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
        }
        .problem-number {
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 15px;
        }
        details {
            background: #e8f4fd;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        summary {
            cursor: pointer;
            font-weight: bold;
            color: #2980b9;
        }
        details[open] summary {
            margin-bottom: 15px;
            border-bottom: 1px solid #bbb;
            padding-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            header, .container {
                padding: 15px;
            }
            .tab-btn {
                min-width: 100px;
                font-size: 14px;
            }
            .diagram-box {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
        <h1>åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡</h1>
    </header>
    <div class="container">
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('lecture')">è§£èª¬ç·¨</button>
            <button class="tab-btn" onclick="openTab('problem')">å•é¡Œç·¨</button>
            <button class="tab-btn" onclick="openTab('simulation')">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
        </div>
        
        <div id="lecture" class="tab-content active">
            <h2>æˆæ¥­è³‡æ–™</h2>
            <iframe src="https://drive.google.com/file/d/1rd3AUHNkj-NLM0IEztEdsiVOdPwxD6EA/preview" width="100%" height="500"></iframe>
            
            <div class="explanation">
                <h2 style="margin-top: 30px;">åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ã¯ï¼Ÿ</h2>
                
                <p>ç‰©ç†ã«ãŠã‘ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ã¯ã€<strong>ã€Œç‰©ä½“ãŒä½•må‹•ã‘ã‚‹ã‹ã‚’ç¤ºã—ãŸé‡ã€</strong>ã§ã™ã€‚å˜ä½ã¯ <strong>ã‚¸ãƒ¥ãƒ¼ãƒ« [J]</strong> ã‚’ä½¿ã„ã¾ã™ã€‚é«˜æ ¡ç‰©ç†ã®åŠ›å­¦ã§ã¯ã€ä¸»ã«ä»¥ä¸‹ã®3ã¤ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ‰±ã„ã¾ã™ã€‚</p>
                
                <div class="formula-box">
                    <div class="formula-title">åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®3ç¨®é¡</div>
                    <p>$$\text{åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼} = \underbrace{K}_{\text{é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼}} + \underbrace{U}_{\text{é‡åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼}} + \underbrace{U'}_{\text{å¼¾æ€§åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼}}$$</p>
                </div>

                <h3>â‘  é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ $K$</h3>
                <p>é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€<strong>ã€Œå‹•ã„ã¦ã„ã‚Œã°æŒã£ã¦ã„ã‚‹ã€</strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã™ã€‚ç‰©ä½“ãŒé€Ÿåº¦ $v$ ã§å‹•ã„ã¦ã„ã‚‹ã¨ãã€ãã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯æ¬¡ã®å¼ã§è¡¨ã•ã‚Œã¾ã™ã€‚</p>
                
                <div class="formula-box">
                    <div class="formula-title">é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼</div>
                    <p>$$K = \frac{1}{2}mv^2$$</p>
                    <p style="font-size: 14px; color: #666;">$m$ï¼šè³ªé‡ [kg]ã€$v$ï¼šé€Ÿã• [m/s]</p>
                </div>
                
                <div class="diagram-container">
                    <div class="diagram-box">
                        <canvas id="kineticDiagram1" width="250" height="150"></canvas>
                        <div class="diagram-caption"><strong>å‹•ã„ã¦ã„ã‚‹å ´åˆ ($v \neq 0$)</strong><br>é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ $K = \frac{1}{2}mv^2 > 0$</div>
                    </div>
                    <div class="diagram-box">
                        <canvas id="kineticDiagram2" width="250" height="150"></canvas>
                        <div class="diagram-caption"><strong>é™æ­¢ã—ã¦ã„ã‚‹å ´åˆ ($v = 0$)</strong><br>é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ $K = 0$</div>
                    </div>
                </div>
                
                <div class="key-point">
                    <div class="key-point-title">ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ</div>
                    é€Ÿã• $v$ ãŒ2å€ã«ãªã‚‹ã¨ã€é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯4å€ã«ãªã‚Šã¾ã™ï¼ˆ$v^2$ ã«æ¯”ä¾‹ã™ã‚‹ãŸã‚ï¼‰ã€‚å‹•ã„ã¦ã•ãˆã„ã‚Œã°ã€é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯å¿…ãšæ­£ã®å€¤ã‚’æŒã¡ã¾ã™ã€‚
                </div>

                <h3>â‘¡ é‡åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U$</h3>
                <p>é‡åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€<strong>ã€ŒåŸºæº–ç‚¹ã‹ã‚‰ã©ã‚Œã ã‘é«˜ã„ä½ç½®ã«ã„ã‚‹ã‹ã€</strong>ã§æ±ºã¾ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã™ã€‚</p>
                
                <div class="formula-box">
                    <div class="formula-title">é‡åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼</div>
                    <p>$$U = mgh$$</p>
                    <p style="font-size: 14px; color: #666;">$m$ï¼šè³ªé‡ [kg]ã€$g$ï¼šé‡åŠ›åŠ é€Ÿåº¦ [m/sÂ²]ã€$h$ï¼šåŸºæº–ã‹ã‚‰ã®é«˜ã• [m]</p>
                </div>
                
                <div class="key-point">
                    <div class="key-point-title">âš ï¸ è¶…é‡è¦ï¼šåŸºæº–ç‚¹ã®è¨­å®š</div>
                    ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯<strong>ã€Œã©ã“ã‚’åŸºæº–ï¼ˆ$h=0$ï¼‰ã¨ã™ã‚‹ã‹ã€</strong>ã«ã‚ˆã£ã¦å€¤ãŒå¤‰ã‚ã‚Šã¾ã™ï¼åŸºæº–ã‚ˆã‚Šä½ã„ä½ç½®ã§ã¯ã€ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯<strong>è² ã®å€¤</strong>ã«ãªã‚Šã¾ã™ã€‚
                </div>
                
                <div class="diagram-container">
                    <div class="diagram-box">
                        <canvas id="potentialDiagram1" width="250" height="200"></canvas>
                        <div class="diagram-caption"><strong>åœ°é¢ã‚’åŸºæº– ($h=0$) ã¨ã—ãŸå ´åˆ</strong><br>é«˜ã• $h$ ã®ä½ç½®ï¼š$U = mgh > 0$</div>
                    </div>
                    <div class="diagram-box">
                        <canvas id="potentialDiagram2" width="250" height="200"></canvas>
                        <div class="diagram-caption"><strong>é«˜ã„ä½ç½®ã‚’åŸºæº–ã¨ã—ãŸå ´åˆ</strong><br>åŸºæº–ã‚ˆã‚Šä¸‹ï¼š$U = mg(-h') < 0$</div>
                    </div>
                </div>

                <h3>â‘¢ å¼¾æ€§åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U'$ï¼ˆã°ã­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰</h3>
                <p>ã°ã­ã®ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€<strong>ã€Œè‡ªç„¶é•·ã‹ã‚‰ã©ã‚Œã ã‘ãšã‚Œã¦ã„ã‚‹ã‹ã€</strong>ã§æ±ºã¾ã‚Šã¾ã™ã€‚</p>
                
                <div class="formula-box">
                    <div class="formula-title">å¼¾æ€§åŠ›ã«ã‚ˆã‚‹ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼</div>
                    <p>$$U' = \frac{1}{2}kx^2$$</p>
                    <p style="font-size: 14px; color: #666;">$k$ï¼šã°ã­å®šæ•° [N/m]ã€$x$ï¼šè‡ªç„¶é•·ã‹ã‚‰ã®ä¼¸ã³ãƒ»ç¸®ã¿ [m]</p>
                </div>
                
                <div class="diagram-container">
                    <div class="diagram-box">
                        <canvas id="springDiagram1" width="250" height="120"></canvas>
                        <div class="diagram-caption"><strong>è‡ªç„¶é•·ã®çŠ¶æ…‹ ($x = 0$)</strong><br>å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U' = 0$</div>
                    </div>
                    <div class="diagram-box">
                        <canvas id="springDiagram2" width="250" height="120"></canvas>
                        <div class="diagram-caption"><strong>ä¼¸ã³ãŸçŠ¶æ…‹ ($x > 0$)</strong><br>å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U' = \frac{1}{2}kx^2 > 0$</div>
                    </div>
                    <div class="diagram-box">
                        <canvas id="springDiagram3" width="250" height="120"></canvas>
                        <div class="diagram-caption"><strong>ç¸®ã‚“ã çŠ¶æ…‹ ($x < 0$)</strong><br>å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U' = \frac{1}{2}kx^2 > 0$</div>
                    </div>
                </div>
                
                <div class="key-point">
                    <div class="key-point-title">ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ</div>
                    ã°ã­ã®ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ $x^2$ ã«æ¯”ä¾‹ã™ã‚‹ãŸã‚ã€ä¼¸ã³ã¦ã‚‚ç¸®ã‚“ã§ã‚‚<strong>å¸¸ã«æ­£ã®å€¤</strong>ï¼ˆã¾ãŸã¯0ï¼‰ã«ãªã‚Šã¾ã™ã€‚åŸºæº–ã¯å¸¸ã«ã€Œè‡ªç„¶é•·ã®ä½ç½®ã€ã§ã™ã€‚
                </div>

                <h3>åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡</h3>
                <p><strong>ä¿å­˜åŠ›</strong>ï¼ˆé‡åŠ›ã€å¼¾æ€§åŠ›ãªã©ï¼‰ã®ã¿ãŒã¯ãŸã‚‰ãå ´åˆã€åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç·å’Œã¯ä¸€å®šã«ä¿ãŸã‚Œã¾ã™ã€‚</p>
                
                <div class="formula-box">
                    <div class="formula-title">åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡</div>
                    <p>$$K_1 + U_1 = K_2 + U_2$$</p>
                    <p>$$\frac{1}{2}mv_1^2 + mgh_1 = \frac{1}{2}mv_2^2 + mgh_2$$</p>
                    <p style="font-size: 14px; color: #666;">ï¼ˆçŠ¶æ…‹1ã§ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ï¼ï¼ˆçŠ¶æ…‹2ã§ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰</p>
                </div>
                
                <div class="key-point">
                    <div class="key-point-title">ğŸ’¡ ç­‰åŠ é€Ÿåº¦é‹å‹•ã¨ã®é•ã„</div>
                    ç­‰åŠ é€Ÿåº¦ç›´ç·šé‹å‹•ã¯ã€Œæ™‚é–“ã€ã¨ã€Œé•·ã•ã€ã¨ã€Œé€Ÿã•ã€ã®é–¢ä¿‚å¼ã§ã—ãŸã€‚ä¸€æ–¹ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€ŒåŠ›ã€ã¨ã€Œé•·ã•ã€ã¨ã€Œé€Ÿã•ã€ã®é–¢ä¿‚ã§ã‚ã‚Šã€<strong>ã€Œä½•ç§’é–“å‹•ã„ãŸã‹ã€ã¯å…¨ãé–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“</strong>ã€‚ã“ã‚ŒãŒã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å¼·ã¿ã§ã™ï¼
                </div>
            </div>
        </div>
        
        <div id="problem" class="tab-content">
            <h2>ç¢ºèªå•é¡Œ</h2>
            
            <div class="problem-box">
                <div class="problem-number">å•é¡Œ 1</div>
                <p>è³ªé‡ $m = 2.0$ kg ã®ç‰©ä½“ã‚’ã€åœ°é¢ã‹ã‚‰é«˜ã• $h = 5.0$ m ã®ä½ç½®ã§é™ã‹ã«æ‰‹ã‚’é›¢ã—ãŸã€‚é‡åŠ›åŠ é€Ÿåº¦ã‚’ $g = 10$ m/sÂ² ã¨ã™ã‚‹ã€‚</p>
                <p>(1) æ‰‹ã‚’é›¢ã—ãŸç¬é–“ã®åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã„ãã‚‰ã‹ã€‚</p>
                <p>(2) åœ°é¢ã«é”ã™ã‚‹ç›´å‰ã®é€Ÿã•ã¯ã„ãã‚‰ã‹ã€‚</p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <p><strong>(1) åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong></p>
                    <p>åœ°é¢ã‚’åŸºæº–ï¼ˆ$h=0$ï¼‰ã¨ã™ã‚‹ã¨ã€</p>
                    <p>é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼š$K = \frac{1}{2}mv^2 = \frac{1}{2} \times 2.0 \times 0^2 = 0$ Jï¼ˆé™ã‹ã«é›¢ã—ãŸã®ã§ $v=0$ï¼‰</p>
                    <p>ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼š$U = mgh = 2.0 \times 10 \times 5.0 = 100$ J</p>
                    <p>ã‚ˆã£ã¦ã€åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ $= K + U = 0 + 100 = \boxed{100 \text{ J}}$</p>
                    
                    <p style="margin-top: 15px;"><strong>(2) åœ°é¢ã«é”ã™ã‚‹ç›´å‰ã®é€Ÿã•</strong></p>
                    <p>åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜å‰‡ã‚ˆã‚Šã€</p>
                    <p>$$\frac{1}{2}mv_1^2 + mgh_1 = \frac{1}{2}mv_2^2 + mgh_2$$</p>
                    <p>$$0 + 100 = \frac{1}{2} \times 2.0 \times v_2^2 + 0$$</p>
                    <p>$$v_2^2 = 100$$</p>
                    <p>$$v_2 = \boxed{10 \text{ m/s}}$$</p>
                </details>
            </div>
            
            <div class="problem-box">
                <div class="problem-number">å•é¡Œ 2</div>
                <p>ã°ã­å®šæ•° $k = 200$ N/m ã®ã°ã­ã‚’ã€è‡ªç„¶é•·ã‹ã‚‰ $x = 0.10$ m ç¸®ã‚ã¦ç‰©ä½“ï¼ˆè³ªé‡ $m = 0.50$ kgï¼‰ã‚’ç½®ãã€é™ã‹ã«æ‰‹ã‚’é›¢ã—ãŸã€‚æ‘©æ“¦ã¯ãªã„ã‚‚ã®ã¨ã™ã‚‹ã€‚</p>
                <p>(1) æ‰‹ã‚’é›¢ã—ãŸç¬é–“ã«ã€ã°ã­ã«è“„ãˆã‚‰ã‚Œã¦ã„ã‚‹å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã„ãã‚‰ã‹ã€‚</p>
                <p>(2) ç‰©ä½“ãŒè‡ªç„¶é•·ã®ä½ç½®ã‚’é€šéã™ã‚‹ã¨ãã®é€Ÿã•ã¯ã„ãã‚‰ã‹ã€‚</p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <p><strong>(1) å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong></p>
                    <p>$$U' = \frac{1}{2}kx^2 = \frac{1}{2} \times 200 \times (0.10)^2 = \frac{1}{2} \times 200 \times 0.01 = \boxed{1.0 \text{ J}}$$</p>
                    
                    <p style="margin-top: 15px;"><strong>(2) è‡ªç„¶é•·ã®ä½ç½®ã§ã®é€Ÿã•</strong></p>
                    <p>è‡ªç„¶é•·ã®ä½ç½®ã§ã¯ã€$x = 0$ ãªã®ã§å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ 0 ã«ãªã‚Šã¾ã™ã€‚</p>
                    <p>åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜å‰‡ã‚ˆã‚Šã€</p>
                    <p>$$\frac{1}{2}mv_1^2 + \frac{1}{2}kx_1^2 = \frac{1}{2}mv_2^2 + \frac{1}{2}kx_2^2$$</p>
                    <p>$$0 + 1.0 = \frac{1}{2} \times 0.50 \times v_2^2 + 0$$</p>
                    <p>$$v_2^2 = \frac{1.0 \times 2}{0.50} = 4.0$$</p>
                    <p>$$v_2 = \boxed{2.0 \text{ m/s}}$$</p>
                </details>
            </div>
            
            <div class="problem-box">
                <div class="problem-number">å•é¡Œ 3</div>
                <p>ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åŸºæº–ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®å•ã„ã«ç­”ãˆã‚ˆã€‚</p>
                <p>é«˜ã• 10 m ã®ãƒ“ãƒ«ã®å±‹ä¸Šã‹ã‚‰ã€è³ªé‡ 1.0 kg ã®ãƒœãƒ¼ãƒ«ã‚’è½ã¨ã™ã€‚é‡åŠ›åŠ é€Ÿåº¦ã‚’ $g = 10$ m/sÂ² ã¨ã™ã‚‹ã€‚</p>
                <p>(1) åœ°é¢ã‚’åŸºæº–ã¨ã—ãŸã¨ãã€å±‹ä¸Šã§ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã„ãã‚‰ã‹ã€‚</p>
                <p>(2) å±‹ä¸Šã‚’åŸºæº–ã¨ã—ãŸã¨ãã€åœ°é¢ã§ã®ãƒœãƒ¼ãƒ«ã®ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã„ãã‚‰ã‹ã€‚</p>
                <p>(3) ã©ã¡ã‚‰ã®åŸºæº–ã§ã‚‚ã€å±‹ä¸Šã‹ã‚‰åœ°é¢ã¾ã§ã®ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ã€Œå¤‰åŒ–é‡ã€ã¯åŒã˜ã«ãªã‚‹ã“ã¨ã‚’ç¤ºã›ã€‚</p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <p><strong>(1) åœ°é¢ã‚’åŸºæº–ã¨ã—ãŸã¨ã</strong></p>
                    <p>å±‹ä¸Šã¯åœ°é¢ã‹ã‚‰ $h = 10$ m ã®é«˜ã•ã«ã‚ã‚‹ã®ã§ã€</p>
                    <p>$$U = mgh = 1.0 \times 10 \times 10 = \boxed{100 \text{ J}}$$</p>
                    
                    <p style="margin-top: 15px;"><strong>(2) å±‹ä¸Šã‚’åŸºæº–ã¨ã—ãŸã¨ã</strong></p>
                    <p>åœ°é¢ã¯å±‹ä¸Šã‚ˆã‚Š 10 m ä½ã„ä½ç½®ã«ã‚ã‚‹ã®ã§ã€$h = -10$ m</p>
                    <p>$$U = mgh = 1.0 \times 10 \times (-10) = \boxed{-100 \text{ J}}$$</p>
                    
                    <p style="margin-top: 15px;"><strong>(3) å¤‰åŒ–é‡ã®æ¯”è¼ƒ</strong></p>
                    <p><u>åœ°é¢åŸºæº–ã®å ´åˆï¼š</u></p>
                    <p>$\Delta U = U_{\text{åœ°é¢}} - U_{\text{å±‹ä¸Š}} = 0 - 100 = -100$ J</p>
                    <p><u>å±‹ä¸ŠåŸºæº–ã®å ´åˆï¼š</u></p>
                    <p>$\Delta U = U_{\text{åœ°é¢}} - U_{\text{å±‹ä¸Š}} = (-100) - 0 = -100$ J</p>
                    <p>ã©ã¡ã‚‰ã®åŸºæº–ã§ã‚‚ã€ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å¤‰åŒ–é‡ã¯ $-100$ J ã§<strong>ä¸€è‡´ã™ã‚‹</strong>ã€‚</p>
                    <p style="margin-top: 10px; background: #fff3cd; padding: 10px; border-radius: 5px;">
                    <strong>çµè«–ï¼š</strong>åŸºæº–ã®å–ã‚Šæ–¹ã§ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ã€Œå€¤ã€ã¯å¤‰ã‚ã‚‹ãŒã€ã€Œå¤‰åŒ–é‡ã€ã¯å¤‰ã‚ã‚‰ãªã„ã€‚ã ã‹ã‚‰ã€åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜å‰‡ã¯åŸºæº–ã«ä¾ã‚‰ãšæˆã‚Šç«‹ã¤ã€‚
                    </p>
                </details>
            </div>
        </div>
        
        <div id="simulation" class="tab-content">
            <h2>ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            
            <!-- è‡ªç”±è½ä¸‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="sim-section">
                <h3 class="sim-title">ğŸ è‡ªç”±è½ä¸‹ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰æ›</h3>
                <p style="text-align: center; margin-bottom: 15px;">é«˜ã• $h$ ã‹ã‚‰ç‰©ä½“ã‚’è½ä¸‹ã•ã›ã€ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒé‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«å¤‰æ›ã•ã‚Œã‚‹æ§˜å­ã‚’è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚</p>
                
                <div class="sim-formula">
                    <strong>åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡ï¼š</strong>
                    $$\frac{1}{2}mv^2 + mgh = \text{ä¸€å®šï¼ˆåˆæœŸã®ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰}$$
                </div>
                
                <div class="sim-container">
                    <canvas id="fallCanvas"></canvas>
                </div>
                
                <div class="energy-display" id="fallEnergyDisplay">
                    <div class="energy-bar-container">
                        <div class="energy-bar-label">ğŸ”´ é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ $K$</div>
                        <div class="energy-bar">
                            <div class="energy-bar-fill kinetic" id="fallKineticBar" style="width: 0%;">0%</div>
                        </div>
                    </div>
                    <div class="energy-bar-container">
                        <div class="energy-bar-label">ğŸ”µ ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U$</div>
                        <div class="energy-bar">
                            <div class="energy-bar-fill potential" id="fallPotentialBar" style="width: 100%;">100%</div>
                        </div>
                    </div>
                </div>
                
                <div class="sim-controls">
                    <div class="button-group">
                        <button class="sim-button start" id="fallStartBtn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                        <button class="sim-button stop" id="fallStopBtn">ã‚¹ãƒˆãƒƒãƒ—</button>
                        <button class="sim-button reset" id="fallResetBtn">ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                </div>
            </div>
            
            <!-- ã°ã­æŒ¯å‹•ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ -->
            <div class="sim-section">
                <h3 class="sim-title">ğŸŒ€ ã°ã­ã®æŒ¯å‹•ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰æ›</h3>
                <p style="text-align: center; margin-bottom: 15px;">æ‘©æ“¦ã®ãªã„æ°´å¹³é¢ä¸Šã§ã€ã°ã­ã«ã¤ãªãŒã‚ŒãŸç‰©ä½“ãŒæŒ¯å‹•ã™ã‚‹æ§˜å­ã‚’è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚</p>
                
                <div class="sim-formula">
                    <strong>åŠ›å­¦çš„ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ³•å‰‡ï¼š</strong>
                    $$\frac{1}{2}mv^2 + \frac{1}{2}kx^2 = \text{ä¸€å®šï¼ˆåˆæœŸã®å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰}$$
                </div>
                
                <div class="sim-container">
                    <canvas id="springCanvas"></canvas>
                </div>
                
                <div class="energy-display" id="springEnergyDisplay">
                    <div class="energy-bar-container">
                        <div class="energy-bar-label">ğŸ”´ é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ $K$</div>
                        <div class="energy-bar">
                            <div class="energy-bar-fill kinetic" id="springKineticBar" style="width: 0%;">0%</div>
                        </div>
                    </div>
                    <div class="energy-bar-container">
                        <div class="energy-bar-label">ğŸŸ¢ å¼¾æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ $U'$</div>
                        <div class="energy-bar">
                            <div class="energy-bar-fill elastic" id="springElasticBar" style="width: 100%;">100%</div>
                        </div>
                    </div>
                </div>
                
                <div class="sim-controls">
                    <div class="button-group">
                        <button class="sim-button start" id="springStartBtn">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                        <button class="sim-button stop" id="springStopBtn">ã‚¹ãƒˆãƒƒãƒ—</button>
                        <button class="sim-button reset" id="springResetBtn">ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    // --- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ ---
    function openTab(tabName) {
        var contents = document.getElementsByClassName("tab-content");
        for (var i = 0; i < contents.length; i++) {
            contents[i].style.display = "none";
            contents[i].classList.remove("active");
        }
        var buttons = document.getElementsByClassName("tab-btn");
        for (var i = 0; i < buttons.length; i++) {
            buttons[i].classList.remove("active");
        }
        document.getElementById(tabName).style.display = "block";
        document.getElementById(tabName).classList.add("active");
        if (event) {
            event.currentTarget.classList.add("active");
        }
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ–ãŒé–‹ã‹ã‚ŒãŸã‚‰Canvasã‚’ãƒªã‚µã‚¤ã‚º
        if (tabName === 'simulation') {
            resizeAllCanvases();
        }
    }

    // --- è§£èª¬å›³ã®æç”» ---
    function drawKineticDiagrams() {
        // å‹•ã„ã¦ã„ã‚‹å ´åˆ
        const c1 = document.getElementById('kineticDiagram1');
        const ctx1 = c1.getContext('2d');
        ctx1.clearRect(0, 0, c1.width, c1.height);
        
        // åœ°é¢
        ctx1.fillStyle = '#8B4513';
        ctx1.fillRect(0, 120, c1.width, 30);
        
        // ç‰©ä½“
        ctx1.fillStyle = '#e74c3c';
        ctx1.fillRect(80, 80, 40, 40);
        ctx1.fillStyle = '#fff';
        ctx1.font = 'bold 16px Arial';
        ctx1.fillText('m', 92, 107);
        
        // é€Ÿåº¦çŸ¢å°
        ctx1.strokeStyle = '#2ecc71';
        ctx1.lineWidth = 3;
        ctx1.beginPath();
        ctx1.moveTo(130, 100);
        ctx1.lineTo(200, 100);
        ctx1.stroke();
        ctx1.beginPath();
        ctx1.moveTo(200, 100);
        ctx1.lineTo(185, 90);
        ctx1.lineTo(185, 110);
        ctx1.closePath();
        ctx1.fillStyle = '#2ecc71';
        ctx1.fill();
        
        ctx1.fillStyle = '#2ecc71';
        ctx1.font = 'bold 18px Arial';
        ctx1.fillText('v', 205, 105);
        
        // é™æ­¢ã—ã¦ã„ã‚‹å ´åˆ
        const c2 = document.getElementById('kineticDiagram2');
        const ctx2 = c2.getContext('2d');
        ctx2.clearRect(0, 0, c2.width, c2.height);
        
        // åœ°é¢
        ctx2.fillStyle = '#8B4513';
        ctx2.fillRect(0, 120, c2.width, 30);
        
        // ç‰©ä½“
        ctx2.fillStyle = '#95a5a6';
        ctx2.fillRect(105, 80, 40, 40);
        ctx2.fillStyle = '#fff';
        ctx2.font = 'bold 16px Arial';
        ctx2.fillText('m', 117, 107);
        
        // v=0 è¡¨ç¤º
        ctx2.fillStyle = '#666';
        ctx2.font = '16px Arial';
        ctx2.fillText('v = 0', 155, 100);
    }
    
    function drawPotentialDiagrams() {
        // åœ°é¢åŸºæº–
        const c1 = document.getElementById('potentialDiagram1');
        const ctx1 = c1.getContext('2d');
        ctx1.clearRect(0, 0, c1.width, c1.height);
        
        // åœ°é¢
        ctx1.fillStyle = '#8B4513';
        ctx1.fillRect(0, 170, c1.width, 30);
        ctx1.fillStyle = '#333';
        ctx1.font = '12px Arial';
        ctx1.fillText('åŸºæº– (h=0)', 170, 185);
        
        // åŸºæº–ç·š
        ctx1.strokeStyle = '#e74c3c';
        ctx1.setLineDash([5, 5]);
        ctx1.beginPath();
        ctx1.moveTo(0, 170);
        ctx1.lineTo(c1.width, 170);
        ctx1.stroke();
        ctx1.setLineDash([]);
        
        // é«˜ã•ã®çŸ¢å°
        ctx1.strokeStyle = '#3498db';
        ctx1.lineWidth = 2;
        ctx1.beginPath();
        ctx1.moveTo(50, 170);
        ctx1.lineTo(50, 60);
        ctx1.stroke();
        ctx1.beginPath();
        ctx1.moveTo(50, 60);
        ctx1.lineTo(45, 75);
        ctx1.moveTo(50, 60);
        ctx1.lineTo(55, 75);
        ctx1.stroke();
        ctx1.beginPath();
        ctx1.moveTo(50, 170);
        ctx1.lineTo(45, 155);
        ctx1.moveTo(50, 170);
        ctx1.lineTo(55, 155);
        ctx1.stroke();
        
        ctx1.fillStyle = '#3498db';
        ctx1.font = 'bold 16px Arial';
        ctx1.fillText('h', 55, 120);
        
        // ç‰©ä½“
        ctx1.fillStyle = '#3498db';
        ctx1.fillRect(80, 40, 35, 35);
        ctx1.fillStyle = '#fff';
        ctx1.font = 'bold 14px Arial';
        ctx1.fillText('m', 90, 63);
        
        // U = mgh è¡¨ç¤º
        ctx1.fillStyle = '#333';
        ctx1.font = '14px Arial';
        ctx1.fillText('U = mgh > 0', 130, 60);
        
        // é«˜ã„ä½ç½®åŸºæº–
        const c2 = document.getElementById('potentialDiagram2');
        const ctx2 = c2.getContext('2d');
        ctx2.clearRect(0, 0, c2.width, c2.height);
        
        // åŸºæº–ç·šï¼ˆä¸Šï¼‰
        ctx2.strokeStyle = '#e74c3c';
        ctx2.setLineDash([5, 5]);
        ctx2.beginPath();
        ctx2.moveTo(0, 40);
        ctx2.lineTo(c2.width, 40);
        ctx2.stroke();
        ctx2.setLineDash([]);
        ctx2.fillStyle = '#333';
        ctx2.font = '12px Arial';
        ctx2.fillText('åŸºæº– (h=0)', 170, 35);
        
        // åœ°é¢
        ctx2.fillStyle = '#8B4513';
        ctx2.fillRect(0, 170, c2.width, 30);
        
        // é«˜ã•ã®çŸ¢å°ï¼ˆè² ï¼‰
        ctx2.strokeStyle = '#9b59b6';
        ctx2.lineWidth = 2;
        ctx2.beginPath();
        ctx2.moveTo(50, 40);
        ctx2.lineTo(50, 150);
        ctx2.stroke();
        ctx2.beginPath();
        ctx2.moveTo(50, 150);
        ctx2.lineTo(45, 135);
        ctx2.moveTo(50, 150);
        ctx2.lineTo(55, 135);
        ctx2.stroke();
        
        ctx2.fillStyle = '#9b59b6';
        ctx2.font = 'bold 16px Arial';
        ctx2.fillText("-h'", 55, 100);
        
        // ç‰©ä½“
        ctx2.fillStyle = '#9b59b6';
        ctx2.fillRect(80, 133, 35, 35);
        ctx2.fillStyle = '#fff';
        ctx2.font = 'bold 14px Arial';
        ctx2.fillText('m', 90, 156);
        
        // U < 0 è¡¨ç¤º
        ctx2.fillStyle = '#333';
        ctx2.font = '14px Arial';
        ctx2.fillText("U = -mgh' < 0", 125, 155);
    }
    
    function drawSpringDiagrams() {
        const canvases = ['springDiagram1', 'springDiagram2', 'springDiagram3'];
        const states = ['natural', 'stretched', 'compressed'];
        
        canvases.forEach((id, index) => {
            const c = document.getElementById(id);
            const ctx = c.getContext('2d');
            ctx.clearRect(0, 0, c.width, c.height);
            
            const state = states[index];
            const wallX = 20;
            const naturalEnd = 120;
            let blockX;
            
            if (state === 'natural') blockX = naturalEnd;
            else if (state === 'stretched') blockX = naturalEnd + 50;
            else blockX = naturalEnd - 40;
            
            // å£
            ctx.fillStyle = '#555';
            ctx.fillRect(wallX - 10, 30, 10, 60);
            
            // åºŠ
            ctx.fillStyle = '#ccc';
            ctx.fillRect(wallX, 90, 220, 5);
            
            // ã°ã­æç”»
            drawSpring(ctx, wallX, 60, blockX, 60, state);
            
            // ç‰©ä½“
            ctx.fillStyle = state === 'natural' ? '#95a5a6' : (state === 'stretched' ? '#3498db' : '#e74c3c');
            ctx.fillRect(blockX, 45, 30, 30);
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 12px Arial';
            ctx.fillText('m', blockX + 8, 65);
            
            // è‡ªç„¶é•·ã®ä½ç½®ã‚’ç¤ºã™ç‚¹ç·š
            if (state !== 'natural') {
                ctx.strokeStyle = '#27ae60';
                ctx.setLineDash([3, 3]);
                ctx.beginPath();
                ctx.moveTo(naturalEnd + 15, 30);
                ctx.lineTo(naturalEnd + 15, 95);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // x ã®çŸ¢å°
                ctx.strokeStyle = '#e67e22';
                ctx.lineWidth = 2;
                const arrowStart = naturalEnd + 15;
                const arrowEnd = blockX + 15;
                ctx.beginPath();
                ctx.moveTo(arrowStart, 25);
                ctx.lineTo(arrowEnd, 25);
                ctx.stroke();
                
                ctx.fillStyle = '#e67e22';
                ctx.font = 'bold 14px Arial';
                ctx.fillText('x', (arrowStart + arrowEnd) / 2 - 5, 18);
            }
            
            // è‡ªç„¶é•·ãƒ©ãƒ™ãƒ«
            if (state === 'natural') {
                ctx.fillStyle = '#27ae60';
                ctx.font = '12px Arial';
                ctx.fillText('è‡ªç„¶é•·', naturalEnd - 5, 105);
            }
        });
    }
    
    function drawSpring(ctx, x1, y1, x2, y2, state) {
        const coils = 10;
        const amplitude = 8;
        const length = x2 - x1;
        const step = length / coils;
        
        ctx.strokeStyle = state === 'natural' ? '#666' : (state === 'stretched' ? '#3498db' : '#e74c3c');
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        
        for (let i = 0; i < coils; i++) {
            const xPos = x1 + step * (i + 0.5);
            const yOffset = (i % 2 === 0) ? -amplitude : amplitude;
            ctx.lineTo(xPos, y1 + yOffset);
        }
        ctx.lineTo(x2, y2);
        ctx.stroke();
    }
    
    // --- è‡ªç”±è½ä¸‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ---
    const fallCanvas = document.getElementById('fallCanvas');
    const fallCtx = fallCanvas.getContext('2d');
    
    // å›ºå®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    const FALL_PARAMS = {
        m: 1.0,      // è³ªé‡ [kg]
        g: 10,       // é‡åŠ›åŠ é€Ÿåº¦ [m/sÂ²]
        h0: 50,      // åˆæœŸé«˜ã• [m]
        dt: 0.02     // æ™‚é–“åˆ»ã¿ [s]
    };
    
    let fallState = {
        y: 0,
        v: 0,
        t: 0,
        running: false,
        animationId: null
    };
    
    function resetFall() {
        fallState.y = 0;
        fallState.v = 0;
        fallState.t = 0;
        fallState.running = false;
        if (fallState.animationId) {
            cancelAnimationFrame(fallState.animationId);
        }
        updateFallEnergyBars();
        drawFallSimulation();
    }
    
    function startFall() {
        if (!fallState.running && fallState.y < FALL_PARAMS.h0) {
            fallState.running = true;
            animateFall();
        }
    }
    
    function stopFall() {
        fallState.running = false;
        if (fallState.animationId) {
            cancelAnimationFrame(fallState.animationId);
        }
    }
    
    function animateFall() {
        if (!fallState.running) return;
        
        // ç‰©ç†è¨ˆç®—
        fallState.v += FALL_PARAMS.g * FALL_PARAMS.dt;
        fallState.y += fallState.v * FALL_PARAMS.dt;
        fallState.t += FALL_PARAMS.dt;
        
        // åœ°é¢ã«åˆ°é”ã—ãŸã‚‰åœæ­¢
        if (fallState.y >= FALL_PARAMS.h0) {
            fallState.y = FALL_PARAMS.h0;
            fallState.v = Math.sqrt(2 * FALL_PARAMS.g * FALL_PARAMS.h0);
            fallState.running = false;
        }
        
        updateFallEnergyBars();
        drawFallSimulation();
        
        if (fallState.running) {
            fallState.animationId = requestAnimationFrame(animateFall);
        }
    }
    
    function updateFallEnergyBars() {
        const h = FALL_PARAMS.h0 - fallState.y;
        const totalE = FALL_PARAMS.m * FALL_PARAMS.g * FALL_PARAMS.h0;
        const K = 0.5 * FALL_PARAMS.m * fallState.v * fallState.v;
        const U = FALL_PARAMS.m * FALL_PARAMS.g * h;
        
        const kPercent = Math.round((K / totalE) * 100);
        const uPercent = Math.round((U / totalE) * 100);
        
        const kBar = document.getElementById('fallKineticBar');
        const uBar = document.getElementById('fallPotentialBar');
        
        kBar.style.width = kPercent + '%';
        kBar.textContent = kPercent + '%';
        uBar.style.width = uPercent + '%';
        uBar.textContent = uPercent + '%';
    }
    
    function drawFallSimulation() {
        const w = fallCanvas.width;
        const h = fallCanvas.height;
        fallCtx.clearRect(0, 0, w, h);
        
        const margin = 60;
        const groundY = h - 40;
        const topY = 40;
        const trackX = 100;
        
        // èƒŒæ™¯
        fallCtx.fillStyle = '#f0f8ff';
        fallCtx.fillRect(0, 0, w, h);
        
        // ç©º
        const skyGrad = fallCtx.createLinearGradient(0, 0, 0, groundY);
        skyGrad.addColorStop(0, '#87CEEB');
        skyGrad.addColorStop(1, '#E0F7FA');
        fallCtx.fillStyle = skyGrad;
        fallCtx.fillRect(0, 0, w, groundY);
        
        // åœ°é¢
        fallCtx.fillStyle = '#8B4513';
        fallCtx.fillRect(0, groundY, w, h - groundY);
        fallCtx.fillStyle = '#228B22';
        fallCtx.fillRect(0, groundY, w, 5);
        
        // é«˜ã•ã‚¹ã‚±ãƒ¼ãƒ«
        const scaleH = groundY - topY;
        const pixelPerMeter = scaleH / FALL_PARAMS.h0;
        
        // ãƒ¡ãƒ¢ãƒª
        fallCtx.strokeStyle = '#666';
        fallCtx.lineWidth = 1;
        fallCtx.fillStyle = '#333';
        fallCtx.font = '12px Arial';
        for (let meter = 0; meter <= FALL_PARAMS.h0; meter += 10) {
            const yPos = groundY - meter * pixelPerMeter;
            fallCtx.beginPath();
            fallCtx.moveTo(trackX - 15, yPos);
            fallCtx.lineTo(trackX - 5, yPos);
            fallCtx.stroke();
            fallCtx.fillText(meter + 'm', trackX - 45, yPos + 4);
        }
        
        // ç‰©ä½“ã®ä½ç½®è¨ˆç®—
        const currentH = FALL_PARAMS.h0 - fallState.y;
        const ballY = groundY - currentH * pixelPerMeter;
        const ballRadius = 20;
        
        // è½ä¸‹è»Œè·¡
        fallCtx.strokeStyle = 'rgba(231, 76, 60, 0.3)';
        fallCtx.setLineDash([5, 5]);
        fallCtx.beginPath();
        fallCtx.moveTo(trackX + 60, topY);
        fallCtx.lineTo(trackX + 60, groundY);
        fallCtx.stroke();
        fallCtx.setLineDash([]);
        
        // ç‰©ä½“ï¼ˆãƒœãƒ¼ãƒ«ï¼‰
        const ballGrad = fallCtx.createRadialGradient(
            trackX + 55, ballY - 5, 0,
            trackX + 60, ballY, ballRadius
        );
        ballGrad.addColorStop(0, '#ff6b6b');
        ballGrad.addColorStop(1, '#c0392b');
        fallCtx.fillStyle = ballGrad;
        fallCtx.beginPath();
        fallCtx.arc(trackX + 60, ballY, ballRadius, 0, Math.PI * 2);
        fallCtx.fill();
        
        // é€Ÿåº¦ãƒ™ã‚¯ãƒˆãƒ«
        if (fallState.v > 0.1) {
            const vScale = 2;
            const vLength = Math.min(fallState.v * vScale, 80);
            fallCtx.strokeStyle = '#27ae60';
            fallCtx.lineWidth = 3;
            fallCtx.beginPath();
            fallCtx.moveTo(trackX + 60, ballY + ballRadius + 5);
            fallCtx.lineTo(trackX + 60, ballY + ballRadius + 5 + vLength);
            fallCtx.stroke();
            
            // çŸ¢å°ã®å…ˆ
            fallCtx.fillStyle = '#27ae60';
            fallCtx.beginPath();
            fallCtx.moveTo(trackX + 60, ballY + ballRadius + 5 + vLength + 10);
            fallCtx.lineTo(trackX + 52, ballY + ballRadius + 5 + vLength);
            fallCtx.lineTo(trackX + 68, ballY + ballRadius + 5 + vLength);
            fallCtx.closePath();
            fallCtx.fill();
        }
        
        // æƒ…å ±è¡¨ç¤º
        const infoX = w - 180;
        fallCtx.fillStyle = 'rgba(255,255,255,0.9)';
        fallCtx.fillRect(infoX - 10, 10, 175, 120);
        fallCtx.strokeStyle = '#667eea';
        fallCtx.lineWidth = 2;
        fallCtx.strokeRect(infoX - 10, 10, 175, 120);
        
        fallCtx.fillStyle = '#333';
        fallCtx.font = '14px Arial';
        fallCtx.fillText('é«˜ã• h = ' + currentH.toFixed(1) + ' m', infoX, 35);
        fallCtx.fillText('é€Ÿã• v = ' + fallState.v.toFixed(1) + ' m/s', infoX, 60);
        fallCtx.fillText('æ™‚é–“ t = ' + fallState.t.toFixed(2) + ' s', infoX, 85);
        
        const totalE = FALL_PARAMS.m * FALL_PARAMS.g * FALL_PARAMS.h0;
        fallCtx.fillStyle = '#667eea';
        fallCtx.font = 'bold 14px Arial';
        fallCtx.fillText('ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼ = ' + totalE.toFixed(0) + ' J', infoX, 115);
    }
    
    // --- ã°ã­æŒ¯å‹•ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ---
    const springCanvas = document.getElementById('springCanvas');
    const springCtx = springCanvas.getContext('2d');
    
    // å›ºå®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    const SPRING_PARAMS = {
        m: 1.0,      // è³ªé‡ [kg]
        k: 10,       // ã°ã­å®šæ•° [N/m]
        x0: 0.5,     // åˆæœŸå¤‰ä½ [m] (ç¸®ã¿)
        dt: 0.02     // æ™‚é–“åˆ»ã¿ [s]
    };
    
    let springState = {
        x: -SPRING_PARAMS.x0,  // åˆæœŸã¯ç¸®ã‚“ã çŠ¶æ…‹
        v: 0,
        t: 0,
        running: false,
        animationId: null
    };
    
    function resetSpring() {
        springState.x = -SPRING_PARAMS.x0;
        springState.v = 0;
        springState.t = 0;
        springState.running = false;
        if (springState.animationId) {
            cancelAnimationFrame(springState.animationId);
        }
        updateSpringEnergyBars();
        drawSpringSimulation();
    }
    
    function startSpring() {
        if (!springState.running) {
            springState.running = true;
            animateSpring();
        }
    }
    
    function stopSpring() {
        springState.running = false;
        if (springState.animationId) {
            cancelAnimationFrame(springState.animationId);
        }
    }
    
    function animateSpring() {
        if (!springState.running) return;
        
        // å˜æŒ¯å‹•ã®ç‰©ç†è¨ˆç®— (F = -kx, a = -k/m * x)
        const omega = Math.sqrt(SPRING_PARAMS.k / SPRING_PARAMS.m);
        const a = -omega * omega * springState.x;
        springState.v += a * SPRING_PARAMS.dt;
        springState.x += springState.v * SPRING_PARAMS.dt;
        springState.t += SPRING_PARAMS.dt;
        
        updateSpringEnergyBars();
        drawSpringSimulation();
        
        springState.animationId = requestAnimationFrame(animateSpring);
    }
    
    function updateSpringEnergyBars() {
        const totalE = 0.5 * SPRING_PARAMS.k * SPRING_PARAMS.x0 * SPRING_PARAMS.x0;
        const K = 0.5 * SPRING_PARAMS.m * springState.v * springState.v;
        const U = 0.5 * SPRING_PARAMS.k * springState.x * springState.x;
        
        const kPercent = Math.round((K / totalE) * 100);
        const uPercent = Math.round((U / totalE) * 100);
        
        const kBar = document.getElementById('springKineticBar');
        const uBar = document.getElementById('springElasticBar');
        
        kBar.style.width = kPercent + '%';
        kBar.textContent = kPercent + '%';
        uBar.style.width = uPercent + '%';
        uBar.textContent = uPercent + '%';
    }
    
    function drawSpringSimulation() {
        const w = springCanvas.width;
        const h = springCanvas.height;
        springCtx.clearRect(0, 0, w, h);
        
        const centerY = h / 2;
        const wallX = 50;
        const naturalX = w / 2;  // è‡ªç„¶é•·ã®ä½ç½®
        const scale = 150;  // 1m = 150px
        
        // èƒŒæ™¯
        springCtx.fillStyle = '#fafafa';
        springCtx.fillRect(0, 0, w, h);
        
        // åºŠ
        springCtx.fillStyle = '#ddd';
        springCtx.fillRect(wallX, centerY + 30, w - wallX, 10);
        
        // å£
        springCtx.fillStyle = '#555';
        springCtx.fillRect(wallX - 15, centerY - 60, 15, 100);
        
        // æ–œç·šãƒ‘ã‚¿ãƒ¼ãƒ³
        springCtx.strokeStyle = '#333';
        springCtx.lineWidth = 1;
        for (let i = 0; i < 10; i++) {
            springCtx.beginPath();
            springCtx.moveTo(wallX - 15, centerY - 60 + i * 10);
            springCtx.lineTo(wallX - 5, centerY - 50 + i * 10);
            springCtx.stroke();
        }
        
        // è‡ªç„¶é•·ã®ä½ç½®ã‚’ç¤ºã™ç‚¹ç·š
        springCtx.strokeStyle = '#27ae60';
        springCtx.setLineDash([5, 5]);
        springCtx.lineWidth = 2;
        springCtx.beginPath();
        springCtx.moveTo(naturalX, centerY - 70);
        springCtx.lineTo(naturalX, centerY + 40);
        springCtx.stroke();
        springCtx.setLineDash([]);
        
        springCtx.fillStyle = '#27ae60';
        springCtx.font = '12px Arial';
        springCtx.fillText('è‡ªç„¶é•·', naturalX - 15, centerY - 75);
        
        // ç‰©ä½“ã®ä½ç½®
        const blockX = naturalX + springState.x * scale;
        const blockSize = 50;
        
        // ã°ã­æç”»
        drawAnimatedSpring(springCtx, wallX, centerY, blockX - blockSize/2, centerY);
        
        // ç‰©ä½“
        const blockColor = Math.abs(springState.v) > 0.1 ? '#e74c3c' : '#3498db';
        springCtx.fillStyle = blockColor;
        springCtx.fillRect(blockX - blockSize/2, centerY - blockSize/2, blockSize, blockSize);
        springCtx.fillStyle = '#fff';
        springCtx.font = 'bold 16px Arial';
        springCtx.fillText('m', blockX - 8, centerY + 6);
        
        // å¤‰ä½ x ã®çŸ¢å°ï¼ˆè‡ªç„¶é•·ã‹ã‚‰ã®ãšã‚Œï¼‰
        if (Math.abs(springState.x) > 0.01) {
            springCtx.strokeStyle = '#e67e22';
            springCtx.lineWidth = 2;
            springCtx.beginPath();
            springCtx.moveTo(naturalX, centerY + 55);
            springCtx.lineTo(blockX, centerY + 55);
            springCtx.stroke();
            
            // çŸ¢å°ã®å…ˆ
            const dir = springState.x > 0 ? 1 : -1;
            springCtx.fillStyle = '#e67e22';
            springCtx.beginPath();
            springCtx.moveTo(blockX, centerY + 55);
            springCtx.lineTo(blockX - dir * 10, centerY + 50);
            springCtx.lineTo(blockX - dir * 10, centerY + 60);
            springCtx.closePath();
            springCtx.fill();
            
            springCtx.fillStyle = '#e67e22';
            springCtx.font = 'bold 14px Arial';
            springCtx.fillText('x', (naturalX + blockX) / 2 - 5, centerY + 75);
        }
        
        // é€Ÿåº¦ãƒ™ã‚¯ãƒˆãƒ«
        if (Math.abs(springState.v) > 0.05) {
            const vScale = 30;
            const vLength = springState.v * vScale;
            springCtx.strokeStyle = '#9b59b6';
            springCtx.lineWidth = 3;
            springCtx.beginPath();
            springCtx.moveTo(blockX + blockSize/2 + 5, centerY);
            springCtx.lineTo(blockX + blockSize/2 + 5 + vLength, centerY);
            springCtx.stroke();
            
            // çŸ¢å°ã®å…ˆ
            const vDir = springState.v > 0 ? 1 : -1;
            springCtx.fillStyle = '#9b59b6';
            springCtx.beginPath();
            springCtx.moveTo(blockX + blockSize/2 + 5 + vLength + vDir * 10, centerY);
            springCtx.lineTo(blockX + blockSize/2 + 5 + vLength, centerY - 6);
            springCtx.lineTo(blockX + blockSize/2 + 5 + vLength, centerY + 6);
            springCtx.closePath();
            springCtx.fill();
            
            springCtx.fillStyle = '#9b59b6';
            springCtx.font = 'bold 12px Arial';
            springCtx.fillText('v', blockX + blockSize/2 + 10 + vLength * 0.5, centerY - 10);
        }
        
        // æƒ…å ±è¡¨ç¤º
        springCtx.fillStyle = 'rgba(255,255,255,0.9)';
        springCtx.fillRect(w - 180, 10, 170, 100);
        springCtx.strokeStyle = '#667eea';
        springCtx.lineWidth = 2;
        springCtx.strokeRect(w - 180, 10, 170, 100);
        
        springCtx.fillStyle = '#333';
        springCtx.font = '14px Arial';
        springCtx.fillText('å¤‰ä½ x = ' + springState.x.toFixed(2) + ' m', w - 170, 35);
        springCtx.fillText('é€Ÿåº¦ v = ' + springState.v.toFixed(2) + ' m/s', w - 170, 55);
        springCtx.fillText('æ™‚é–“ t = ' + springState.t.toFixed(2) + ' s', w - 170, 75);
        
        const totalE = 0.5 * SPRING_PARAMS.k * SPRING_PARAMS.x0 * SPRING_PARAMS.x0;
        springCtx.fillStyle = '#667eea';
        springCtx.font = 'bold 13px Arial';
        springCtx.fillText('ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼ = ' + totalE.toFixed(2) + ' J', w - 170, 100);
    }
    
    function drawAnimatedSpring(ctx, x1, y1, x2, y2) {
        const coils = 15;
        const amplitude = 12;
        const length = x2 - x1;
        const step = length / coils;
        
        // ã°ã­ã®è‰²ã‚’å¤‰ä½ã«å¿œã˜ã¦å¤‰åŒ–
        const strain = Math.abs(springState.x) / SPRING_PARAMS.x0;
        const r = Math.min(255, 100 + strain * 155);
        const g = Math.max(0, 100 - strain * 100);
        const b = Math.max(0, 100 - strain * 100);
        
        ctx.strokeStyle = `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`;
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(x1, y1);
        
        for (let i = 0; i < coils; i++) {
            const xPos = x1 + step * (i + 0.5);
            const yOffset = (i % 2 === 0) ? -amplitude : amplitude;
            ctx.lineTo(xPos, y1 + yOffset);
        }
        ctx.lineTo(x2, y2);
        ctx.stroke();
    }
    
    // --- ã‚­ãƒ£ãƒ³ãƒã‚¹ã®ãƒªã‚µã‚¤ã‚ºå‡¦ç† ---
    function resizeAllCanvases() {
        // è‡ªç”±è½ä¸‹ã‚­ãƒ£ãƒ³ãƒã‚¹
        const fallContainer = fallCanvas.parentElement;
        fallCanvas.width = fallContainer.clientWidth;
        fallCanvas.height = 350;
        drawFallSimulation();
        
        // ã°ã­ã‚­ãƒ£ãƒ³ãƒã‚¹
        const springContainer = springCanvas.parentElement;
        springCanvas.width = springContainer.clientWidth;
        springCanvas.height = 250;
        drawSpringSimulation();
    }
    
    // --- ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š ---
    document.getElementById('fallStartBtn').addEventListener('click', startFall);
    document.getElementById('fallStopBtn').addEventListener('click', stopFall);
    document.getElementById('fallResetBtn').addEventListener('click', resetFall);
    document.getElementById('springStartBtn').addEventListener('click', startSpring);
    document.getElementById('springStopBtn').addEventListener('click', stopSpring);
    document.getElementById('springResetBtn').addEventListener('click', resetSpring);
    
    window.addEventListener('resize', resizeAllCanvases);
    
    // --- åˆæœŸåŒ– ---
    window.addEventListener('load', function() {
        // è§£èª¬å›³ã‚’æç”»
        drawKineticDiagrams();
        drawPotentialDiagrams();
        drawSpringDiagrams();
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
        resizeAllCanvases();
        resetFall();
        resetSpring();
        
        // MathJaxã®å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        if (typeof MathJax !== 'undefined') {
            MathJax.typesetPromise();
        }
    });
    </script>
</body>
</html>