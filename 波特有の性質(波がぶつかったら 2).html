<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ ¡ç‰©ç† - æ³¢ã®å±ˆæŠ˜</title>
    <script>
      window.MathJax = {
      tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
     }
     };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .back-link {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        h1 {
            color: #333;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        .tab-btn:hover {
            background: #8899f0;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        h3 {
            color: #555;
            margin: 25px 0 15px 0;
            padding-bottom: 5px;
            border-bottom: 2px solid #667eea;
        }
        .pdf-placeholder {
            background: #f9f9f9;
            padding: 40px;
            text-align: center;
            border-radius: 5px;
            color: #666;
        }
        .lecture-content {
            line-height: 1.8;
            color: #333;
        }
        .lecture-content p {
            margin-bottom: 15px;
        }
        .important-box {
            background: linear-gradient(135deg, #667eea20 0%, #764ba220 100%);
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        .important-box h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .formula-box {
            background: #fff3e0;
            border: 2px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
            text-align: center;
        }
        .formula-box .formula {
            font-size: 1.3em;
            margin: 10px 0;
        }
        .point-box {
            background: #e8f5e9;
            border-left: 4px solid #4CAF50;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        .point-box h4 {
            color: #4CAF50;
            margin-bottom: 10px;
        }
        .note-box {
            background: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 0 10px 10px 0;
        }
        .challenge-box {
            background: #fce4ec;
            border: 2px dashed #e91e63;
            padding: 20px;
            margin: 20px 0;
            border-radius: 10px;
        }
        .challenge-box h4 {
            color: #e91e63;
            margin-bottom: 10px;
        }
        
        /* å•é¡Œã‚¿ãƒ–ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .problem-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }
        .problem-section h4 {
            color: #667eea;
            margin-bottom: 15px;
        }
        .problem-section p {
            margin-bottom: 10px;
            line-height: 1.8;
        }
        details {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 5px;
            border: 1px solid #ddd;
        }
        summary {
            cursor: pointer;
            font-weight: bold;
            color: #667eea;
            padding: 5px;
        }
        summary:hover {
            color: #764ba2;
        }
        details[open] summary {
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        .answer-content {
            line-height: 1.8;
        }
        .answer-content p {
            margin-bottom: 10px;
        }
        
        /* ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        #sim-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        #physicsCanvas {
            display: block;
            width: 100%;
            background: white;
            border-radius: 5px;
            border: 2px solid #ddd;
        }
        .sim-controls {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .control-group input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .value-display {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 100px;
            text-align: center;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .sim-button {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .sim-button.start {
            background: #4CAF50;
            color: white;
        }
        .sim-button.start:hover {
            background: #45a049;
        }
        .sim-button.reset {
            background: #f44336;
            color: white;
        }
        .sim-button.reset:hover {
            background: #da190b;
        }
        .graph-container {
            margin-top: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ddd;
        }
        .graph-container h3 {
            color: #667eea;
            margin-bottom: 10px;
            border-bottom: none;
        }
        #graphCanvas {
            display: block;
            width: 100%;
            border: 1px solid #eee;
        }
        .info-display {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }
        .info-display h4 {
            color: #1976d2;
            margin-bottom: 10px;
        }
        .info-display p {
            margin: 5px 0;
            font-family: monospace;
            font-size: 14px;
        }
        .discovery-box {
            background: #fff3e0;
            border: 2px solid #ff9800;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            display: none;
        }
        .discovery-box h4 {
            color: #e65100;
            margin-bottom: 10px;
        }
        .discovery-box.visible {
            display: block;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            header, .container {
                padding: 15px;
            }
            .tab-btn {
                min-width: 100px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
        <h1>æ³¢ã®å±ˆæŠ˜</h1>
    </header>
    <div class="container">
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('lecture')">è§£èª¬ç·¨</button>
            <button class="tab-btn" onclick="openTab('problem')">å•é¡Œç·¨</button>
            <button class="tab-btn" onclick="openTab('simulation')">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
        </div>
        
        <div id="lecture" class="tab-content active">
            <h2>æ³¢ã®å±ˆæŠ˜</h2>
            
            <div class="lecture-content">
                <h3>å±ˆæŠ˜ã¨ã¯ï¼Ÿ</h3>
                <p>
                    æ³¢ãŒç•°ãªã‚‹2ã¤ã®åª’è³ªï¼ˆåª’è³ªâ… ã¨åª’è³ªâ…¡ï¼‰ã®å¢ƒç•Œé¢ã«å‘ã‹ã£ã¦é€²ã‚€ã¨ãã€å¢ƒç•Œé¢ã§<strong>ä¸€éƒ¨ã¯åå°„ã—ã€æ®‹ã‚Šã¯å±ˆæŠ˜ã—ã¦åª’è³ªâ…¡ã®ä¸­ã‚’é€²ã¿ã¾ã™</strong>ã€‚
                </p>
                
                <div class="important-box">
                    <h4>ğŸ”‘ å±ˆæŠ˜ã®ãƒã‚¤ãƒ³ãƒˆ</h4>
                    <p>
                        å±ˆæŠ˜ã—ã¦é€²ã‚€æ³¢ã‚’<strong>å±ˆæŠ˜æ³¢</strong>ã¨ã„ã„ã€å±ˆæŠ˜æ³¢ã®é€²ã‚€å‘ãã¨æ³•ç·šï¼ˆå¢ƒç•Œé¢ã«å‚ç›´ãªç·šï¼‰ã¨ã®ãªã™è§’ã‚’<strong>å±ˆæŠ˜è§’</strong>ã¨ã„ã„ã¾ã™ã€‚
                    </p>
                </div>

                <h3>å±ˆæŠ˜ã®æ³•å‰‡ï¼ˆã‚¹ãƒãƒ«ã®æ³•å‰‡ï¼‰</h3>
                <p>
                    å±ˆæŠ˜ã®æ³•å‰‡ã¯ã€Œå…‰ã€ã®å˜å…ƒã§è©³ã—ãå­¦ã³ã¾ã™ã®ã§ã€ä»Šã¯ã¾ãš<strong>å…¬å¼ã‚’è¦šãˆã¦ã€ãã®ã¾ã¾ä»£å…¥ã§ãã‚‹ã‚ˆã†ã«ãªã‚Œã°å¤§ä¸ˆå¤«</strong>ã§ã™ï¼
                </p>

                <div class="formula-box">
                    <h4>ğŸ“ å±ˆæŠ˜ã®æ³•å‰‡</h4>
                    <div class="formula">
                        $$ n_{12} = \frac{\sin\theta_1}{\sin\theta_2} = \frac{v_1}{v_2} = \frac{\lambda_1}{\lambda_2} $$
                    </div>
                    <p style="text-align: left; margin-top: 15px;">
                        $\theta_1$ï¼šå…¥å°„è§’ã€€ã€€$\theta_2$ï¼šå±ˆæŠ˜è§’<br>
                        $v_1, v_2$ï¼šåª’è³ªâ… , â…¡ã§ã®æ³¢ã®é€Ÿã•<br>
                        $\lambda_1, \lambda_2$ï¼šåª’è³ªâ… , â…¡ã§ã®æ³¢é•·<br>
                        $n_{12}$ï¼šåª’è³ªâ… ã«å¯¾ã™ã‚‹åª’è³ªâ…¡ã®ç›¸å¯¾å±ˆæŠ˜ç‡
                    </p>
                </div>

                <div class="point-box">
                    <h4>âœ¨ ã“ã®å…¬å¼ã®æœ¬è³ª</h4>
                    <p>
                        å±ˆæŠ˜ç‡ã¨ã„ã†è¨€è‘‰ã¯é›£ã—ãæ„Ÿã˜ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€æœ¬è³ªã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚
                    </p>
                    <p>
                        <strong>ã€Œè§’åº¦ã€ã€Œæ³¢é•·ã€ã€Œé€Ÿã•ã€ã€ãã‚Œãã‚ŒåŒå£«ã§æ¯”ã¹ãŸã¨ãã®å‰²åˆãŒã™ã¹ã¦ç­‰ã—ããªã‚‹</strong>
                    </p>
                    <p>
                        ã¤ã¾ã‚Šã€$\sin\theta$ ã®æ¯”ã€$v$ ã®æ¯”ã€$\lambda$ ã®æ¯”ãŒã™ã¹ã¦åŒã˜å€¤ã«ãªã‚‹ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã“ã®ã€ŒåŒã˜å‰²åˆã€ã®ã“ã¨ã‚’å±ˆæŠ˜ç‡ã¨å‘¼ã‚“ã§ã„ã‚‹ã®ã§ã™ã€‚
                    </p>
                </div>

                <h3>æŒ¯å‹•æ•°ã¯å¤‰ã‚ã‚‰ãªã„ï¼</h3>
                <div class="note-box">
                    <p>
                        <strong>âš ï¸ é‡è¦</strong>ï¼šã©ã®åª’è³ªã§ã‚‚ã€æ³¢æºã¨åŒã˜æŒ¯å‹•æ•°ã§å¢ƒç•Œé¢ã‚’æŒ¯å‹•ã•ã›ã‚‹ã®ã§ã€<strong>å¢ƒç•Œé¢ã‚’é€šéã—ã¦ã‚‚æŒ¯å‹•æ•°ã¯ä¸å¤‰</strong>ã§ã™ã€‚
                    </p>
                    <p>
                        æ³¢ã®åŸºæœ¬å¼ $v = f\lambda$ ã‚’æ€ã„å‡ºã—ã¦ãã ã•ã„ã€‚æŒ¯å‹•æ•° $f$ ãŒä¸€å®šãªã®ã§ã€é€Ÿã• $v$ ãŒå¤‰ã‚ã‚‹ã¨æ³¢é•· $\lambda$ ã‚‚å¤‰ã‚ã‚Šã¾ã™ã€‚
                    </p>
                </div>

                <h3>å±ˆæŠ˜ç‡ã«ã¤ã„ã¦</h3>
                <p>
                    å±ˆæŠ˜ç‡ã«ã¯2ç¨®é¡ã‚ã‚Šã¾ã™ã€‚ä»Šã®æ®µéšã§ã¯ã€Œã“ã†ã„ã†ã‚‚ã®ãŒã‚ã‚‹ã€ç¨‹åº¦ã§å¤§ä¸ˆå¤«ã§ã™ã€‚
                </p>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li><strong>ç›¸å¯¾å±ˆæŠ˜ç‡</strong> $n_{12}$ï¼šã‚ã‚‹åª’è³ªã‹ã‚‰åˆ¥ã®åª’è³ªã¸ã®å±ˆæŠ˜ã®åº¦åˆã„ï¼ˆ2ã¤ã®åª’è³ªã®é–¢ä¿‚ï¼‰</li>
                    <li><strong>çµ¶å¯¾å±ˆæŠ˜ç‡</strong> $n_1, n_2$ï¼šçœŸç©ºã«å¯¾ã™ã‚‹å„åª’è³ªã®å±ˆæŠ˜ç‡ï¼ˆãã®åª’è³ªå›ºæœ‰ã®å€¤ï¼‰</li>
                </ul>
                <p style="margin-top: 15px;">
                    ç›¸å¯¾å±ˆæŠ˜ç‡ã¨çµ¶å¯¾å±ˆæŠ˜ç‡ã«ã¯ $n_{12} = \dfrac{n_2}{n_1}$ ã¨ã„ã†é–¢ä¿‚ãŒã‚ã‚Šã¾ã™ã€‚
                </p>

                <div class="challenge-box">
                    <h4>ğŸš€ ä½™è£•ãŒã‚ã‚‹äººã¸ï¼šãƒ›ã‚¤ãƒ˜ãƒ³ã‚¹ã®åŸç†</h4>
                    <p>
                        å±ˆæŠ˜ã®æ³•å‰‡ã¯ã€Œãƒ›ã‚¤ãƒ˜ãƒ³ã‚¹ã®åŸç†ã€ã‚’ä½¿ã£ã¦è¨¼æ˜ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã‚Œã¯æ¬¡ã®ç« ã§å­¦ã¶å†…å®¹ã§ã™ã€‚
                    </p>
                    <p>
                        ã¨ã¦ã‚‚é›£ã—ã„è€ƒãˆæ–¹ã§ã™ãŒã€æ³¢ã®æœ¬è³ªã‚’ç†è§£ã™ã‚‹ä¸Šã§ã¨ã¦ã‚‚é‡è¦ãªåŸç†ã§ã™ã€‚èˆˆå‘³ãŒã‚ã‚‹äººã¯ãœã²ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¦ãã ã•ã„ï¼
                    </p>
                </div>
            </div>
            
            <h3 style="margin-top: 30px;">æˆæ¥­è³‡æ–™ï¼ˆPDFï¼‰</h3>
            <iframe src="https://drive.google.com/file/d/1rd3AUHNkj-NLM0IEztEdsiVOdPwxD6EA/preview" width="100%" height="500"></iframe>
        </div>
        
        <div id="problem" class="tab-content">
            <h2>ç¢ºèªå•é¡Œ</h2>
            
            <div class="problem-section">
                <h4>å•é¡Œ1ï¼šå±ˆæŠ˜ã®æ³•å‰‡ã®åŸºæœ¬</h4>
                <p>
                    æ³¢ãŒåª’è³ªâ… ã‹ã‚‰åª’è³ªâ…¡ã¸é€²ã‚€ã¨ãã€å…¥å°„è§’ãŒ $30Â°$ ã§å±ˆæŠ˜è§’ãŒ $45Â°$ ã§ã‚ã£ãŸã€‚
                </p>
                <p>
                    (1) åª’è³ªâ… ã«å¯¾ã™ã‚‹åª’è³ªâ…¡ã®ç›¸å¯¾å±ˆæŠ˜ç‡ $n_{12}$ ã‚’æ±‚ã‚ã‚ˆã€‚
                </p>
                <p>
                    (2) åª’è³ªâ… ã§ã®æ³¢ã®é€Ÿã•ãŒ $v_1 = 300$ m/s ã®ã¨ãã€åª’è³ªâ…¡ã§ã®æ³¢ã®é€Ÿã• $v_2$ ã‚’æ±‚ã‚ã‚ˆã€‚
                </p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <div class="answer-content">
                        <p><strong>(1) ç›¸å¯¾å±ˆæŠ˜ç‡</strong></p>
                        <p>
                            å±ˆæŠ˜ã®æ³•å‰‡ã‚ˆã‚Šã€
                            $$ n_{12} = \frac{\sin\theta_1}{\sin\theta_2} = \frac{\sin 30Â°}{\sin 45Â°} = \frac{0.5}{\frac{\sqrt{2}}{2}} = \frac{1}{\sqrt{2}} = \frac{\sqrt{2}}{2} \approx 0.71 $$
                        </p>
                        <p><strong>(2) åª’è³ªâ…¡ã§ã®æ³¢ã®é€Ÿã•</strong></p>
                        <p>
                            å±ˆæŠ˜ã®æ³•å‰‡ã‚ˆã‚Šã€$n_{12} = \dfrac{v_1}{v_2}$ ãªã®ã§ã€
                            $$ v_2 = \frac{v_1}{n_{12}} = \frac{300}{\frac{\sqrt{2}}{2}} = 300 \times \sqrt{2} \approx 424 \text{ m/s} $$
                        </p>
                        <p>
                            <strong>ãƒã‚¤ãƒ³ãƒˆ</strong>ï¼šç›¸å¯¾å±ˆæŠ˜ç‡ãŒ1ã‚ˆã‚Šå°ã•ã„ï¼ˆ$n_{12} < 1$ï¼‰ã¨ã„ã†ã“ã¨ã¯ã€åª’è³ªâ…¡ã§ã®é€Ÿã•ãŒåª’è³ªâ… ã‚ˆã‚Šå¤§ãã„ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚
                        </p>
                    </div>
                </details>
            </div>

            <div class="problem-section">
                <h4>å•é¡Œ2ï¼šæŒ¯å‹•æ•°ã¨æ³¢é•·ã®é–¢ä¿‚</h4>
                <p>
                    æŒ¯å‹•æ•° $f = 500$ Hz ã®æ³¢ãŒã€åª’è³ªâ… ï¼ˆæ³¢ã®é€Ÿã• $v_1 = 400$ m/sï¼‰ã‹ã‚‰åª’è³ªâ…¡ï¼ˆæ³¢ã®é€Ÿã• $v_2 = 300$ m/sï¼‰ã¸é€²ã‚€ã€‚
                </p>
                <p>
                    (1) åª’è³ªâ… ã§ã®æ³¢é•· $\lambda_1$ ã¨åª’è³ªâ…¡ã§ã®æ³¢é•· $\lambda_2$ ã‚’ãã‚Œãã‚Œæ±‚ã‚ã‚ˆã€‚
                </p>
                <p>
                    (2) ç›¸å¯¾å±ˆæŠ˜ç‡ $n_{12}$ ã‚’ã€(1)ã®çµæœã‚’ä½¿ã£ã¦ç¢ºèªã›ã‚ˆã€‚
                </p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <div class="answer-content">
                        <p><strong>(1) å„åª’è³ªã§ã®æ³¢é•·</strong></p>
                        <p>
                            æ³¢ã®åŸºæœ¬å¼ $v = f\lambda$ ã‚ˆã‚Šã€$\lambda = \dfrac{v}{f}$
                        </p>
                        <p>
                            åª’è³ªâ… ï¼š$\lambda_1 = \dfrac{400}{500} = 0.8$ m
                        </p>
                        <p>
                            åª’è³ªâ…¡ï¼š$\lambda_2 = \dfrac{300}{500} = 0.6$ m
                        </p>
                        <p><strong>(2) ç›¸å¯¾å±ˆæŠ˜ç‡ã®ç¢ºèª</strong></p>
                        <p>
                            é€Ÿã•ã®æ¯”ã‹ã‚‰ï¼š$n_{12} = \dfrac{v_1}{v_2} = \dfrac{400}{300} = \dfrac{4}{3}$
                        </p>
                        <p>
                            æ³¢é•·ã®æ¯”ã‹ã‚‰ï¼š$n_{12} = \dfrac{\lambda_1}{\lambda_2} = \dfrac{0.8}{0.6} = \dfrac{4}{3}$
                        </p>
                        <p>
                            <strong>ç¢ºèªã§ãã¾ã—ãŸï¼</strong> é€Ÿã•ã®æ¯”ã¨æ³¢é•·ã®æ¯”ãŒç­‰ã—ããªã£ã¦ã„ã¾ã™ã€‚
                        </p>
                    </div>
                </details>
            </div>

            <div class="problem-section">
                <h4>å•é¡Œ3ï¼šå±ˆæŠ˜ã®æ³•å‰‡ã®ç†è§£</h4>
                <p>
                    æ¬¡ã®æ–‡ç« ã®ï¼ˆã€€ï¼‰ã«é©åˆ‡ãªèªå¥ã¾ãŸã¯æ•°å¼ã‚’å…¥ã‚Œã‚ˆã€‚
                </p>
                <p>
                    æ³¢ãŒç•°ãªã‚‹åª’è³ªã®å¢ƒç•Œé¢ã«å…¥å°„ã™ã‚‹ã¨ãã€ä¸€éƒ¨ã¯ï¼ˆ ã‚¢ ï¼‰ã—ã€æ®‹ã‚Šã¯ï¼ˆ ã‚¤ ï¼‰ã—ã¦é€²ã‚€ã€‚
                    å¢ƒç•Œé¢ã‚’é€šéã—ã¦ã‚‚ï¼ˆ ã‚¦ ï¼‰ã¯å¤‰åŒ–ã—ãªã„ãŒã€æ³¢ã®é€Ÿã•ãŒå¤‰ã‚ã‚‹ãŸã‚ï¼ˆ ã‚¨ ï¼‰ã¯å¤‰åŒ–ã™ã‚‹ã€‚
                    å±ˆæŠ˜ã®æ³•å‰‡ã«ãŠã„ã¦ã€$\sin\theta_1 : \sin\theta_2 = v_1 : v_2 = $ ï¼ˆ ã‚ª ï¼‰ ãŒæˆã‚Šç«‹ã¤ã€‚
                </p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <div class="answer-content">
                        <p>
                            ã‚¢ï¼š<strong>åå°„</strong><br>
                            ã‚¤ï¼š<strong>å±ˆæŠ˜</strong><br>
                            ã‚¦ï¼š<strong>æŒ¯å‹•æ•°</strong><br>
                            ã‚¨ï¼š<strong>æ³¢é•·</strong><br>
                            ã‚ªï¼š<strong>$\lambda_1 : \lambda_2$</strong>
                        </p>
                        <p style="margin-top: 15px;">
                            <strong>è§£èª¬</strong>ï¼šæ³¢ã®åŸºæœ¬å¼ $v = f\lambda$ ã«ãŠã„ã¦ã€æŒ¯å‹•æ•° $f$ ãŒä¸€å®šã®ã¾ã¾é€Ÿã• $v$ ãŒå¤‰ã‚ã‚‹ã¨ã€æ³¢é•· $\lambda$ ã‚‚åŒã˜å‰²åˆã§å¤‰åŒ–ã—ã¾ã™ã€‚ã“ã‚ŒãŒå±ˆæŠ˜ã®æ³•å‰‡ã®æœ¬è³ªã§ã™ã€‚
                        </p>
                    </div>
                </details>
            </div>
        </div>
        
        <div id="simulation" class="tab-content">
            <h2>å±ˆæŠ˜ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            <p>ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’å‹•ã‹ã—ã¦ã€å…¥å°„è§’ã‚„å±ˆæŠ˜ç‡ã‚’å¤‰ãˆãŸã¨ãã®å±ˆæŠ˜è§’ã®å¤‰åŒ–ã‚’è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚</p>
            
            <div id="sim-container">
                <canvas id="physicsCanvas"></canvas>
            </div>
            
            <div class="sim-controls">
                <div class="control-group">
                    <label>å…¥å°„è§’ Î¸â‚: <span class="value-display" id="theta1Display">30Â°</span></label>
                    <input type="range" id="theta1Slider" min="0" max="89" value="30" step="1">
                </div>
                
                <div class="control-group">
                    <label>åª’è³ªâ… ã®å±ˆæŠ˜ç‡ nâ‚: <span class="value-display" id="n1Display">1.0</span></label>
                    <input type="range" id="n1Slider" min="1.0" max="2.5" value="1.0" step="0.1">
                </div>
                
                <div class="control-group">
                    <label>åª’è³ªâ…¡ã®å±ˆæŠ˜ç‡ nâ‚‚: <span class="value-display" id="n2Display">1.5</span></label>
                    <input type="range" id="n2Slider" min="1.0" max="2.5" value="1.5" step="0.1">
                </div>
                
                <div class="button-group">
                    <button class="sim-button reset" id="resetBtn">ãƒªã‚»ãƒƒãƒˆ</button>
                </div>
                
                <div class="info-display">
                    <h4>ğŸ“Š è¨ˆç®—çµæœ</h4>
                    <p id="calcTheta2">å±ˆæŠ˜è§’ Î¸â‚‚ = 19.5Â°</p>
                    <p id="calcN12">ç›¸å¯¾å±ˆæŠ˜ç‡ nâ‚â‚‚ = 1.50</p>
                    <p id="calcRatio">sin Î¸â‚ / sin Î¸â‚‚ = 1.50</p>
                </div>
                
                <div class="discovery-box" id="discoveryBox">
                    <h4>ğŸ‰ ç™ºè¦‹ï¼å…¨åå°„</h4>
                    <p>
                        ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚ãªãŸã¯<strong>ã€Œå…¨åå°„ã€</strong>ã¨ã„ã†ç¾è±¡ã‚’ç™ºè¦‹ã—ã¾ã—ãŸï¼
                    </p>
                    <p>
                        æ³¢ãŒå±ˆæŠ˜ç‡ã®å¤§ãã„åª’è³ªï¼ˆnâ‚ï¼‰ã‹ã‚‰å°ã•ã„åª’è³ªï¼ˆnâ‚‚ï¼‰ã¸é€²ã‚€ã¨ãã€å…¥å°„è§’ãŒã‚ã‚‹è§’åº¦ï¼ˆ<strong>è‡¨ç•Œè§’</strong>ï¼‰ã‚’è¶…ãˆã‚‹ã¨ã€æ³¢ã¯å±ˆæŠ˜ã›ãšã«ã™ã¹ã¦åå°„ã—ã¾ã™ã€‚
                    </p>
                    <p id="criticalAngleInfo"></p>
                    <p>
                        ã“ã‚Œã¯å…‰ãƒ•ã‚¡ã‚¤ãƒãƒ¼ãªã©ã«å¿œç”¨ã•ã‚Œã¦ã„ã‚‹é‡è¦ãªç¾è±¡ã§ã™ã€‚ã€Œå…‰ã€ã®å˜å…ƒã§è©³ã—ãå­¦ã³ã¾ã™ï¼
                    </p>
                </div>
            </div>
            
            <div class="graph-container">
                <h3>å…¥å°„è§’ã¨å±ˆæŠ˜è§’ã®é–¢ä¿‚</h3>
                <canvas id="graphCanvas"></canvas>
            </div>
        </div>
    </div>
    
    <script>
    // --- ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½ ---
    function openTab(tabName) {
        var contents = document.getElementsByClassName("tab-content");
        for (var i = 0; i < contents.length; i++) {
            contents[i].style.display = "none";
            contents[i].classList.remove("active");
        }
        var buttons = document.getElementsByClassName("tab-btn");
        for (var i = 0; i < buttons.length; i++) {
            buttons[i].classList.remove("active");
        }
        document.getElementById(tabName).style.display = "block";
        document.getElementById(tabName).classList.add("active");
        if (event) {
            event.currentTarget.classList.add("active");
        }
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ–ãŒé–‹ã‹ã‚ŒãŸã¨ãã«Canvasã‚’å†æç”»
        if (tabName === 'simulation') {
            resizeCanvas();
            draw();
        }
    }

    // --- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ---
    const canvas = document.getElementById('physicsCanvas');
    const ctx = canvas.getContext('2d');
    const graphCanvas = document.getElementById('graphCanvas');
    const graphCtx = graphCanvas.getContext('2d');
    
    // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã¨è¡¨ç¤ºè¦ç´ 
    const theta1Slider = document.getElementById('theta1Slider');
    const n1Slider = document.getElementById('n1Slider');
    const n2Slider = document.getElementById('n2Slider');
    const theta1Display = document.getElementById('theta1Display');
    const n1Display = document.getElementById('n1Display');
    const n2Display = document.getElementById('n2Display');
    const calcTheta2 = document.getElementById('calcTheta2');
    const calcN12 = document.getElementById('calcN12');
    const calcRatio = document.getElementById('calcRatio');
    const discoveryBox = document.getElementById('discoveryBox');
    const criticalAngleInfo = document.getElementById('criticalAngleInfo');
    const resetBtn = document.getElementById('resetBtn');
    
    // ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    let theta1 = 30; // å…¥å°„è§’ï¼ˆåº¦ï¼‰
    let n1 = 1.0;    // åª’è³ªâ… ã®å±ˆæŠ˜ç‡
    let n2 = 1.5;    // åª’è³ªâ…¡ã®å±ˆæŠ˜ç‡
    
    // å…¨åå°„ç™ºè¦‹ãƒ•ãƒ©ã‚°
    let totalReflectionDiscovered = false;
    
    // åº¦ã‚’ãƒ©ã‚¸ã‚¢ãƒ³ã«å¤‰æ›
    function toRad(deg) {
        return deg * Math.PI / 180;
    }
    
    // ãƒ©ã‚¸ã‚¢ãƒ³ã‚’åº¦ã«å¤‰æ›
    function toDeg(rad) {
        return rad * 180 / Math.PI;
    }
    
    // å±ˆæŠ˜è§’ã‚’è¨ˆç®—ï¼ˆå…¨åå°„ã®å ´åˆã¯nullã‚’è¿”ã™ï¼‰
    function calcTheta2Angle(theta1Deg, n1Val, n2Val) {
        const sinTheta1 = Math.sin(toRad(theta1Deg));
        const sinTheta2 = (n1Val / n2Val) * sinTheta1;
        
        if (sinTheta2 > 1) {
            return null; // å…¨åå°„
        }
        return toDeg(Math.asin(sinTheta2));
    }
    
    // è‡¨ç•Œè§’ã‚’è¨ˆç®—
    function calcCriticalAngle(n1Val, n2Val) {
        if (n1Val <= n2Val) return null;
        return toDeg(Math.asin(n2Val / n1Val));
    }
    
    // Canvasã®ãƒªã‚µã‚¤ã‚º
    function resizeCanvas() {
        const container = canvas.parentElement;
        canvas.width = container.clientWidth;
        canvas.height = 400;
        
        graphCanvas.width = graphCanvas.parentElement.clientWidth - 30;
        graphCanvas.height = 250;
    }
    
    // ãƒ¡ã‚¤ãƒ³æç”»é–¢æ•°
    function draw() {
        const W = canvas.width;
        const H = canvas.height;
        
        // èƒŒæ™¯ã‚¯ãƒªã‚¢
        ctx.clearRect(0, 0, W, H);
        
        // å¢ƒç•Œé¢ã®ä½ç½®
        const boundaryY = H / 2;
        const centerX = W / 2;
        
        // åª’è³ªâ… ï¼ˆä¸ŠåŠåˆ†ï¼‰
        ctx.fillStyle = '#e3f2fd';
        ctx.fillRect(0, 0, W, boundaryY);
        
        // åª’è³ªâ…¡ï¼ˆä¸‹åŠåˆ†ï¼‰
        ctx.fillStyle = '#bbdefb';
        ctx.fillRect(0, boundaryY, W, boundaryY);
        
        // å¢ƒç•Œé¢
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(0, boundaryY);
        ctx.lineTo(W, boundaryY);
        ctx.stroke();
        
        // åª’è³ªãƒ©ãƒ™ãƒ«
        ctx.fillStyle = '#1565c0';
        ctx.font = 'bold 16px sans-serif';
        ctx.fillText('åª’è³ªâ…  (nâ‚ = ' + n1.toFixed(1) + ')', 10, 25);
        ctx.fillStyle = '#0d47a1';
        ctx.fillText('åª’è³ªâ…¡ (nâ‚‚ = ' + n2.toFixed(1) + ')', 10, boundaryY + 25);
        
        // æ³•ç·šï¼ˆç‚¹ç·šï¼‰
        ctx.strokeStyle = '#999';
        ctx.lineWidth = 1;
        ctx.setLineDash([5, 5]);
        ctx.beginPath();
        ctx.moveTo(centerX, 0);
        ctx.lineTo(centerX, H);
        ctx.stroke();
        ctx.setLineDash([]);
        
        // æ³•ç·šãƒ©ãƒ™ãƒ«
        ctx.fillStyle = '#666';
        ctx.font = '12px sans-serif';
        ctx.fillText('æ³•ç·š', centerX + 5, 15);
        
        // å…‰ç·šã®é•·ã•
        const rayLength = Math.min(W, H) * 0.35;
        
        // å…¥å°„è§’ï¼ˆãƒ©ã‚¸ã‚¢ãƒ³ï¼‰
        const theta1Rad = toRad(theta1);
        
        // å…¥å°„å…‰ç·šã®æç”»
        const incidentStartX = centerX - rayLength * Math.sin(theta1Rad);
        const incidentStartY = boundaryY - rayLength * Math.cos(theta1Rad);
        
        ctx.strokeStyle = '#f44336';
        ctx.lineWidth = 3;
        ctx.beginPath();
        ctx.moveTo(incidentStartX, incidentStartY);
        ctx.lineTo(centerX, boundaryY);
        ctx.stroke();
        
        // å…¥å°„å…‰ç·šã®çŸ¢å°
        drawArrow(ctx, incidentStartX, incidentStartY, centerX, boundaryY, '#f44336');
        
        // å…¥å°„è§’ã®å¼§ã‚’æç”»
        ctx.strokeStyle = '#f44336';
        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.arc(centerX, boundaryY, 40, -Math.PI/2, -Math.PI/2 + theta1Rad);
        ctx.stroke();
        
        // å…¥å°„è§’ãƒ©ãƒ™ãƒ«ï¼ˆæ³•ç·šã¨å…¥å°„å…‰ç·šã®é–“ã€å¼§ã®è¿‘ãã«é…ç½®ï¼‰
        ctx.fillStyle = '#f44336';
        ctx.font = 'bold 14px sans-serif';
        const theta1LabelRadius = 65;
        const theta1LabelAngle = theta1Rad / 2;
        const theta1LabelX = centerX + theta1LabelRadius * Math.sin(theta1LabelAngle);
        const theta1LabelY = boundaryY - theta1LabelRadius * Math.cos(theta1LabelAngle);
        ctx.fillText('Î¸â‚ = ' + theta1 + 'Â°', theta1LabelX, theta1LabelY);
        
        // å±ˆæŠ˜è§’ã®è¨ˆç®—
        const theta2Deg = calcTheta2Angle(theta1, n1, n2);
        const isTotalReflection = (theta2Deg === null);
        
        // åå°„å…‰ç·šï¼ˆå¸¸ã«æç”»ï¼‰
        const reflectEndX = centerX + rayLength * Math.sin(theta1Rad);
        const reflectEndY = boundaryY - rayLength * Math.cos(theta1Rad);
        
        ctx.strokeStyle = isTotalReflection ? '#ff9800' : '#9c27b0';
        ctx.lineWidth = isTotalReflection ? 3 : 2;
        ctx.globalAlpha = isTotalReflection ? 1 : 0.5;
        ctx.beginPath();
        ctx.moveTo(centerX, boundaryY);
        ctx.lineTo(reflectEndX, reflectEndY);
        ctx.stroke();
        ctx.globalAlpha = 1;
        
        // åå°„å…‰ç·šã®çŸ¢å°
        drawArrow(ctx, centerX, boundaryY, reflectEndX, reflectEndY, 
                  isTotalReflection ? '#ff9800' : '#9c27b0');
        
        if (isTotalReflection) {
            // å…¨åå°„ã®å ´åˆ
            ctx.fillStyle = '#ff9800';
            ctx.font = 'bold 16px sans-serif';
            ctx.fillText('å…¨åå°„ï¼', centerX + 50, boundaryY - 30);
            
            // å…¨åå°„ç™ºè¦‹
            if (!totalReflectionDiscovered) {
                totalReflectionDiscovered = true;
                discoveryBox.classList.add('visible');
                const criticalAngle = calcCriticalAngle(n1, n2);
                criticalAngleInfo.innerHTML = 'ä»Šã®æ¡ä»¶ã§ã®<strong>è‡¨ç•Œè§’ã¯ç´„ ' + 
                    criticalAngle.toFixed(1) + 'Â°</strong> ã§ã™ã€‚';
            }
            
            // è¨ˆç®—çµæœã®æ›´æ–°
            calcTheta2.textContent = 'å±ˆæŠ˜è§’ Î¸â‚‚ = å…¨åå°„ï¼ˆå±ˆæŠ˜ãªã—ï¼‰';
        } else {
            // å±ˆæŠ˜å…‰ç·šã®æç”»
            const theta2Rad = toRad(theta2Deg);
            const refractEndX = centerX + rayLength * Math.sin(theta2Rad);
            const refractEndY = boundaryY + rayLength * Math.cos(theta2Rad);
            
            ctx.strokeStyle = '#2196f3';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(centerX, boundaryY);
            ctx.lineTo(refractEndX, refractEndY);
            ctx.stroke();
            
            // å±ˆæŠ˜å…‰ç·šã®çŸ¢å°
            drawArrow(ctx, centerX, boundaryY, refractEndX, refractEndY, '#2196f3');
            
            // å±ˆæŠ˜è§’ã®å¼§ã‚’æç”»ï¼ˆæ³•ç·šã‹ã‚‰å±ˆæŠ˜å…‰ç·šã¾ã§ï¼‰
            ctx.strokeStyle = '#2196f3';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(centerX, boundaryY, 40, Math.PI/2 - theta2Rad, Math.PI/2);
            ctx.stroke();
            
            // å±ˆæŠ˜è§’ãƒ©ãƒ™ãƒ«ï¼ˆæ³•ç·šã¨å±ˆæŠ˜å…‰ç·šã®é–“ã€å¼§ã®è¿‘ãã«é…ç½®ï¼‰
            ctx.fillStyle = '#2196f3';
            ctx.font = 'bold 14px sans-serif';
            const theta2LabelRadius = 65;
            const theta2LabelAngle = theta2Rad / 2;
            const theta2LabelX = centerX + theta2LabelRadius * Math.sin(theta2LabelAngle);
            const theta2LabelY = boundaryY + theta2LabelRadius * Math.cos(theta2LabelAngle);
            ctx.fillText('Î¸â‚‚ = ' + theta2Deg.toFixed(1) + 'Â°', theta2LabelX, theta2LabelY);
            
            // è¨ˆç®—çµæœã®æ›´æ–°
            calcTheta2.textContent = 'å±ˆæŠ˜è§’ Î¸â‚‚ = ' + theta2Deg.toFixed(1) + 'Â°';
        }
        
        // ç›¸å¯¾å±ˆæŠ˜ç‡ã¨æ¯”ã®è¨ˆç®—
        const n12 = n2 / n1;
        calcN12.textContent = 'ç›¸å¯¾å±ˆæŠ˜ç‡ nâ‚â‚‚ = nâ‚‚/nâ‚ = ' + n12.toFixed(2);
        
        if (!isTotalReflection && theta1 > 0) {
            const sinRatio = Math.sin(toRad(theta1)) / Math.sin(toRad(theta2Deg));
            calcRatio.textContent = 'sin Î¸â‚ / sin Î¸â‚‚ = ' + sinRatio.toFixed(2) + 
                ' ï¼ˆnâ‚â‚‚ã¨ä¸€è‡´ï¼ï¼‰';
        } else if (theta1 === 0) {
            calcRatio.textContent = 'Î¸â‚ = 0Â° ã®ã¨ãã€Î¸â‚‚ = 0Â°ï¼ˆç›´é€²ï¼‰';
        } else {
            calcRatio.textContent = 'sin Î¸â‚ / sin Î¸â‚‚ = è¨ˆç®—ä¸å¯ï¼ˆå…¨åå°„ï¼‰';
        }
        
        // å‡¡ä¾‹
        ctx.font = '12px sans-serif';
        ctx.fillStyle = '#f44336';
        ctx.fillText('â— å…¥å°„å…‰ç·š', W - 100, 20);
        ctx.fillStyle = '#2196f3';
        ctx.fillText('â— å±ˆæŠ˜å…‰ç·š', W - 100, 40);
        ctx.fillStyle = '#9c27b0';
        ctx.fillText('â— åå°„å…‰ç·š', W - 100, 60);
        
        // ã‚°ãƒ©ãƒ•ã®æç”»
        drawGraph();
    }
    
    // çŸ¢å°ã‚’æç”»ã™ã‚‹é–¢æ•°
    function drawArrow(ctx, fromX, fromY, toX, toY, color) {
        const headLength = 12;
        const angle = Math.atan2(toY - fromY, toX - fromX);
        
        ctx.fillStyle = color;
        ctx.beginPath();
        ctx.moveTo(toX, toY);
        ctx.lineTo(toX - headLength * Math.cos(angle - Math.PI/6), 
                   toY - headLength * Math.sin(angle - Math.PI/6));
        ctx.lineTo(toX - headLength * Math.cos(angle + Math.PI/6), 
                   toY - headLength * Math.sin(angle + Math.PI/6));
        ctx.closePath();
        ctx.fill();
    }
    
    // ã‚°ãƒ©ãƒ•æç”»é–¢æ•°
    function drawGraph() {
        const W = graphCanvas.width;
        const H = graphCanvas.height;
        const padding = 50;
        const graphW = W - padding * 2;
        const graphH = H - padding * 2;
        
        // èƒŒæ™¯ã‚¯ãƒªã‚¢
        graphCtx.clearRect(0, 0, W, H);
        graphCtx.fillStyle = '#fafafa';
        graphCtx.fillRect(0, 0, W, H);
        
        // ã‚°ãƒ©ãƒ•ã‚¨ãƒªã‚¢
        graphCtx.fillStyle = 'white';
        graphCtx.fillRect(padding, padding, graphW, graphH);
        graphCtx.strokeStyle = '#333';
        graphCtx.lineWidth = 1;
        graphCtx.strokeRect(padding, padding, graphW, graphH);
        
        // è»¸ãƒ©ãƒ™ãƒ«
        graphCtx.fillStyle = '#333';
        graphCtx.font = '14px sans-serif';
        graphCtx.fillText('å…¥å°„è§’ Î¸â‚ [Â°]', W/2 - 40, H - 10);
        graphCtx.save();
        graphCtx.translate(15, H/2);
        graphCtx.rotate(-Math.PI/2);
        graphCtx.fillText('å±ˆæŠ˜è§’ Î¸â‚‚ [Â°]', -40, 0);
        graphCtx.restore();
        
        // ç›®ç››ã‚Š
        graphCtx.font = '11px sans-serif';
        graphCtx.fillStyle = '#666';
        for (let i = 0; i <= 90; i += 15) {
            const x = padding + (i / 90) * graphW;
            graphCtx.fillText(i.toString(), x - 8, H - padding + 20);
            
            // ã‚°ãƒªãƒƒãƒ‰ç·š
            graphCtx.strokeStyle = '#eee';
            graphCtx.beginPath();
            graphCtx.moveTo(x, padding);
            graphCtx.lineTo(x, H - padding);
            graphCtx.stroke();
        }
        for (let i = 0; i <= 90; i += 15) {
            const y = H - padding - (i / 90) * graphH;
            graphCtx.fillText(i.toString(), padding - 25, y + 4);
            
            // ã‚°ãƒªãƒƒãƒ‰ç·š
            graphCtx.strokeStyle = '#eee';
            graphCtx.beginPath();
            graphCtx.moveTo(padding, y);
            graphCtx.lineTo(W - padding, y);
            graphCtx.stroke();
        }
        
        // Î¸â‚ = Î¸â‚‚ ã®ç›´ç·šï¼ˆå‚è€ƒç·šï¼‰
        graphCtx.strokeStyle = '#ddd';
        graphCtx.lineWidth = 1;
        graphCtx.setLineDash([5, 5]);
        graphCtx.beginPath();
        graphCtx.moveTo(padding, H - padding);
        graphCtx.lineTo(W - padding, padding);
        graphCtx.stroke();
        graphCtx.setLineDash([]);
        
        // å±ˆæŠ˜è§’ã®æ›²ç·š
        graphCtx.strokeStyle = '#2196f3';
        graphCtx.lineWidth = 2;
        graphCtx.beginPath();
        
        let criticalAngle = 90;
        if (n1 > n2) {
            criticalAngle = toDeg(Math.asin(n2 / n1));
        }
        
        let firstPoint = true;
        for (let t1 = 0; t1 <= 90; t1 += 0.5) {
            const t2 = calcTheta2Angle(t1, n1, n2);
            if (t2 !== null) {
                const x = padding + (t1 / 90) * graphW;
                const y = H - padding - (t2 / 90) * graphH;
                if (firstPoint) {
                    graphCtx.moveTo(x, y);
                    firstPoint = false;
                } else {
                    graphCtx.lineTo(x, y);
                }
            }
        }
        graphCtx.stroke();
        
        // å…¨åå°„é ˜åŸŸã®è¡¨ç¤º
        if (n1 > n2) {
            graphCtx.fillStyle = 'rgba(255, 152, 0, 0.2)';
            const critX = padding + (criticalAngle / 90) * graphW;
            graphCtx.fillRect(critX, padding, W - padding - critX, graphH);
            
            // è‡¨ç•Œè§’ã®ç·š
            graphCtx.strokeStyle = '#ff9800';
            graphCtx.lineWidth = 2;
            graphCtx.setLineDash([5, 5]);
            graphCtx.beginPath();
            graphCtx.moveTo(critX, padding);
            graphCtx.lineTo(critX, H - padding);
            graphCtx.stroke();
            graphCtx.setLineDash([]);
            
            graphCtx.fillStyle = '#ff9800';
            graphCtx.font = '12px sans-serif';
            graphCtx.fillText('è‡¨ç•Œè§’', critX + 5, padding + 15);
            graphCtx.fillText('å…¨åå°„é ˜åŸŸ', critX + 5, padding + 35);
        }
        
        // ç¾åœ¨ã®ç‚¹ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
        const theta2Deg = calcTheta2Angle(theta1, n1, n2);
        if (theta2Deg !== null) {
            const px = padding + (theta1 / 90) * graphW;
            const py = H - padding - (theta2Deg / 90) * graphH;
            
            graphCtx.fillStyle = '#f44336';
            graphCtx.beginPath();
            graphCtx.arc(px, py, 6, 0, Math.PI * 2);
            graphCtx.fill();
            
            // è£œåŠ©ç·š
            graphCtx.strokeStyle = '#f44336';
            graphCtx.lineWidth = 1;
            graphCtx.setLineDash([3, 3]);
            graphCtx.beginPath();
            graphCtx.moveTo(px, py);
            graphCtx.lineTo(px, H - padding);
            graphCtx.moveTo(px, py);
            graphCtx.lineTo(padding, py);
            graphCtx.stroke();
            graphCtx.setLineDash([]);
        } else {
            // å…¨åå°„æ™‚ã¯è‡¨ç•Œè§’ã®ä½ç½®ã«ç‚¹ã‚’è¡¨ç¤º
            const critAngle = calcCriticalAngle(n1, n2);
            if (critAngle !== null) {
                const px = padding + (theta1 / 90) * graphW;
                graphCtx.fillStyle = '#ff9800';
                graphCtx.beginPath();
                graphCtx.arc(px, padding + 20, 6, 0, Math.PI * 2);
                graphCtx.fill();
            }
        }
    }
    
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    theta1Slider.addEventListener('input', function() {
        theta1 = parseFloat(this.value);
        theta1Display.textContent = theta1 + 'Â°';
        draw();
    });
    
    n1Slider.addEventListener('input', function() {
        n1 = parseFloat(this.value);
        n1Display.textContent = n1.toFixed(1);
        
        // å…¨åå°„ç™ºè¦‹ãƒœãƒƒã‚¯ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæ¡ä»¶ãŒå¤‰ã‚ã£ãŸå ´åˆï¼‰
        if (n1 <= n2) {
            discoveryBox.classList.remove('visible');
            totalReflectionDiscovered = false;
        }
        draw();
    });
    
    n2Slider.addEventListener('input', function() {
        n2 = parseFloat(this.value);
        n2Display.textContent = n2.toFixed(1);
        
        // å…¨åå°„ç™ºè¦‹ãƒœãƒƒã‚¯ã‚¹ã‚’ãƒªã‚»ãƒƒãƒˆï¼ˆæ¡ä»¶ãŒå¤‰ã‚ã£ãŸå ´åˆï¼‰
        if (n1 <= n2) {
            discoveryBox.classList.remove('visible');
            totalReflectionDiscovered = false;
        }
        draw();
    });
    
    resetBtn.addEventListener('click', function() {
        theta1 = 30;
        n1 = 1.0;
        n2 = 1.5;
        
        theta1Slider.value = theta1;
        n1Slider.value = n1;
        n2Slider.value = n2;
        
        theta1Display.textContent = theta1 + 'Â°';
        n1Display.textContent = n1.toFixed(1);
        n2Display.textContent = n2.toFixed(1);
        
        discoveryBox.classList.remove('visible');
        totalReflectionDiscovered = false;
        
        draw();
    });
    
    // ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
    window.addEventListener('resize', function() {
        resizeCanvas();
        draw();
    });
    
    // åˆæœŸåŒ–
    resizeCanvas();
    draw();
    </script>
</body>
</html>