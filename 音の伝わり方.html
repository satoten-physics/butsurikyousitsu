<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ ¡ç‰©ç† - éŸ³ã®ä¼ã‚ã‚Šæ–¹</title>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .back-link {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        h1 {
            color: #333;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        .tab-btn:hover {
            background: #8899f0;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        h3 {
            color: #555;
            margin: 25px 0 15px 0;
            padding-bottom: 5px;
            border-bottom: 2px solid #667eea;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 10px;
        }
        .section p {
            line-height: 1.8;
            margin-bottom: 10px;
        }
        .important-box {
            background: linear-gradient(135deg, #667eea20, #764ba220);
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin: 15px 0;
            border-radius: 0 10px 10px 0;
        }
        .formula-box {
            background: #fff;
            border: 2px solid #667eea;
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
            text-align: center;
            font-size: 1.2em;
        }
        .interactive-tool {
            background: #fff;
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .interactive-tool h4 {
            color: #667eea;
            margin-bottom: 15px;
        }
        .tool-canvas {
            display: block;
            width: 100%;
            background: #1a1a2e;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .tool-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
        }
        .tool-controls label {
            font-weight: bold;
            color: #333;
        }
        .tool-controls input[type="range"] {
            width: 150px;
        }
        .tool-value {
            background: #667eea;
            color: white;
            padding: 5px 12px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
        }
        
        /* å•é¡Œã‚¿ãƒ–ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .problem {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .problem h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        .problem p {
            line-height: 1.8;
        }
        details {
            margin-top: 15px;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px 15px;
        }
        summary {
            cursor: pointer;
            font-weight: bold;
            color: #667eea;
        }
        details[open] summary {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        .answer {
            padding: 10px;
            line-height: 1.8;
        }
        
        /* ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        #sim-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        #physicsCanvas {
            display: block;
            width: 100%;
            background: #1a1a2e;
            border-radius: 5px;
            border: 2px solid #ddd;
            cursor: crosshair;
        }
        .sim-controls {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .control-group input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .value-display {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 100px;
            text-align: center;
        }
        .info-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .info-item {
            background: #fff;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ddd;
            text-align: center;
        }
        .info-item .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 5px;
        }
        .info-item .value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .sim-button {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .sim-button.start {
            background: #4CAF50;
            color: white;
        }
        .sim-button.start:hover {
            background: #45a049;
        }
        .sim-button.reset {
            background: #f44336;
            color: white;
        }
        .sim-button.reset:hover {
            background: #da190b;
        }
        .graph-container {
            margin-top: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ddd;
        }
        .graph-container h3 {
            color: #667eea;
            margin-bottom: 10px;
            border-bottom: none;
        }
        #graphCanvas {
            display: block;
            width: 100%;
            border: 1px solid #eee;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 3px;
        }
        .instructions {
            background: #e8f4fd;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #2196F3;
        }
        .instructions p {
            margin: 5px 0;
            color: #333;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            header, .container {
                padding: 15px;
            }
            .tab-btn {
                min-width: 100px;
                font-size: 14px;
            }
            .tool-controls {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
        <h1>éŸ³ã®ä¼ã‚ã‚Šæ–¹</h1>
    </header>
    <div class="container">
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('lecture')">è§£èª¬ç·¨</button>
            <button class="tab-btn" onclick="openTab('problem')">å•é¡Œç·¨</button>
            <button class="tab-btn" onclick="openTab('simulation')">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
        </div>
        
        <!-- ==================== è§£èª¬ã‚¿ãƒ– ==================== -->
        <div id="lecture" class="tab-content active">
            <h2>éŸ³ã®ä¼ã‚ã‚Šæ–¹</h2>
            
            <div class="section">
                <h3>1. éŸ³é€Ÿã¨ã¯</h3>
                <p>éŸ³æ³¢ãŒåª’è³ªä¸­ã‚’ä¼ã‚ã‚‹é€Ÿã•ã‚’<strong>éŸ³é€Ÿ</strong>ã¨ã„ã„ã€$V$ [m/s] ã§è¡¨ã—ã¾ã™ã€‚</p>
                <p>ç©ºæ°—ä¸­ã®éŸ³é€Ÿã¯ç´„ <strong>340 m/s</strong> ã§ã™ã€‚ã“ã‚Œã¯æ™‚é€Ÿã«æ›ç®—ã™ã‚‹ã¨ç´„ 1224 km/h ã§ã€ã‚¸ã‚§ãƒƒãƒˆæ—…å®¢æ©Ÿã‚ˆã‚Šã‚‚é€Ÿã„é€Ÿåº¦ã§ã™ã€‚</p>
                
                <div class="important-box">
                    <strong>ğŸ“Œ é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong><br>
                    éŸ³é€Ÿã¯ä»¥ä¸‹ã®2ã¤ã®è¦å› ã§å¤‰åŒ–ã—ã¾ã™ï¼š
                    <ul style="margin-top: 10px; margin-left: 20px;">
                        <li><strong>åª’è³ªã®ç¨®é¡</strong>ã«ã‚ˆã£ã¦å¤‰åŒ–ã™ã‚‹</li>
                        <li><strong>æ¸©åº¦</strong>ã«ã‚ˆã£ã¦å¤‰åŒ–ã™ã‚‹</li>
                    </ul>
                </div>
            </div>
            
            <div class="section">
                <h3>2. åª’è³ªã«ã‚ˆã‚‹éŸ³é€Ÿã®é•ã„</h3>
                <p>éŸ³ã¯ç¸¦æ³¢ã§ã‚ã‚Šã€æ°—ä½“ã ã‘ã§ãªãæ¶²ä½“ã‚„å›ºä½“ã®ä¸­ã‚‚ä¼ã‚ã‚Šã¾ã™ã€‚ä¸€èˆ¬ã«ã€åª’è³ªãŒå¯†ãªã»ã©éŸ³é€Ÿã¯é€Ÿããªã‚Šã¾ã™ã€‚</p>
                
                <div class="formula-box">
                    éŸ³é€Ÿã®å¤§å°é–¢ä¿‚ï¼š<strong>æ°—ä½“ ï¼œ æ¶²ä½“ ï¼œ å›ºä½“</strong>
                </div>
                
                <p>å…·ä½“çš„ãªå€¤ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š</p>
                <ul style="margin-left: 20px; line-height: 2;">
                    <li>ç©ºæ°—ä¸­ï¼ˆ0â„ƒï¼‰ï¼šç´„ <strong>331.5 m/s</strong></li>
                    <li>ãƒ˜ãƒªã‚¦ãƒ ä¸­ï¼šç´„ <strong>970 m/s</strong>ï¼ˆç©ºæ°—ã‚ˆã‚Šè»½ã„æ°—ä½“ãªã®ã§é€Ÿã„ï¼‰</li>
                    <li>æ°´ä¸­ï¼šç´„ <strong>1500 m/s</strong></li>
                    <li>é‰„ä¸­ï¼šç´„ <strong>6000 m/s</strong></li>
                </ul>
                
                <div class="important-box">
                    <strong>ğŸ’¡ ãªãœçœŸç©ºä¸­ã§ã¯éŸ³ãŒä¼ã‚ã‚‰ãªã„ã®ã‹ï¼Ÿ</strong><br>
                    éŸ³ã¯åª’è³ªï¼ˆç©ºæ°—åˆ†å­ãªã©ï¼‰ã®æŒ¯å‹•ãŒæ¬¡ã€…ã¨ä¼ã‚ã‚‹ç¾è±¡ã§ã™ã€‚çœŸç©ºä¸­ã«ã¯æŒ¯å‹•ã‚’ä¼ãˆã‚‹åª’è³ªãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€éŸ³ã¯ä¼ã‚ã‚Šã¾ã›ã‚“ã€‚
                </div>
            </div>
            
            <div class="section">
                <h3>3. æ¸©åº¦ã«ã‚ˆã‚‹éŸ³é€Ÿã®å¤‰åŒ–</h3>
                <p>ç©ºæ°—ä¸­ã®éŸ³é€Ÿã¯ã€æ¸©åº¦ $t$ [â„ƒ] ã®ã¨ãæ¬¡ã®å¼ã§è¡¨ã•ã‚Œã¾ã™ï¼š</p>
                
                <div class="formula-box">
                    $V = 331.5 + 0.6t$ [m/s]
                </div>
                
                <p>æ¸©åº¦ãŒ1â„ƒä¸ŠãŒã‚‹ã¨ã€éŸ³é€Ÿã¯ç´„0.6 m/s é€Ÿããªã‚Šã¾ã™ã€‚</p>
                <p>ã“ã‚Œã¯ã€<strong>æ¸©åº¦ãŒé«˜ã„ã»ã©ç©ºæ°—åˆ†å­ã®ç†±é‹å‹•ãŒæ¿€ã—ããªã‚Šã€æŒ¯å‹•ãŒã‚ˆã‚Šé€Ÿãä¼ã‚ã‚‹</strong>ãŸã‚ã§ã™ã€‚</p>
                
                <!-- æ¸©åº¦ã¨åˆ†å­é‹å‹•ã®å‹•çš„ãƒ„ãƒ¼ãƒ« -->
                <div class="interactive-tool">
                    <h4>ğŸ”¬ æ¸©åº¦ã¨ç©ºæ°—åˆ†å­ã®é‹å‹•</h4>
                    <p style="margin-bottom: 15px; color: #666;">æ¸©åº¦ã‚’å¤‰ãˆã¦ã€ç©ºæ°—åˆ†å­ã®é‹å‹•ã®æ§˜å­ã‚’è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚é«˜æ¸©ã«ãªã‚‹ã»ã©åˆ†å­ã®å‹•ããŒæ¿€ã—ããªã‚Šã€éŸ³ã®ä¼é”ãŒé€Ÿããªã‚Šã¾ã™ã€‚</p>
                    <canvas id="tempMoleculeCanvas" class="tool-canvas" height="250"></canvas>
                    <div class="tool-controls">
                        <label>æ¸©åº¦ï¼š</label>
                        <input type="range" id="tempSlider" min="-20" max="40" value="15" step="1">
                        <span class="tool-value" id="tempValue">15 â„ƒ</span>
                        <span style="margin-left: 20px;">éŸ³é€Ÿï¼š</span>
                        <span class="tool-value" id="tempSoundSpeed">340.5 m/s</span>
                    </div>
                </div>
            </div>
            
            <div class="section">
                <h3>4. é¢¨ã«ã‚ˆã‚‹è¦‹ã‹ã‘ã®éŸ³é€Ÿå¤‰åŒ–</h3>
                <p>é¢¨ãŒå¹ã„ã¦ã„ã‚‹ã¨ãã€è¦³æ¸¬ã•ã‚Œã‚‹éŸ³é€Ÿã¯å¤‰åŒ–ã—ã¾ã™ã€‚é¢¨é€Ÿã‚’ $v$ [m/s]ã€ç„¡é¢¨æ™‚ã®éŸ³é€Ÿã‚’ $V$ [m/s] ã¨ã™ã‚‹ã¨ï¼š</p>
                
                <div class="formula-box">
                    è¦‹ã‹ã‘ã®éŸ³é€Ÿï¼š$V' = V + v$ï¼ˆé¢¨ãŒéŸ³ã®é€²è¡Œæ–¹å‘ã¨åŒã˜å‘ãã®ã¨ãï¼‰<br>
                    è¦‹ã‹ã‘ã®éŸ³é€Ÿï¼š$V' = V - v$ï¼ˆé¢¨ãŒéŸ³ã®é€²è¡Œæ–¹å‘ã¨é€†å‘ãã®ã¨ãï¼‰
                </div>
                
                <p>ã“ã‚Œã¯ã€<strong>ç©ºæ°—åˆ†å­å…¨ä½“ãŒé¢¨ã«ã‚ˆã£ã¦ç§»å‹•ã™ã‚‹</strong>ãŸã‚ã€ãã®ä¸­ã‚’ä¼ã‚ã‚‹éŸ³ã‚‚ä¸€ç·’ã«é‹ã°ã‚Œã‚‹ã‹ã‚‰ã§ã™ã€‚</p>
                
                <!-- é¢¨ã¨éŸ³é€Ÿã®å‹•çš„ãƒ„ãƒ¼ãƒ« -->
                <div class="interactive-tool">
                    <h4>ğŸŒ¬ï¸ é¢¨ã¨ç©ºæ°—åˆ†å­ã®å‹•ã</h4>
                    <p style="margin-bottom: 15px; color: #666;">é¢¨é€Ÿã‚’å¤‰ãˆã¦ã€ç©ºæ°—åˆ†å­ã¨éŸ³æ³¢ãŒã©ã®ã‚ˆã†ã«é‹ã°ã‚Œã‚‹ã‹è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚ç©ºæ°—åˆ†å­å…¨ä½“ãŒé¢¨ã§æµã•ã‚Œã‚‹ãŸã‚ã€éŸ³æ³¢ã‚‚ä¸€ç·’ã«ç§»å‹•ã—ã¾ã™ã€‚</p>
                    <canvas id="windMoleculeCanvas" class="tool-canvas" height="280"></canvas>
                    <div class="tool-controls">
                        <label>é¢¨é€Ÿï¼š</label>
                        <input type="range" id="windSlider" min="-15" max="15" value="0" step="1">
                        <span class="tool-value" id="windValue">0 m/s</span>
                        <span style="margin-left: 20px;">è¦‹ã‹ã‘ã®éŸ³é€Ÿï¼š</span>
                        <span class="tool-value" id="windSoundSpeed">340 m/s</span>
                    </div>
                </div>
                
                <div class="important-box">
                    <strong>âš ï¸ é‡è¦ãªæ³¨æ„ç‚¹</strong><br>
                    éŸ³æºãŒå‹•ã„ã¦ã‚‚ã€éŸ³é€Ÿè‡ªä½“ã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ï¼éŸ³é€Ÿã¯åª’è³ªï¼ˆç©ºæ°—ï¼‰ã«ã‚ˆã£ã¦æ±ºã¾ã‚‹ã‚‚ã®ã§ã‚ã‚Šã€éŸ³æºã®é€Ÿåº¦ã¨ã¯ç‹¬ç«‹ã—ã¦ã„ã¾ã™ã€‚<br>
                    é¢¨ã«ã‚ˆã£ã¦éŸ³é€ŸãŒå¤‰åŒ–ã™ã‚‹ã®ã¯ã€åª’è³ªã§ã‚ã‚‹ç©ºæ°—è‡ªä½“ãŒå‹•ãã‹ã‚‰ã§ã™ã€‚
                </div>
            </div>
            
            <div class="section">
                <h3>ğŸ“– æˆæ¥­è³‡æ–™</h3>
                <iframe src="https://drive.google.com/file/d/1rd3AUHNkj-NLM0IEztEdsiVOdPwxD6EA/preview" width="100%" height="500" style="border-radius: 5px;"></iframe>
            </div>
        </div>
        
        <!-- ==================== å•é¡Œã‚¿ãƒ– ==================== -->
        <div id="problem" class="tab-content">
            <h2>ç¢ºèªå•é¡Œ</h2>
            
            <div class="problem">
                <h4>å•é¡Œ1</h4>
                <p>çœŸç©ºä¸­ã§ã¯ã€éŸ³æ³¢ã¯ä¼ã‚ã‚‰ãªã„ã€‚ãã®ç†ç”±ã‚’èª¬æ˜ã›ã‚ˆã€‚</p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <div class="answer">
                        <p><strong>ã€è§£ç­”ã€‘</strong></p>
                        <p>éŸ³æ³¢ã¯åª’è³ªï¼ˆç©ºæ°—åˆ†å­ãªã©ï¼‰ã®æŒ¯å‹•ãŒæ¬¡ã€…ã¨éš£ã®åˆ†å­ã«ä¼ã‚ã‚‹ã“ã¨ã§ä¼æ’­ã™ã‚‹ã€‚çœŸç©ºä¸­ã«ã¯æŒ¯å‹•ã‚’ä¼ãˆã‚‹åª’è³ªãŒå­˜åœ¨ã—ãªã„ãŸã‚ã€éŸ³æ³¢ã¯ä¼ã‚ã‚‰ãªã„ã€‚</p>
                        <p style="margin-top: 10px;"><strong>ã€ãƒã‚¤ãƒ³ãƒˆã€‘</strong></p>
                        <p>éŸ³ã¯ç¸¦æ³¢ï¼ˆç–å¯†æ³¢ï¼‰ã§ã‚ã‚Šã€åª’è³ªã®å­˜åœ¨ãŒä¸å¯æ¬ ã§ã™ã€‚å…‰ï¼ˆé›»ç£æ³¢ï¼‰ã¯çœŸç©ºä¸­ã§ã‚‚ä¼ã‚ã‚Šã¾ã™ãŒã€éŸ³ã¯å¿…ãšåª’è³ªã‚’å¿…è¦ã¨ã—ã¾ã™ã€‚</p>
                    </div>
                </details>
            </div>
            
            <div class="problem">
                <h4>å•é¡Œ2</h4>
                <p>æ¸©åº¦ $t$ [â„ƒ]ã®ç©ºæ°—ä¸­ã‚’ä¼ã‚ã‚‹éŸ³ã®é€Ÿã• $V$ [m/s]ãŒ $V = 331.5 + 0.6t$ ã¨è¡¨ã•ã‚Œã‚‹ã¨ã™ã‚‹ã€‚25â„ƒã®ç©ºæ°—ä¸­ã‚’ä¼ã‚ã‚‹éŸ³ã®é€Ÿã•ã¯ä½• m/s ã‹ã€‚å°æ•°ç‚¹ä»¥ä¸‹ã‚’å››æ¨äº”å…¥ã—ã¦ç­”ãˆã‚ˆã€‚</p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <div class="answer">
                        <p><strong>ã€è§£ç­”ã€‘</strong> 347 m/s</p>
                        <p style="margin-top: 10px;"><strong>ã€è¨ˆç®—éç¨‹ã€‘</strong></p>
                        <p>
                            $V = 331.5 + 0.6 \times 25$<br>
                            $V = 331.5 + 15$<br>
                            $V = 346.5$ m/s<br>
                            å››æ¨äº”å…¥ã—ã¦ <strong>347 m/s</strong>
                        </p>
                    </div>
                </details>
            </div>
            
            <div class="problem">
                <h4>å•é¡Œ3</h4>
                <p>æ¬¡ã®(1)ã€œ(3)ã®å„å ´åˆã«ã€ç‚¹Pã§ç™ºã—ãŸéŸ³ãŒã€238 m é›¢ã‚ŒãŸç‚¹Oã«é”ã™ã‚‹ã¾ã§ã®æ™‚é–“ã‚’ã€ãã‚Œãã‚Œæœ‰åŠ¹æ•°å­—2æ¡ã§æ±‚ã‚ã‚ˆã€‚ãŸã ã—ã€éŸ³ã®é€Ÿã•ã‚’ 340 m/s ã¨ã™ã‚‹ã€‚</p>
                <p style="margin: 10px 0;">(1) é™æ­¢ã—ãŸéŸ³æºã‹ã‚‰ç™ºã—ãŸå ´åˆ</p>
                <p style="margin: 10px 0;">(2) éŸ³æºãŒ 10 m/s ã®é€Ÿã•ã§ç‚¹Oã«è¿‘ã¥ã„ã¦ã„ã‚‹å ´åˆ</p>
                <p style="margin: 10px 0;">(3) ç‚¹Pã‹ã‚‰ç‚¹Oã«å‘ã‘ã¦ã€é€Ÿã• 10 m/s ã®é¢¨ãŒå¹ã„ã¦ã„ã‚‹å ´åˆ</p>
                
                <details>
                    <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¦‹ã‚‹</summary>
                    <div class="answer">
                        <p><strong>ã€è§£ç­”ã€‘</strong></p>
                        <p>(1) <strong>0.70 s</strong></p>
                        <p>(2) <strong>0.70 s</strong></p>
                        <p>(3) <strong>0.68 s</strong></p>
                        
                        <p style="margin-top: 15px;"><strong>ã€è§£èª¬ã€‘</strong></p>
                        
                        <p><strong>(1) é™æ­¢ã—ãŸéŸ³æºã®å ´åˆ</strong></p>
                        <p>$t = \dfrac{238}{340} = 0.70$ s</p>
                        
                        <p style="margin-top: 10px;"><strong>(2) éŸ³æºãŒå‹•ã„ã¦ã„ã‚‹å ´åˆ</strong></p>
                        <p>éŸ³æºãŒå‹•ã„ã¦ã‚‚ã€éŸ³é€Ÿã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚éŸ³é€Ÿã¯åª’è³ªï¼ˆç©ºæ°—ï¼‰ã«ã‚ˆã£ã¦æ±ºã¾ã‚‹ãŸã‚ã€éŸ³æºã®é€Ÿåº¦ã¯é–¢ä¿‚ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                        <p>$t = \dfrac{238}{340} = 0.70$ s</p>
                        <p style="color: #667eea;">â€» éŸ³æºãŒå‹•ãã¨æ³¢é•·ï¼ˆãƒ‰ãƒƒãƒ—ãƒ©ãƒ¼åŠ¹æœï¼‰ã¯å¤‰ã‚ã‚Šã¾ã™ãŒã€éŸ³é€Ÿã¯å¤‰ã‚ã‚Šã¾ã›ã‚“ï¼</p>
                        
                        <p style="margin-top: 10px;"><strong>(3) é¢¨ãŒå¹ã„ã¦ã„ã‚‹å ´åˆ</strong></p>
                        <p>é¢¨ã«ã‚ˆã£ã¦ç©ºæ°—å…¨ä½“ãŒç§»å‹•ã™ã‚‹ãŸã‚ã€è¦‹ã‹ã‘ã®éŸ³é€ŸãŒå¤‰åŒ–ã—ã¾ã™ã€‚</p>
                        <p>$V' = 340 + 10 = 350$ m/s</p>
                        <p>$t = \dfrac{238}{350} = 0.68$ s</p>
                        <p style="color: #667eea;">â€» é¢¨ã¯åª’è³ªï¼ˆç©ºæ°—åˆ†å­å…¨ä½“ï¼‰ã‚’å‹•ã‹ã™ãŸã‚ã€éŸ³é€Ÿã«å½±éŸ¿ã—ã¾ã™ï¼</p>
                    </div>
                </details>
            </div>
        </div>
        
        <!-- ==================== ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ– ==================== -->
        <div id="simulation" class="tab-content">
            <h2>éŸ³æ³¢ä¼æ’­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            
            <div class="instructions">
                <p>ğŸ”Š <strong>æ“ä½œæ–¹æ³•</strong></p>
                <p>ãƒ»éŸ³æºï¼ˆğŸ”´èµ¤ï¼‰ã¨è¦³æ¸¬è€…ï¼ˆğŸ”µé’ï¼‰ã¯ãƒ‰ãƒ©ãƒƒã‚°ã§ç§»å‹•ã§ãã¾ã™</p>
                <p>ãƒ»æ¸©åº¦ã‚’å¤‰ãˆã‚‹ã¨éŸ³é€ŸãŒå¤‰åŒ–ã—ã€æ³¢ã®åºƒãŒã‚‹é€Ÿã•ãŒå¤‰ã‚ã‚Šã¾ã™</p>
                <p>ãƒ»ã€Œã‚¹ã‚¿ãƒ¼ãƒˆã€ã§éŸ³æ³¢ã‚’ç™ºç”Ÿã•ã›ã€è¦³æ¸¬è€…ã«å±Šãã¾ã§ã®æ™‚é–“ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†</p>
            </div>
            
            <div class="info-panel">
                <div class="info-item">
                    <div class="label">éŸ³é€Ÿ V</div>
                    <div class="value" id="infoSoundSpeed">340.0 m/s</div>
                </div>
                <div class="info-item">
                    <div class="label">è·é›¢ d</div>
                    <div class="value" id="infoDistance">0.0 m</div>
                </div>
                <div class="info-item">
                    <div class="label">åˆ°é”æ™‚é–“</div>
                    <div class="value" id="infoTime">0.00 s</div>
                </div>
                <div class="info-item">
                    <div class="label">çµŒéæ™‚é–“</div>
                    <div class="value" id="infoElapsed">0.00 s</div>
                </div>
            </div>
            
            <div id="sim-container">
                <canvas id="physicsCanvas"></canvas>
            </div>
            
            <div class="sim-controls">
                <div class="control-group">
                    <label>æ¸©åº¦ (t): <span class="value-display" id="simTempDisplay">15 â„ƒ</span></label>
                    <input type="range" id="simTempSlider" min="-20" max="40" value="15" step="1">
                </div>
                
                <div class="control-group">
                    <label>é¢¨é€Ÿ (å³å‘ãæ­£): <span class="value-display" id="simWindDisplay">0 m/s</span></label>
                    <input type="range" id="simWindSlider" min="-20" max="20" value="0" step="1">
                </div>
                
                <div class="button-group">
                    <button class="sim-button start" id="startBtn">ğŸ”Š ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                    <button class="sim-button reset" id="resetBtn">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
                </div>
            </div>
            
            <div class="graph-container">
                <h3>è·é›¢-æ™‚é–“ã‚°ãƒ©ãƒ•</h3>
                <canvas id="graphCanvas"></canvas>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #ff6b6b;"></div>
                        <span>æ³¢é¢ã®ä½ç½®</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4dabf7;"></div>
                        <span>è¦³æ¸¬è€…ã¾ã§ã®è·é›¢</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    // ========================================
    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
    // ========================================
    function openTab(tabName) {
        const contents = document.getElementsByClassName("tab-content");
        for (let i = 0; i < contents.length; i++) {
            contents[i].style.display = "none";
            contents[i].classList.remove("active");
        }
        const buttons = document.getElementsByClassName("tab-btn");
        for (let i = 0; i < buttons.length; i++) {
            buttons[i].classList.remove("active");
        }
        document.getElementById(tabName).style.display = "block";
        document.getElementById(tabName).classList.add("active");
        if (event && event.currentTarget) {
            event.currentTarget.classList.add("active");
        }
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ–ã‚’é–‹ã„ãŸæ™‚ã«ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ãƒªã‚µã‚¤ã‚º
        if (tabName === 'simulation') {
            resizeSimCanvas();
            drawSimulation();
            resizeGraphCanvas();
            drawGraph();
        }
    }

    // ========================================
    // æ¸©åº¦ã¨åˆ†å­é‹å‹•ã®å‹•çš„ãƒ„ãƒ¼ãƒ«
    // ========================================
    const tempCanvas = document.getElementById('tempMoleculeCanvas');
    const tempCtx = tempCanvas.getContext('2d');
    const tempSlider = document.getElementById('tempSlider');
    const tempValueDisplay = document.getElementById('tempValue');
    const tempSoundSpeedDisplay = document.getElementById('tempSoundSpeed');
    
    let tempMolecules = [];
    const TEMP_MOLECULE_COUNT = 80;
    
    function initTempMolecules() {
        tempCanvas.width = tempCanvas.parentElement.clientWidth - 40;
        tempMolecules = [];
        for (let i = 0; i < TEMP_MOLECULE_COUNT; i++) {
            tempMolecules.push({
                x: Math.random() * tempCanvas.width,
                y: Math.random() * tempCanvas.height,
                vx: (Math.random() - 0.5) * 2,
                vy: (Math.random() - 0.5) * 2,
                radius: 4 + Math.random() * 2
            });
        }
    }
    
    function updateTempMolecules() {
        const temp = parseFloat(tempSlider.value);
        const speedFactor = 0.5 + (temp + 20) / 40 * 2; // -20â„ƒã§0.5ã€40â„ƒã§2.5
        
        tempMolecules.forEach(m => {
            // ãƒ©ãƒ³ãƒ€ãƒ ãªåŠ é€Ÿåº¦ã‚’åŠ ãˆã‚‹ï¼ˆç†±é‹å‹•ï¼‰
            m.vx += (Math.random() - 0.5) * 0.5 * speedFactor;
            m.vy += (Math.random() - 0.5) * 0.5 * speedFactor;
            
            // é€Ÿåº¦åˆ¶é™
            const maxSpeed = speedFactor * 3;
            const speed = Math.sqrt(m.vx * m.vx + m.vy * m.vy);
            if (speed > maxSpeed) {
                m.vx = (m.vx / speed) * maxSpeed;
                m.vy = (m.vy / speed) * maxSpeed;
            }
            
            m.x += m.vx;
            m.y += m.vy;
            
            // å£ã§ã®åå°„
            if (m.x < m.radius || m.x > tempCanvas.width - m.radius) {
                m.vx *= -0.9;
                m.x = Math.max(m.radius, Math.min(tempCanvas.width - m.radius, m.x));
            }
            if (m.y < m.radius || m.y > tempCanvas.height - m.radius) {
                m.vy *= -0.9;
                m.y = Math.max(m.radius, Math.min(tempCanvas.height - m.radius, m.y));
            }
        });
    }
    
    function drawTempMolecules() {
        const temp = parseFloat(tempSlider.value);
        
        // èƒŒæ™¯ï¼ˆæ¸©åº¦ã«å¿œã˜ã¦è‰²ã‚’å¤‰ãˆã‚‹ï¼‰
        const bgHue = 240 - (temp + 20) / 60 * 40; // é’â†’ç´«
        tempCtx.fillStyle = `hsl(${bgHue}, 30%, 15%)`;
        tempCtx.fillRect(0, 0, tempCanvas.width, tempCanvas.height);
        
        // æ¸©åº¦ãƒ©ãƒ™ãƒ«
        tempCtx.fillStyle = 'rgba(255,255,255,0.3)';
        tempCtx.font = '14px sans-serif';
        tempCtx.fillText(`æ¸©åº¦: ${temp}â„ƒ`, 10, 25);
        
        // åˆ†å­ã®æç”»
        const speedFactor = 0.5 + (temp + 20) / 40 * 2;
        tempMolecules.forEach(m => {
            const speed = Math.sqrt(m.vx * m.vx + m.vy * m.vy);
            // é€Ÿåº¦ã«å¿œã˜ã¦è‰²ã‚’å¤‰ãˆã‚‹ï¼ˆé…ã„=é’ã€é€Ÿã„=èµ¤ï¼‰
            const hue = 240 - (speed / (speedFactor * 3)) * 180;
            
            tempCtx.beginPath();
            tempCtx.arc(m.x, m.y, m.radius, 0, Math.PI * 2);
            tempCtx.fillStyle = `hsl(${hue}, 70%, 60%)`;
            tempCtx.fill();
            
            // ã‚°ãƒ­ãƒ¼åŠ¹æœ
            tempCtx.beginPath();
            tempCtx.arc(m.x, m.y, m.radius + 3, 0, Math.PI * 2);
            tempCtx.fillStyle = `hsla(${hue}, 70%, 60%, 0.2)`;
            tempCtx.fill();
        });
        
        // éŸ³é€Ÿã®èª¬æ˜
        const soundSpeed = 331.5 + 0.6 * temp;
        tempCtx.fillStyle = 'rgba(255,255,255,0.8)';
        tempCtx.font = 'bold 16px sans-serif';
        tempCtx.textAlign = 'center';
        tempCtx.fillText(`é«˜æ¸© â†’ åˆ†å­ã®å‹•ããŒæ¿€ã—ã„ â†’ æŒ¯å‹•ãŒé€Ÿãä¼ã‚ã‚‹ â†’ éŸ³é€ŸãŒé€Ÿã„`, tempCanvas.width / 2, tempCanvas.height - 15);
        tempCtx.textAlign = 'left';
    }
    
    tempSlider.addEventListener('input', () => {
        const temp = parseFloat(tempSlider.value);
        tempValueDisplay.textContent = `${temp} â„ƒ`;
        const soundSpeed = (331.5 + 0.6 * temp).toFixed(1);
        tempSoundSpeedDisplay.textContent = `${soundSpeed} m/s`;
    });
    
    // ========================================
    // é¢¨ã¨ç©ºæ°—åˆ†å­ã®å‹•çš„ãƒ„ãƒ¼ãƒ«
    // ========================================
    const windCanvas = document.getElementById('windMoleculeCanvas');
    const windCtx = windCanvas.getContext('2d');
    const windSlider = document.getElementById('windSlider');
    const windValueDisplay = document.getElementById('windValue');
    const windSoundSpeedDisplay = document.getElementById('windSoundSpeed');
    
    let windMolecules = [];
    let soundWaves = [];
    const WIND_MOLECULE_COUNT = 60;
    const BASE_SOUND_SPEED = 340;
    
    function initWindMolecules() {
        windCanvas.width = windCanvas.parentElement.clientWidth - 40;
        windMolecules = [];
        for (let i = 0; i < WIND_MOLECULE_COUNT; i++) {
            windMolecules.push({
                x: Math.random() * windCanvas.width,
                y: 50 + Math.random() * (windCanvas.height - 100),
                vx: (Math.random() - 0.5) * 2,
                vy: (Math.random() - 0.5) * 2,
                radius: 3 + Math.random() * 2
            });
        }
        // éŸ³æ³¢ã®åˆæœŸåŒ–
        soundWaves = [];
        for (let i = 0; i < 3; i++) {
            soundWaves.push({
                x: 60,
                radius: 20 + i * 50
            });
        }
    }
    
    function updateWindMolecules() {
        const wind = parseFloat(windSlider.value);
        const windForce = wind * 0.15;
        
        windMolecules.forEach(m => {
            // é¢¨ã®åŠ›ã‚’åŠ ãˆã‚‹
            m.vx += windForce * 0.1;
            // ãƒ©ãƒ³ãƒ€ãƒ ãªç†±é‹å‹•
            m.vx += (Math.random() - 0.5) * 0.3;
            m.vy += (Math.random() - 0.5) * 0.3;
            
            // é€Ÿåº¦åˆ¶é™
            const maxSpeed = 4;
            m.vx = Math.max(-maxSpeed, Math.min(maxSpeed, m.vx));
            m.vy = Math.max(-maxSpeed, Math.min(maxSpeed, m.vy));
            
            m.x += m.vx;
            m.y += m.vy;
            
            // ç”»é¢ç«¯ã§ã®å‡¦ç†ï¼ˆãƒ«ãƒ¼ãƒ—ï¼‰
            if (m.x < -10) m.x = windCanvas.width + 10;
            if (m.x > windCanvas.width + 10) m.x = -10;
            if (m.y < 50) { m.y = 50; m.vy *= -0.9; }
            if (m.y > windCanvas.height - 50) { m.y = windCanvas.height - 50; m.vy *= -0.9; }
        });
        
        // éŸ³æ³¢ã®æ›´æ–°
        const waveSpeed = (BASE_SOUND_SPEED + wind) / 100; // ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
        soundWaves.forEach(w => {
            w.radius += waveSpeed;
            w.x += windForce * 0.5; // é¢¨ã§éŸ³æ³¢ã‚‚æµã•ã‚Œã‚‹
            if (w.radius > 200) {
                w.radius = 0;
                w.x = 60;
            }
        });
    }
    
    function drawWindMolecules() {
        const wind = parseFloat(windSlider.value);
        
        // èƒŒæ™¯
        windCtx.fillStyle = '#1a1a2e';
        windCtx.fillRect(0, 0, windCanvas.width, windCanvas.height);
        
        // é¢¨å‘ãçŸ¢å°ã®èƒŒæ™¯
        windCtx.fillStyle = 'rgba(255,255,255,0.1)';
        windCtx.fillRect(0, 0, windCanvas.width, 40);
        
        // é¢¨å‘ãè¡¨ç¤º
        windCtx.fillStyle = '#fff';
        windCtx.font = '14px sans-serif';
        windCtx.fillText('é¢¨ã®æ–¹å‘:', 10, 25);
        
        // é¢¨å‘ãçŸ¢å°
        if (wind !== 0) {
            const arrowCount = Math.abs(wind) / 3;
            for (let i = 0; i < arrowCount; i++) {
                const x = 100 + i * 40;
                windCtx.beginPath();
                windCtx.strokeStyle = wind > 0 ? '#4dabf7' : '#ff6b6b';
                windCtx.lineWidth = 2;
                if (wind > 0) {
                    windCtx.moveTo(x, 20);
                    windCtx.lineTo(x + 20, 20);
                    windCtx.lineTo(x + 15, 15);
                    windCtx.moveTo(x + 20, 20);
                    windCtx.lineTo(x + 15, 25);
                } else {
                    windCtx.moveTo(x + 20, 20);
                    windCtx.lineTo(x, 20);
                    windCtx.lineTo(x + 5, 15);
                    windCtx.moveTo(x, 20);
                    windCtx.lineTo(x + 5, 25);
                }
                windCtx.stroke();
            }
        } else {
            windCtx.fillStyle = '#888';
            windCtx.fillText('ç„¡é¢¨', 100, 25);
        }
        
        // éŸ³æº
        windCtx.beginPath();
        windCtx.arc(60, windCanvas.height / 2, 15, 0, Math.PI * 2);
        windCtx.fillStyle = '#ff6b6b';
        windCtx.fill();
        windCtx.fillStyle = '#fff';
        windCtx.font = '12px sans-serif';
        windCtx.textAlign = 'center';
        windCtx.fillText('éŸ³æº', 60, windCanvas.height / 2 + 35);
        
        // éŸ³æ³¢ã®æç”»
        soundWaves.forEach(w => {
            if (w.radius > 0) {
                windCtx.beginPath();
                windCtx.arc(w.x, windCanvas.height / 2, w.radius, 0, Math.PI * 2);
                windCtx.strokeStyle = `rgba(255, 107, 107, ${1 - w.radius / 200})`;
                windCtx.lineWidth = 3;
                windCtx.stroke();
            }
        });
        
        // åˆ†å­ã®æç”»
        windMolecules.forEach(m => {
            windCtx.beginPath();
            windCtx.arc(m.x, m.y, m.radius, 0, Math.PI * 2);
            windCtx.fillStyle = `rgba(100, 180, 255, 0.7)`;
            windCtx.fill();
        });
        
        // èª¬æ˜ãƒ†ã‚­ã‚¹ãƒˆ
        windCtx.fillStyle = 'rgba(255,255,255,0.8)';
        windCtx.font = 'bold 14px sans-serif';
        windCtx.textAlign = 'center';
        if (wind > 0) {
            windCtx.fillText('â†’ é¢¨ã«ã‚ˆã£ã¦ç©ºæ°—åˆ†å­å…¨ä½“ãŒå³ã«æµã•ã‚Œã‚‹ â†’ éŸ³æ³¢ã‚‚å³ã«é€Ÿãé€²ã‚€', windCanvas.width / 2, windCanvas.height - 15);
        } else if (wind < 0) {
            windCtx.fillText('â† é¢¨ã«ã‚ˆã£ã¦ç©ºæ°—åˆ†å­å…¨ä½“ãŒå·¦ã«æµã•ã‚Œã‚‹ â†’ å³ã¸ã®éŸ³é€ŸãŒé…ããªã‚‹', windCanvas.width / 2, windCanvas.height - 15);
        } else {
            windCtx.fillText('ç„¡é¢¨ â†’ ç©ºæ°—åˆ†å­ã¯ç†±é‹å‹•ã®ã¿ â†’ éŸ³é€Ÿã¯ V = 340 m/s', windCanvas.width / 2, windCanvas.height - 15);
        }
        windCtx.textAlign = 'left';
    }
    
    windSlider.addEventListener('input', () => {
        const wind = parseFloat(windSlider.value);
        windValueDisplay.textContent = `${wind} m/s`;
        const soundSpeed = BASE_SOUND_SPEED + wind;
        windSoundSpeedDisplay.textContent = `${soundSpeed} m/s`;
    });
    
    // ========================================
    // ãƒ¡ã‚¤ãƒ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    // ========================================
    const simCanvas = document.getElementById('physicsCanvas');
    const simCtx = simCanvas.getContext('2d');
    const graphCanvas = document.getElementById('graphCanvas');
    const graphCtx = graphCanvas.getContext('2d');
    
    // çŠ¶æ…‹å¤‰æ•°
    let simRunning = false;
    let simTime = 0;
    let waves = [];
    let hasReached = false;
    let reachTime = 0;
    let graphData = [];
    
    // ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    let temperature = 15;
    let windSpeed = 0;
    let soundSpeed = 340;
    const SCALE = 2; // 1ãƒ”ã‚¯ã‚»ãƒ« = 2ãƒ¡ãƒ¼ãƒˆãƒ«
    
    // éŸ³æºã¨è¦³æ¸¬è€…ã®ä½ç½®ï¼ˆãƒ”ã‚¯ã‚»ãƒ«åº§æ¨™ï¼‰
    let source = { x: 150, y: 200 };
    let observer = { x: 450, y: 200 };
    let dragging = null;
    
    // DOMè¦ç´ 
    const simTempSlider = document.getElementById('simTempSlider');
    const simTempDisplay = document.getElementById('simTempDisplay');
    const simWindSlider = document.getElementById('simWindSlider');
    const simWindDisplay = document.getElementById('simWindDisplay');
    const startBtn = document.getElementById('startBtn');
    const resetBtn = document.getElementById('resetBtn');
    
    function resizeSimCanvas() {
        simCanvas.width = simCanvas.parentElement.clientWidth - 40;
        simCanvas.height = 400;
    }
    
    function resizeGraphCanvas() {
        graphCanvas.width = graphCanvas.parentElement.clientWidth - 30;
        graphCanvas.height = 250;
    }
    
    function calculateDistance() {
        const dx = observer.x - source.x;
        const dy = observer.y - source.y;
        return Math.sqrt(dx * dx + dy * dy) * SCALE;
    }
    
    function updateSoundSpeed() {
        temperature = parseFloat(simTempSlider.value);
        windSpeed = parseFloat(simWindSlider.value);
        soundSpeed = 331.5 + 0.6 * temperature + windSpeed;
        
        simTempDisplay.textContent = `${temperature} â„ƒ`;
        simWindDisplay.textContent = `${windSpeed} m/s`;
        
        updateInfoPanel();
    }
    
    function updateInfoPanel() {
        const distance = calculateDistance();
        const baseSpeed = 331.5 + 0.6 * temperature;
        const effectiveSpeed = baseSpeed + windSpeed;
        const expectedTime = distance / effectiveSpeed;
        
        document.getElementById('infoSoundSpeed').textContent = `${effectiveSpeed.toFixed(1)} m/s`;
        document.getElementById('infoDistance').textContent = `${distance.toFixed(1)} m`;
        document.getElementById('infoTime').textContent = `${expectedTime.toFixed(3)} s`;
        document.getElementById('infoElapsed').textContent = `${simTime.toFixed(3)} s`;
    }
    
    function drawSimulation() {
        // èƒŒæ™¯
        simCtx.fillStyle = '#1a1a2e';
        simCtx.fillRect(0, 0, simCanvas.width, simCanvas.height);
        
        // ã‚°ãƒªãƒƒãƒ‰
        simCtx.strokeStyle = 'rgba(255,255,255,0.1)';
        simCtx.lineWidth = 1;
        for (let x = 0; x < simCanvas.width; x += 50) {
            simCtx.beginPath();
            simCtx.moveTo(x, 0);
            simCtx.lineTo(x, simCanvas.height);
            simCtx.stroke();
        }
        for (let y = 0; y < simCanvas.height; y += 50) {
            simCtx.beginPath();
            simCtx.moveTo(0, y);
            simCtx.lineTo(simCanvas.width, y);
            simCtx.stroke();
        }
        
        // ã‚¹ã‚±ãƒ¼ãƒ«è¡¨ç¤º
        simCtx.fillStyle = 'rgba(255,255,255,0.5)';
        simCtx.font = '12px sans-serif';
        simCtx.fillText(`ã‚¹ã‚±ãƒ¼ãƒ«: 50px = ${50 * SCALE}m`, 10, simCanvas.height - 10);
        
        // é¢¨å‘ãè¡¨ç¤º
        if (windSpeed !== 0) {
            simCtx.fillStyle = 'rgba(255,255,255,0.3)';
            simCtx.font = '14px sans-serif';
            const windText = windSpeed > 0 ? `é¢¨ â†’ ${windSpeed} m/s` : `â† é¢¨ ${Math.abs(windSpeed)} m/s`;
            simCtx.fillText(windText, simCanvas.width - 120, 25);
        }
        
        // éŸ³æ³¢ã®æç”»
        waves.forEach(wave => {
            // é¢¨ã®å½±éŸ¿ã‚’è€ƒæ…®ã—ãŸæ³¢ã®ä¸­å¿ƒä½ç½®
            const waveX = source.x + wave.drift;
            
            simCtx.beginPath();
            simCtx.arc(waveX, source.y, wave.radius, 0, Math.PI * 2);
            const alpha = Math.max(0, 1 - wave.radius / 400);
            simCtx.strokeStyle = `rgba(255, 107, 107, ${alpha})`;
            simCtx.lineWidth = 3;
            simCtx.stroke();
        });
        
        // éŸ³æºã‹ã‚‰è¦³æ¸¬è€…ã¸ã®ç·š
        simCtx.beginPath();
        simCtx.setLineDash([5, 5]);
        simCtx.moveTo(source.x, source.y);
        simCtx.lineTo(observer.x, observer.y);
        simCtx.strokeStyle = 'rgba(255,255,255,0.3)';
        simCtx.lineWidth = 1;
        simCtx.stroke();
        simCtx.setLineDash([]);
        
        // éŸ³æº
        simCtx.beginPath();
        simCtx.arc(source.x, source.y, 20, 0, Math.PI * 2);
        simCtx.fillStyle = '#ff6b6b';
        simCtx.fill();
        simCtx.fillStyle = '#fff';
        simCtx.font = 'bold 14px sans-serif';
        simCtx.textAlign = 'center';
        simCtx.fillText('ğŸ”Š', source.x, source.y + 5);
        simCtx.fillStyle = '#ff6b6b';
        simCtx.fillText('éŸ³æº', source.x, source.y + 40);
        
        // è¦³æ¸¬è€…
        simCtx.beginPath();
        simCtx.arc(observer.x, observer.y, 20, 0, Math.PI * 2);
        simCtx.fillStyle = hasReached ? '#51cf66' : '#4dabf7';
        simCtx.fill();
        simCtx.fillStyle = '#fff';
        simCtx.fillText('ğŸ‘‚', observer.x, observer.y + 5);
        simCtx.fillStyle = hasReached ? '#51cf66' : '#4dabf7';
        simCtx.fillText('è¦³æ¸¬è€…', observer.x, observer.y + 40);
        
        // åˆ°é”ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        if (hasReached) {
            simCtx.fillStyle = '#51cf66';
            simCtx.font = 'bold 24px sans-serif';
            simCtx.fillText(`ğŸµ éŸ³ãŒåˆ°é”ï¼ (${reachTime.toFixed(3)} s)`, simCanvas.width / 2, 40);
        }
        
        simCtx.textAlign = 'left';
    }
    
    function drawGraph() {
        // èƒŒæ™¯
        graphCtx.fillStyle = '#fff';
        graphCtx.fillRect(0, 0, graphCanvas.width, graphCanvas.height);
        
        const padding = { left: 60, right: 30, top: 30, bottom: 40 };
        const graphWidth = graphCanvas.width - padding.left - padding.right;
        const graphHeight = graphCanvas.height - padding.top - padding.bottom;
        
        // è»¸
        graphCtx.strokeStyle = '#333';
        graphCtx.lineWidth = 2;
        graphCtx.beginPath();
        graphCtx.moveTo(padding.left, padding.top);
        graphCtx.lineTo(padding.left, graphCanvas.height - padding.bottom);
        graphCtx.lineTo(graphCanvas.width - padding.right, graphCanvas.height - padding.bottom);
        graphCtx.stroke();
        
        // è»¸ãƒ©ãƒ™ãƒ«
        graphCtx.fillStyle = '#333';
        graphCtx.font = '14px sans-serif';
        graphCtx.textAlign = 'center';
        graphCtx.fillText('æ™‚é–“ [s]', graphCanvas.width / 2, graphCanvas.height - 5);
        graphCtx.save();
        graphCtx.translate(15, graphCanvas.height / 2);
        graphCtx.rotate(-Math.PI / 2);
        graphCtx.fillText('è·é›¢ [m]', 0, 0);
        graphCtx.restore();
        
        // æœ€å¤§å€¤ã®è¨­å®š
        const distance = calculateDistance();
        const maxTime = Math.max(2, simTime * 1.2, distance / soundSpeed * 1.5);
        const maxDist = Math.max(distance * 1.2, 200);
        
        // ã‚°ãƒªãƒƒãƒ‰
        graphCtx.strokeStyle = '#eee';
        graphCtx.lineWidth = 1;
        for (let i = 1; i <= 5; i++) {
            const y = padding.top + (graphHeight / 5) * i;
            graphCtx.beginPath();
            graphCtx.moveTo(padding.left, y);
            graphCtx.lineTo(graphCanvas.width - padding.right, y);
            graphCtx.stroke();
            
            const distLabel = (maxDist * (5 - i) / 5).toFixed(0);
            graphCtx.fillStyle = '#666';
            graphCtx.font = '12px sans-serif';
            graphCtx.textAlign = 'right';
            graphCtx.fillText(distLabel, padding.left - 5, y + 4);
        }
        
        for (let i = 1; i <= 5; i++) {
            const x = padding.left + (graphWidth / 5) * i;
            graphCtx.beginPath();
            graphCtx.moveTo(x, padding.top);
            graphCtx.lineTo(x, graphCanvas.height - padding.bottom);
            graphCtx.stroke();
            
            const timeLabel = (maxTime * i / 5).toFixed(2);
            graphCtx.fillStyle = '#666';
            graphCtx.font = '12px sans-serif';
            graphCtx.textAlign = 'center';
            graphCtx.fillText(timeLabel, x, graphCanvas.height - padding.bottom + 20);
        }
        
        // è¦³æ¸¬è€…ã¾ã§ã®è·é›¢ï¼ˆæ°´å¹³ç·šï¼‰
        const distY = padding.top + graphHeight * (1 - distance / maxDist);
        graphCtx.setLineDash([5, 5]);
        graphCtx.strokeStyle = '#4dabf7';
        graphCtx.lineWidth = 2;
        graphCtx.beginPath();
        graphCtx.moveTo(padding.left, distY);
        graphCtx.lineTo(graphCanvas.width - padding.right, distY);
        graphCtx.stroke();
        graphCtx.setLineDash([]);
        
        // æ³¢é¢ã®ä½ç½®ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
        if (graphData.length > 1) {
            graphCtx.strokeStyle = '#ff6b6b';
            graphCtx.lineWidth = 3;
            graphCtx.beginPath();
            graphData.forEach((point, i) => {
                const x = padding.left + (point.time / maxTime) * graphWidth;
                const y = padding.top + graphHeight * (1 - point.waveRadius / maxDist);
                if (i === 0) {
                    graphCtx.moveTo(x, y);
                } else {
                    graphCtx.lineTo(x, y);
                }
            });
            graphCtx.stroke();
        }
        
        // åˆ°é”ç‚¹
        if (hasReached) {
            const reachX = padding.left + (reachTime / maxTime) * graphWidth;
            graphCtx.beginPath();
            graphCtx.arc(reachX, distY, 8, 0, Math.PI * 2);
            graphCtx.fillStyle = '#51cf66';
            graphCtx.fill();
            graphCtx.strokeStyle = '#fff';
            graphCtx.lineWidth = 2;
            graphCtx.stroke();
        }
    }
    
    function updateSimulation() {
        if (!simRunning) return;
        
        const dt = 0.016; // ç´„60fps
        simTime += dt;
        
        // æ³¢ã®æ›´æ–°
        const pixelSpeed = soundSpeed / SCALE; // m/s â†’ px/s
        const windDrift = windSpeed / SCALE * simTime; // é¢¨ã«ã‚ˆã‚‹æ³¢ã®ä¸­å¿ƒã®ãƒ‰ãƒªãƒ•ãƒˆ
        
        waves.forEach(wave => {
            wave.radius += pixelSpeed * dt;
            wave.drift = windDrift;
        });
        
        // è¦³æ¸¬è€…ã¸ã®åˆ°é”åˆ¤å®š
        if (!hasReached && waves.length > 0) {
            const firstWave = waves[0];
            const waveX = source.x + firstWave.drift;
            const dx = observer.x - waveX;
            const dy = observer.y - source.y;
            const distToObserver = Math.sqrt(dx * dx + dy * dy);
            
            if (firstWave.radius >= distToObserver) {
                hasReached = true;
                reachTime = simTime;
            }
            
            // ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²
            graphData.push({
                time: simTime,
                waveRadius: firstWave.radius * SCALE
            });
        }
        
        // å¤ã„æ³¢ã‚’å‰Šé™¤
        waves = waves.filter(w => w.radius < 600);
        
        updateInfoPanel();
        drawSimulation();
        drawGraph();
        
        if (simRunning) {
            requestAnimationFrame(updateSimulation);
        }
    }
    
    function startSimulation() {
        if (simRunning) return;
        
        simRunning = true;
        waves = [{ radius: 0, drift: 0 }];
        
        // å®šæœŸçš„ã«æ–°ã—ã„æ³¢ã‚’ç”Ÿæˆ
        const waveInterval = setInterval(() => {
            if (simRunning && waves.length < 5) {
                waves.push({ radius: 0, drift: 0 });
            }
            if (!simRunning) {
                clearInterval(waveInterval);
            }
        }, 300);
        
        startBtn.textContent = 'â¸ å®Ÿè¡Œä¸­...';
        startBtn.disabled = true;
        updateSimulation();
    }
    
    function resetSimulation() {
        simRunning = false;
        simTime = 0;
        waves = [];
        hasReached = false;
        reachTime = 0;
        graphData = [];
        
        startBtn.textContent = 'ğŸ”Š ã‚¹ã‚¿ãƒ¼ãƒˆ';
        startBtn.disabled = false;
        
        updateInfoPanel();
        drawSimulation();
        drawGraph();
    }
    
    // ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œ
    simCanvas.addEventListener('mousedown', (e) => {
        const rect = simCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        
        // éŸ³æºã¨ã®è·é›¢
        const dxSource = x - source.x;
        const dySource = y - source.y;
        if (Math.sqrt(dxSource * dxSource + dySource * dySource) < 25) {
            dragging = 'source';
            return;
        }
        
        // è¦³æ¸¬è€…ã¨ã®è·é›¢
        const dxObserver = x - observer.x;
        const dyObserver = y - observer.y;
        if (Math.sqrt(dxObserver * dxObserver + dyObserver * dyObserver) < 25) {
            dragging = 'observer';
            return;
        }
    });
    
    simCanvas.addEventListener('mousemove', (e) => {
        if (!dragging) return;
        
        const rect = simCanvas.getBoundingClientRect();
        const x = Math.max(30, Math.min(simCanvas.width - 30, e.clientX - rect.left));
        const y = Math.max(30, Math.min(simCanvas.height - 50, e.clientY - rect.top));
        
        if (dragging === 'source') {
            source.x = x;
            source.y = y;
        } else if (dragging === 'observer') {
            observer.x = x;
            observer.y = y;
        }
        
        updateInfoPanel();
        drawSimulation();
        drawGraph();
    });
    
    simCanvas.addEventListener('mouseup', () => {
        dragging = null;
    });
    
    simCanvas.addEventListener('mouseleave', () => {
        dragging = null;
    });
    
    // ã‚¿ãƒƒãƒå¯¾å¿œ
    simCanvas.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const rect = simCanvas.getBoundingClientRect();
        const touch = e.touches[0];
        const x = touch.clientX - rect.left;
        const y = touch.clientY - rect.top;
        
        const dxSource = x - source.x;
        const dySource = y - source.y;
        if (Math.sqrt(dxSource * dxSource + dySource * dySource) < 35) {
            dragging = 'source';
            return;
        }
        
        const dxObserver = x - observer.x;
        const dyObserver = y - observer.y;
        if (Math.sqrt(dxObserver * dxObserver + dyObserver * dyObserver) < 35) {
            dragging = 'observer';
            return;
        }
    });
    
    simCanvas.addEventListener('touchmove', (e) => {
        if (!dragging) return;
        e.preventDefault();
        
        const rect = simCanvas.getBoundingClientRect();
        const touch = e.touches[0];
        const x = Math.max(30, Math.min(simCanvas.width - 30, touch.clientX - rect.left));
        const y = Math.max(30, Math.min(simCanvas.height - 50, touch.clientY - rect.top));
        
        if (dragging === 'source') {
            source.x = x;
            source.y = y;
        } else if (dragging === 'observer') {
            observer.x = x;
            observer.y = y;
        }
        
        updateInfoPanel();
        drawSimulation();
        drawGraph();
    });
    
    simCanvas.addEventListener('touchend', () => {
        dragging = null;
    });
    
    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    simTempSlider.addEventListener('input', updateSoundSpeed);
    simWindSlider.addEventListener('input', updateSoundSpeed);
    startBtn.addEventListener('click', startSimulation);
    resetBtn.addEventListener('click', resetSimulation);
    
    // ========================================
    // è§£èª¬ã‚¿ãƒ–ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ—
    // ========================================
    function animateLectureTools() {
        updateTempMolecules();
        drawTempMolecules();
        updateWindMolecules();
        drawWindMolecules();
        requestAnimationFrame(animateLectureTools);
    }
    
    // ========================================
    // åˆæœŸåŒ–
    // ========================================
    function init() {
        // è§£èª¬ã‚¿ãƒ–ã®ãƒ„ãƒ¼ãƒ«åˆæœŸåŒ–
        initTempMolecules();
        initWindMolecules();
        animateLectureTools();
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
        resizeSimCanvas();
        resizeGraphCanvas();
        updateSoundSpeed();
        drawSimulation();
        drawGraph();
    }
    
    // ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
    window.addEventListener('resize', () => {
        // è§£èª¬ã‚¿ãƒ–ã®ã‚­ãƒ£ãƒ³ãƒã‚¹
        tempCanvas.width = tempCanvas.parentElement.clientWidth - 40;
        windCanvas.width = windCanvas.parentElement.clientWidth - 40;
        initTempMolecules();
        initWindMolecules();
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚­ãƒ£ãƒ³ãƒã‚¹
        resizeSimCanvas();
        resizeGraphCanvas();
        drawSimulation();
        drawGraph();
    });
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†æ™‚ã«åˆæœŸåŒ–
    window.addEventListener('load', init);
    </script>
</body>
</html>