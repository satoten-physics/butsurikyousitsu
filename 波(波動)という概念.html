<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜æ ¡ç‰©ç† - æ³¢(æ³¢å‹•)ã¨ã„ã†æ¦‚å¿µ</title>
    <script>
      window.MathJax = {
      tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']]
     }
     };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .back-link {
            color: #667eea;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }
        h1 {
            color: #333;
        }
        .container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .tab-btn {
            flex: 1;
            min-width: 150px;
            padding: 12px 20px;
            border: none;
            background: #f0f0f0;
            cursor: pointer;
            border-radius: 5px;
            font-size: 16px;
            transition: all 0.3s;
        }
        .tab-btn.active {
            background: #667eea;
            color: white;
        }
        .tab-btn:hover {
            background: #8899f0;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        h3 {
            color: #555;
            margin: 25px 0 15px 0;
            padding-bottom: 5px;
            border-bottom: 2px solid #667eea;
        }
        h4 {
            color: #667eea;
            margin: 20px 0 10px 0;
        }
        p {
            line-height: 1.8;
            margin-bottom: 15px;
            color: #333;
        }
        .pdf-placeholder {
            background: #f9f9f9;
            padding: 40px;
            text-align: center;
            border-radius: 5px;
            color: #666;
        }
        
        /* è§£èª¬ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        .concept-box {
            background: #f0f4ff;
            border-left: 4px solid #667eea;
            padding: 15px 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .concept-box.important {
            background: #fff3e0;
            border-left-color: #ff9800;
        }
        .concept-box.formula {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }
        .concept-box h4 {
            margin-top: 0;
            color: #333;
        }
        .term-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .term-table th, .term-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        .term-table th {
            background: #667eea;
            color: white;
        }
        .term-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        .comparison-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .comparison-box {
            flex: 1;
            min-width: 280px;
            padding: 20px;
            border-radius: 10px;
            background: #f9f9f9;
        }
        .comparison-box.transverse {
            border: 3px solid #E91E63;
        }
        .comparison-box.longitudinal {
            border: 3px solid #4CAF50;
        }
        .comparison-box h4 {
            margin-top: 0;
        }
        .comparison-box.transverse h4 {
            color: #E91E63;
        }
        .comparison-box.longitudinal h4 {
            color: #4CAF50;
        }
        
        /* å‹•çš„ãƒ„ãƒ¼ãƒ«ç”¨ã‚­ãƒ£ãƒ³ãƒã‚¹ */
        .dynamic-tool {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        .dynamic-tool canvas {
            display: block;
            background: white;
            border-radius: 5px;
            border: 2px solid #ddd;
        }
        .dynamic-tool p {
            text-align: center;
            color: #666;
            margin-top: 10px;
            font-size: 14px;
        }
        
        /* é™çš„å›³è§£ç”¨ */
        .static-diagram {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }
        .static-diagram canvas {
            display: block;
        }
        
        /* ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
        #sim-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        #physicsCanvas {
            display: block;
            background: white;
            border-radius: 5px;
            border: 2px solid #ddd;
        }
        .sim-controls {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
        }
        .control-group {
            margin-bottom: 20px;
        }
        .control-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }
        .control-group input[type="range"] {
            width: 100%;
            margin: 10px 0;
        }
        .value-display {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            min-width: 100px;
            text-align: center;
        }
        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .sim-button {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .sim-button.start {
            background: #4CAF50;
            color: white;
        }
        .sim-button.start:hover {
            background: #45a049;
        }
        .sim-button.stop {
            background: #ff9800;
            color: white;
        }
        .sim-button.stop:hover {
            background: #e68a00;
        }
        .sim-button.reset {
            background: #f44336;
            color: white;
        }
        .sim-button.reset:hover {
            background: #da190b;
        }
        .graph-container {
            margin-top: 20px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ddd;
        }
        .graph-container h3 {
            color: #667eea;
            margin-bottom: 10px;
            border-bottom: none;
            margin-top: 0;
        }
        #graphCanvas {
            display: block;
            border: 1px solid #eee;
        }
        
        /* ã‚µãƒ–ã‚¿ãƒ– */
        .sub-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            background: #f0f0f0;
            padding: 5px;
            border-radius: 8px;
        }
        .sub-tab-btn {
            flex: 1;
            padding: 10px 15px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 5px;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            color: #666;
        }
        .sub-tab-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .sub-tab-btn:hover:not(.active) {
            background: rgba(255,255,255,0.5);
        }
        .sub-tab-content {
            display: none;
        }
        .sub-tab-content.active {
            display: block;
        }
        
        /* å•é¡Œã‚¿ãƒ–ç”¨ */
        details {
            background: #f9f9f9;
            border-radius: 8px;
            margin: 15px 0;
            padding: 15px;
        }
        summary {
            cursor: pointer;
            font-weight: bold;
            color: #667eea;
            padding: 10px;
            background: #e8e8e8;
            border-radius: 5px;
            margin: -15px -15px 0 -15px;
        }
        summary:hover {
            background: #ddd;
        }
        details[open] summary {
            margin-bottom: 15px;
        }
        .problem-box {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        .problem-box h4 {
            color: #667eea;
            margin-top: 0;
        }
        
        /* ã‚­ãƒ£ãƒ³ãƒã‚¹ãƒ©ãƒ™ãƒ« */
        .canvas-label {
            text-align: center;
            font-weight: 600;
            color: #444;
            margin-top: 5px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        /* æƒ…å ±ãƒœãƒƒã‚¯ã‚¹ */
        .info-box {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid #2196F3;
        }
        .info-box h4 {
            margin-top: 0;
            color: #1976D2;
        }
        .info-box p {
            margin: 5px 0;
            color: #555;
            line-height: 1.6;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            header, .container {
                padding: 15px;
            }
            .tab-btn {
                min-width: 100px;
                font-size: 14px;
            }
            .comparison-container {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header>
        <a href="index.html" class="back-link">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
        <h1>æ³¢(æ³¢å‹•)ã¨ã„ã†æ¦‚å¿µ</h1>
    </header>
    <div class="container">
        
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('lecture')">è§£èª¬ç·¨</button>
            <button class="tab-btn" onclick="openTab('problem')">å•é¡Œç·¨</button>
            <button class="tab-btn" onclick="openTab('simulation')">ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</button>
        </div>
        
        <!-- ==================== è§£èª¬ã‚¿ãƒ– ==================== -->
        <div id="lecture" class="tab-content active">
            <h2>æ³¢(æ³¢å‹•)ã¨ã„ã†æ¦‚å¿µ</h2>
            
            <!-- PDFåŸ‹ã‚è¾¼ã¿ -->
            <iframe src="https://drive.google.com/file/d/1rd3AUHNkj-NLM0IEztEdsiVOdPwxD6EA/preview" width="100%" height="500" style="border: none; border-radius: 8px; margin-bottom: 20px;"></iframe>
            
            <h3>1. æ³¢ã®å®šç¾©</h3>
            <div class="concept-box">
                <h4>ğŸ“Œ æ³¢ï¼ˆæ³¢å‹•ï¼‰ã¨ã¯</h4>
                <p><strong>ã‚ã‚‹ç‚¹ã§èµ·ã“ã£ãŸæŒ¯å‹•ãŒã€å‘¨å›²ã¸æ¬¡ã€…ã¨ä¼ã‚ã£ã¦ã„ãç¾è±¡</strong>ã®ã“ã¨ã§ã™ã€‚</p>
                <p>é‡è¦ãªã®ã¯ã€<strong>åª’è³ªï¼ˆæ³¢ã‚’ä¼ãˆã‚‹ç‰©è³ªï¼‰è‡ªä½“ã¯ç§»å‹•ã—ãªã„</strong>ã¨ã„ã†ã“ã¨ã€‚å„ç‚¹ã¯è‡ªåˆ†ã®ä½ç½®ã§æŒ¯å‹•ã™ã‚‹ã ã‘ã§ã€æŒ¯å‹•ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ãŒä¼ã‚ã£ã¦ã„ãã¾ã™ã€‚</p>
            </div>
            
            <!-- å‹•çš„ãƒ„ãƒ¼ãƒ«ï¼šæ³¢æºã‹ã‚‰ã®æ¨ªæ³¢ç™ºç”Ÿ -->
            <div class="dynamic-tool">
                <canvas id="waveGenerationCanvas" height="200"></canvas>
                <p>â–² æ³¢æºï¼ˆå·¦ç«¯ã®èµ¤ã„ç‚¹ï¼‰ãŒä¸Šä¸‹ã«æŒ¯å‹•ã™ã‚‹ã¨ã€ãã®æŒ¯å‹•ãŒå³ã¸ä¼ã‚ã£ã¦ã„ãã¾ã™ã€‚<br>å„åª’è³ªç‚¹ï¼ˆé’ã„ç‚¹ï¼‰ã¯ä¸Šä¸‹ã«å‹•ãã ã‘ã§ã€æ¨ªã«ã¯ç§»å‹•ã—ã¦ã„ãªã„ã“ã¨ã«æ³¨ç›®ï¼</p>
            </div>
            
            <h3>2. æ³¢ã®ç”¨èª</h3>
            <table class="term-table">
                <tr>
                    <th>ç”¨èª</th>
                    <th>æ„å‘³</th>
                    <th>è£œè¶³</th>
                </tr>
                <tr>
                    <td><strong>æ³¢æº</strong></td>
                    <td>æ³¢ã®ç™ºç”Ÿæºï¼ˆæŒ¯å‹•ã®é–‹å§‹åœ°ç‚¹ï¼‰</td>
                    <td>ã‚¹ãƒ”ãƒ¼ã‚«ãƒ¼ã€æŒ¯å‹•ã™ã‚‹æ‰‹ãªã©</td>
                </tr>
                <tr>
                    <td><strong>åª’è³ª</strong></td>
                    <td>æ³¢ã‚’ä¼ãˆã‚‹ç‰©è³ª</td>
                    <td>ç©ºæ°—ã€æ°´ã€ãƒ­ãƒ¼ãƒ—ãªã©</td>
                </tr>
                <tr>
                    <td><strong>æ³¢ã®é€Ÿã• $v$</strong></td>
                    <td>æ³¢ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ãŒä¼ã‚ã‚‹é€Ÿã•</td>
                    <td>åª’è³ªã®æ€§è³ªã§æ±ºã¾ã‚‹</td>
                </tr>
                <tr>
                    <td><strong>æ³¢å½¢</strong></td>
                    <td>æ³¢ã®å½¢</td>
                    <td>é«˜æ ¡ã§ã¯ä¸»ã«æ­£å¼¦æ³¢ã‚’æ‰±ã†</td>
                </tr>
            </table>
            
            <!-- é™çš„å›³è§£ï¼šæ³¢ã®æ§‹é€  -->
            <div class="static-diagram">
                <canvas id="waveStructureCanvas" height="220"></canvas>
            </div>
            
            <h3>3. æ­£å¼¦æ³¢ã¨æ³¢ã®åŸºæœ¬é‡</h3>
            <p>æ³¢æºãŒ<strong>å˜æŒ¯å‹•</strong>ï¼ˆä¸€å®šã®å‘¨æœŸã§ç¹°ã‚Šè¿”ã™æŒ¯å‹•ï¼‰ã‚’ã™ã‚‹ã¨ã€ä¼ã‚ã£ã¦ã„ãæ³¢å½¢ã¯<strong>æ­£å¼¦æ›²ç·šï¼ˆã‚µã‚¤ãƒ³ã‚«ãƒ¼ãƒ–ï¼‰</strong>ã‚’æãã¾ã™ã€‚ã“ã®æ³¢ã‚’<strong>æ­£å¼¦æ³¢</strong>ã¨ã„ã„ã¾ã™ã€‚</p>
            
            <div class="concept-box formula">
                <h4>ğŸ“ æ³¢ã‚’è¡¨ã™åŸºæœ¬é‡</h4>
                <table class="term-table">
                    <tr>
                        <th>é‡</th>
                        <th>è¨˜å·</th>
                        <th>å˜ä½</th>
                        <th>æ„å‘³</th>
                    </tr>
                    <tr>
                        <td><strong>æŒ¯å¹…</strong></td>
                        <td>$A$</td>
                        <td>m</td>
                        <td>æŒ¯å‹•ã®ä¸­å¿ƒã‹ã‚‰å±±ï¼ˆã¾ãŸã¯è°·ï¼‰ã¾ã§ã®è·é›¢</td>
                    </tr>
                    <tr>
                        <td><strong>æ³¢é•·</strong></td>
                        <td>$\lambda$ï¼ˆãƒ©ãƒ ãƒ€ï¼‰</td>
                        <td>m</td>
                        <td>æ³¢1å€‹åˆ†ã®é•·ã•ï¼ˆå±±ã‹ã‚‰å±±ã€è°·ã‹ã‚‰è°·ï¼‰</td>
                    </tr>
                    <tr>
                        <td><strong>å‘¨æœŸ</strong></td>
                        <td>$T$</td>
                        <td>s</td>
                        <td>1å›ã®æŒ¯å‹•ã«ã‹ã‹ã‚‹æ™‚é–“</td>
                    </tr>
                    <tr>
                        <td><strong>æŒ¯å‹•æ•°</strong></td>
                        <td>$f$</td>
                        <td>Hz</td>
                        <td>1ç§’é–“ã«æŒ¯å‹•ã™ã‚‹å›æ•°</td>
                    </tr>
                </table>
            </div>
            
            <div class="concept-box important">
                <h4>âš¡ æ³¢ã®æ•°ãˆæ–¹</h4>
                <p>æ³¢ã¯ã€Œ<strong>å±±1ã¤ã¨è°·1ã¤ã®ã‚»ãƒƒãƒˆ</strong>ã€ã§1ã¤ã¨æ•°ãˆã¾ã™ã€‚</p>
                <p>ã¤ã¾ã‚Šã€å±±ã ã‘ã€ã¾ãŸã¯è°·ã ã‘ã§ã¯ã€ŒåŠåˆ†ã®æ³¢ï¼ˆ$\frac{1}{2}$æ³¢ï¼‰ã€ã§ã™ã€‚</p>
            </div>
            
            <h3>4. å‘¨æœŸã¨æŒ¯å‹•æ•°ã®é–¢ä¿‚</h3>
            <div class="concept-box formula">
                <h4>ğŸ“ å‘¨æœŸã¨æŒ¯å‹•æ•°ã®é–¢ä¿‚å¼</h4>
                <p style="text-align: center; font-size: 1.3em;">
                    $$fT = 1 \quad \Leftrightarrow \quad f = \frac{1}{T} \quad \Leftrightarrow \quad T = \frac{1}{f}$$
                </p>
                <p>å‘¨æœŸ $T$ ã¨æŒ¯å‹•æ•° $f$ ã¯<strong>äº’ã„ã«é€†æ•°</strong>ã®é–¢ä¿‚ã§ã™ã€‚</p>
                <p>ä¾‹ï¼šå‘¨æœŸãŒ $T = 0.5$ s ãªã‚‰ã€æŒ¯å‹•æ•°ã¯ $f = \frac{1}{0.5} = 2$ Hzï¼ˆ1ç§’é–“ã«2å›æŒ¯å‹•ï¼‰</p>
            </div>
            
            <h3>5. æ³¢ã®åŸºæœ¬å¼</h3>
            <p>æ³¢ã®é€Ÿã• $v$ ã¯ã€æ³¢é•· $\lambda$ ã¨å‘¨æœŸ $T$ï¼ˆã¾ãŸã¯æŒ¯å‹•æ•° $f$ï¼‰ã‚’ä½¿ã£ã¦è¡¨ã›ã¾ã™ã€‚</p>
            
            <div class="concept-box formula">
                <h4>ğŸ“ æ³¢ã®åŸºæœ¬å¼</h4>
                <p style="text-align: center; font-size: 1.4em;">
                    $$v = \frac{\lambda}{T} = f\lambda$$
                </p>
                <p><strong>å°å‡ºã®è€ƒãˆæ–¹ï¼š</strong></p>
                <p>ãƒ»1å›ã®æŒ¯å‹•ï¼ˆæ™‚é–“ $T$ï¼‰ã§ã€æ³¢ã¯1æ³¢é•·åˆ†ï¼ˆè·é›¢ $\lambda$ï¼‰é€²ã‚€</p>
                <p>ãƒ»ã‚ˆã£ã¦ã€é€Ÿã• $v = \frac{\text{è·é›¢}}{\text{æ™‚é–“}} = \frac{\lambda}{T}$</p>
                <p>ãƒ»$f = \frac{1}{T}$ ã‚’ä»£å…¥ã™ã‚‹ã¨ã€$v = f\lambda$</p>
            </div>
            
            <h3>6. æ¨ªæ³¢ã¨ç¸¦æ³¢</h3>
            <p>æ³¢ã¯ã€<strong>æŒ¯å‹•æ–¹å‘</strong>ã¨<strong>é€²è¡Œæ–¹å‘</strong>ã®é–¢ä¿‚ã«ã‚ˆã£ã¦2ç¨®é¡ã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚</p>
            
            <div class="comparison-container">
                <div class="comparison-box transverse">
                    <h4>æ¨ªæ³¢ï¼ˆTransverse Waveï¼‰</h4>
                    <p><strong>æŒ¯å‹•æ–¹å‘ã¨é€²è¡Œæ–¹å‘ãŒå‚ç›´</strong></p>
                    <p>ãƒ»åª’è³ªãŒä¸Šä¸‹ï¼ˆã¾ãŸã¯å·¦å³ï¼‰ã«æŒ¯å‹•</p>
                    <p>ãƒ»æ³¢å½¢ã«ã€Œå±±ã€ã¨ã€Œè°·ã€ãŒã§ãã‚‹</p>
                    <p><strong>ä¾‹ï¼š</strong>å…‰ã€é›»ç£æ³¢ã€ãƒ­ãƒ¼ãƒ—ã®æ³¢ã€åœ°éœ‡ã®Sæ³¢</p>
                </div>
                <div class="comparison-box longitudinal">
                    <h4>ç¸¦æ³¢ï¼ˆLongitudinal Waveï¼‰</h4>
                    <p><strong>æŒ¯å‹•æ–¹å‘ã¨é€²è¡Œæ–¹å‘ãŒå¹³è¡Œ</strong></p>
                    <p>ãƒ»åª’è³ªãŒå‰å¾Œã«æŒ¯å‹•</p>
                    <p>ãƒ»ã€Œå¯†ã€ã¨ã€Œç–ã€ã®éƒ¨åˆ†ãŒã§ãã‚‹</p>
                    <p><strong>ä¾‹ï¼š</strong>éŸ³æ³¢ã€åœ°éœ‡ã®Pæ³¢ã€ã°ã­ã®æ³¢</p>
                </div>
            </div>
            
            <div class="concept-box important">
                <h4>âš¡ ç¸¦æ³¢ã‚’æ¨ªæ³¢ã§è¡¨ã™ï¼ˆæ¨ªæ³¢è¡¨è¨˜ï¼‰</h4>
                <p>ç¸¦æ³¢ã¯ã€Œå¯†ã€ã€Œç–ã€ã§è¡¨ã•ã‚Œã¾ã™ãŒã€ã‚°ãƒ©ãƒ•ã«ã—ã«ãã„ãŸã‚ã€<strong>å¤‰ä½ã‚’ç¸¦è»¸ã«å–ã£ãŸæ¨ªæ³¢ã®ã‚°ãƒ©ãƒ•</strong>ã§è¡¨ã™ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</p>
                <p>ãƒ»é€²è¡Œæ–¹å‘ï¼ˆ+xæ–¹å‘ï¼‰ã¸ã®å¤‰ä½ â†’ ã‚°ãƒ©ãƒ•ã®ä¸Šï¼ˆ+yæ–¹å‘ï¼‰</p>
                <p>ãƒ»é€†æ–¹å‘ï¼ˆ-xæ–¹å‘ï¼‰ã¸ã®å¤‰ä½ â†’ ã‚°ãƒ©ãƒ•ã®ä¸‹ï¼ˆ-yæ–¹å‘ï¼‰</p>
                <p>è©³ã—ãã¯ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ–ã®ã€Œç¸¦æ³¢ã®æ¨ªæ³¢è¡¨è¨˜ã€ã§ç¢ºèªã§ãã¾ã™ï¼</p>
            </div>
            
            <div class="concept-box">
                <h4>ğŸ”¬ ç¸¦æ³¢ã¨æ¨ªæ³¢ã®ç™ºç”Ÿæ¡ä»¶</h4>
                <p><strong>æ¨ªæ³¢ï¼š</strong>åª’è³ªã®çµåˆãŒã€Œå¼•ã£å¼µã‚‰ã‚Œã‚‹ã€åŠ›ã§æˆã‚Šç«‹ã¤å ´åˆã«ç™ºç”Ÿã€‚å›ºä½“ä¸­ã‚„è¡¨é¢å¼µåŠ›ã®ã‚ã‚‹æ¶²ä½“è¡¨é¢ã§ä¼ã‚ã‚‹ã€‚</p>
                <p><strong>ç¸¦æ³¢ï¼š</strong>åª’è³ªã®çµåˆãŒã€ŒæŠ¼ã—å¼•ãã€ã®åŠ›ã§æˆã‚Šç«‹ã¤å ´åˆã«ç™ºç”Ÿã€‚æ°—ä½“ãƒ»æ¶²ä½“ãƒ»å›ºä½“ã™ã¹ã¦ã§ä¼ã‚ã‚‹ã€‚</p>
                <p>â†’ éŸ³ã¯ç©ºæ°—ï¼ˆæ°—ä½“ï¼‰ä¸­ã‚’ä¼ã‚ã‚‹ã®ã§ç¸¦æ³¢ï¼</p>
            </div>
        </div>
        
        <!-- ==================== å•é¡Œã‚¿ãƒ– ==================== -->
        <div id="problem" class="tab-content">
            <h2>ç¢ºèªå•é¡Œ</h2>
            
            <div class="problem-box">
                <h4>å•é¡Œ1ï¼šæ³¢ã®åŸºæœ¬æ¦‚å¿µ</h4>
                <p>æ°´é¢ã«çŸ³ã‚’è½ã¨ã™ã¨ã€æ³¢ç´‹ãŒåºƒãŒã£ã¦ã„ãã€‚ã“ã®ã¨ãã€æ°´é¢ã«æµ®ã‹ã¹ãŸæœ¨ã®è‘‰ã¯ã©ã®ã‚ˆã†ãªå‹•ãã‚’ã™ã‚‹ã‹ã€ç†ç”±ã¨ã¨ã‚‚ã«èª¬æ˜ã›ã‚ˆã€‚</p>
            </div>
            <details>
                <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¡¨ç¤º</summary>
                <p><strong>ã€è§£ç­”ã€‘</strong></p>
                <p>æœ¨ã®è‘‰ã¯ã€æ³¢ã®é€²è¡Œæ–¹å‘ã«ã¯ç§»å‹•ã›ãšã€ãã®å ´ã§ä¸Šä¸‹ã«æŒ¯å‹•ã™ã‚‹ã€‚</p>
                <p><strong>ã€è§£èª¬ã€‘</strong></p>
                <p>æ³¢ã¯ã€ŒæŒ¯å‹•ãŒä¼ã‚ã‚‹ç¾è±¡ã€ã§ã‚ã‚Šã€åª’è³ªï¼ˆæ°´ï¼‰è‡ªä½“ãŒç§»å‹•ã™ã‚‹ã‚ã‘ã§ã¯ãªã„ã€‚æ°´ã®å„ç‚¹ã¯è‡ªåˆ†ã®ä½ç½®ã§ä¸Šä¸‹ã«æŒ¯å‹•ã™ã‚‹ã ã‘ã§ã€æ³¢ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ãŒå¤–å´ã«ä¼ã‚ã£ã¦ã„ãã€‚ã—ãŸãŒã£ã¦ã€æ°´é¢ã«æµ®ã‹ã¶æœ¨ã®è‘‰ã‚‚ã€æ°´ã¨ä¸€ç·’ã«ä¸Šä¸‹ã«æŒ¯å‹•ã™ã‚‹ã ã‘ã§ã€æ³¢ç´‹ã¨ä¸€ç·’ã«å¤–å´ã¸æµã•ã‚Œã‚‹ã“ã¨ã¯ãªã„ã€‚</p>
            </details>
            
            <div class="problem-box">
                <h4>å•é¡Œ2ï¼šæ³¢ã®åŸºæœ¬é‡ã®è¨ˆç®—</h4>
                <p>æŒ¯å‹•æ•° $f = 5.0$ Hzã€æ³¢é•· $\lambda = 0.40$ m ã®æ³¢ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã‚’æ±‚ã‚ã‚ˆã€‚</p>
                <p>(1) ã“ã®æ³¢ã®å‘¨æœŸ $T$</p>
                <p>(2) ã“ã®æ³¢ã®é€Ÿã• $v$</p>
            </div>
            <details>
                <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¡¨ç¤º</summary>
                <p><strong>ã€è§£ç­”ã€‘</strong></p>
                <p>(1) $T = 0.20$ s</p>
                <p>(2) $v = 2.0$ m/s</p>
                <p><strong>ã€è§£èª¬ã€‘</strong></p>
                <p>(1) å‘¨æœŸã¨æŒ¯å‹•æ•°ã®é–¢ä¿‚ $fT = 1$ ã‚ˆã‚Šã€</p>
                <p>$$T = \frac{1}{f} = \frac{1}{5.0} = 0.20 \text{ s}$$</p>
                <p>(2) æ³¢ã®åŸºæœ¬å¼ $v = f\lambda$ ã‚ˆã‚Šã€</p>
                <p>$$v = 5.0 \times 0.40 = 2.0 \text{ m/s}$$</p>
            </details>
            
            <div class="problem-box">
                <h4>å•é¡Œ3ï¼šç¸¦æ³¢ã¨æ¨ªæ³¢</h4>
                <p>ä»¥ä¸‹ã®(a)ã€œ(d)ã®æ³¢ã‚’ã€æ¨ªæ³¢ã¨ç¸¦æ³¢ã«åˆ†é¡ã›ã‚ˆã€‚ã¾ãŸã€ãã®åˆ¤æ–­ç†ç”±ã‚’ç°¡æ½”ã«è¿°ã¹ã‚ˆã€‚</p>
                <p>(a) å…‰ã€€(b) éŸ³ã€€(c) åœ°éœ‡ã®Pæ³¢ã€€(d) åœ°éœ‡ã®Sæ³¢</p>
            </div>
            <details>
                <summary>è§£ç­”ãƒ»è§£èª¬ã‚’è¡¨ç¤º</summary>
                <p><strong>ã€è§£ç­”ã€‘</strong></p>
                <p><strong>æ¨ªæ³¢ï¼š</strong>(a) å…‰ã€(d) åœ°éœ‡ã®Sæ³¢</p>
                <p><strong>ç¸¦æ³¢ï¼š</strong>(b) éŸ³ã€(c) åœ°éœ‡ã®Pæ³¢</p>
                <p><strong>ã€è§£èª¬ã€‘</strong></p>
                <p>ãƒ»<strong>å…‰ï¼š</strong>é›»å ´ã¨ç£å ´ãŒé€²è¡Œæ–¹å‘ã«å‚ç›´ã«æŒ¯å‹•ã™ã‚‹é›»ç£æ³¢ãªã®ã§æ¨ªæ³¢ã€‚</p>
                <p>ãƒ»<strong>éŸ³ï¼š</strong>ç©ºæ°—åˆ†å­ãŒé€²è¡Œæ–¹å‘ã¨åŒã˜å‘ãã«æŒ¯å‹•ï¼ˆç–å¯†ï¼‰ã™ã‚‹ã®ã§ç¸¦æ³¢ã€‚</p>
                <p>ãƒ»<strong>Pæ³¢ï¼ˆPrimary waveï¼‰ï¼š</strong>å²©çŸ³ãŒé€²è¡Œæ–¹å‘ã«åœ§ç¸®ãƒ»è†¨å¼µã™ã‚‹ã®ã§ç¸¦æ³¢ã€‚é€Ÿåº¦ãŒé€Ÿãæœ€åˆã«å±Šãã€‚</p>
                <p>ãƒ»<strong>Sæ³¢ï¼ˆSecondary waveï¼‰ï¼š</strong>å²©çŸ³ãŒé€²è¡Œæ–¹å‘ã«å‚ç›´ã«æŒ¯å‹•ã™ã‚‹ã®ã§æ¨ªæ³¢ã€‚Pæ³¢ã‚ˆã‚Šé…ã‚Œã¦å±Šãã€‚</p>
            </details>
        </div>
        
        <!-- ==================== ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ– ==================== -->
        <div id="simulation" class="tab-content">
            <h2>å®Ÿé¨“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>
            
            <!-- ã‚µãƒ–ã‚¿ãƒ– -->
            <div class="sub-tabs">
                <button class="sub-tab-btn active" onclick="openSubTab('simA')">æ­£å¼¦æ³¢ã®ä¼æ’­</button>
                <button class="sub-tab-btn" onclick="openSubTab('simB')">ç¸¦æ³¢ã®æ¨ªæ³¢è¡¨è¨˜</button>
            </div>
            
            <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Aï¼šæ­£å¼¦æ³¢ã®ä¼æ’­ -->
            <div id="simA" class="sub-tab-content active">
                <p>æ³¢æºã®æŒ¯å‹•ãŒåª’è³ªã‚’ä¼ã‚ã£ã¦ã„ãæ§˜å­ã‚’è¦³å¯Ÿã—ã¾ã—ã‚‡ã†ã€‚ä»»æ„ã®è¦³æ¸¬ç‚¹ã«ãŠã‘ã‚‹ y-t ã‚°ãƒ©ãƒ•ã‚‚ç¢ºèªã§ãã¾ã™ã€‚</p>
                
                <div id="sim-container">
                    <canvas id="physicsCanvas"></canvas>
                    <div class="canvas-label">y-x ã‚°ãƒ©ãƒ•ï¼ˆã‚ã‚‹ç¬é–“ã®æ³¢å½¢ï¼‰</div>
                </div>
                
                <div class="sim-controls">
                    <div class="control-group">
                        <label>æŒ¯å¹… $A$: <span class="value-display" id="ampDisplay">1.0 m</span></label>
                        <input type="range" id="ampSlider" min="0.2" max="2.0" value="1.0" step="0.1">
                    </div>
                    
                    <div class="control-group">
                        <label>æ³¢é•· $\lambda$: <span class="value-display" id="waveDisplay">4.0 m</span></label>
                        <input type="range" id="waveSlider" min="2" max="10" value="4" step="0.5">
                    </div>
                    
                    <div class="control-group">
                        <label>å‘¨æœŸ $T$: <span class="value-display" id="periodDisplay">2.0 s</span></label>
                        <input type="range" id="periodSlider" min="0.5" max="4.0" value="2.0" step="0.1">
                    </div>
                    
                    <div class="control-group">
                        <label>è¦³æ¸¬ç‚¹ã®ä½ç½® $x$: <span class="value-display" id="observeDisplay">5.0 m</span></label>
                        <input type="range" id="observeSlider" min="0" max="15" value="5" step="0.5">
                    </div>
                    
                    <div class="button-group">
                        <button class="sim-button start" id="startBtnA">â–¶ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                        <button class="sim-button stop" id="stopBtnA">â¸ ã‚¹ãƒˆãƒƒãƒ—</button>
                        <button class="sim-button reset" id="resetBtnA">â†º ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                </div>
                
                <div class="graph-container">
                    <h3>y-t ã‚°ãƒ©ãƒ•ï¼ˆè¦³æ¸¬ç‚¹ $x$ ã«ãŠã‘ã‚‹æ™‚é–“å¤‰åŒ–ï¼‰</h3>
                    <canvas id="graphCanvas"></canvas>
                </div>
                
                <div class="info-box">
                    <h4>ğŸ“Š æ³¢ã®é€Ÿã•</h4>
                    <p>$v = \frac{\lambda}{T} = $ <span id="velocityDisplay" style="font-weight: bold; color: #667eea;">2.0</span> m/s</p>
                </div>
            </div>
            
            <!-- ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Bï¼šç¸¦æ³¢ã®æ¨ªæ³¢è¡¨è¨˜ -->
            <div id="simB" class="sub-tab-content">
                <p>ç¸¦æ³¢ã®ã€Œå¯†ã€ã€Œç–ã€ãŒã€æ¨ªæ³¢è¡¨è¨˜ã§ã©ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã‚‹ã‹ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p>
                
                <div id="sim-container-b">
                    <canvas id="refCanvas" height="100"></canvas>
                    <div class="canvas-label">â‘  åŸºæº–çŠ¶æ…‹ï¼ˆæ³¢ãŒç”Ÿã˜ã¦ã„ãªã„çŠ¶æ…‹ï¼‰</div>
                    
                    <canvas id="longCanvas" height="120"></canvas>
                    <div class="canvas-label">â‘¡ ç¸¦æ³¢ã®å‹•ãï¼ˆç²’å­ã®ç–å¯†ï¼‰</div>
                    
                    <canvas id="transCanvas" height="200"></canvas>
                    <div class="canvas-label">â‘¢ æ¨ªæ³¢è¡¨è¨˜ã¸ã®å¤‰æ›ï¼ˆå¤‰ä½ã‚°ãƒ©ãƒ•ï¼‰</div>
                </div>
                
                <div class="sim-controls">
                    <div class="control-group">
                        <label>æ³¢é•·: <span class="value-display" id="waveDisplayB">4.0</span></label>
                        <input type="range" id="waveSliderB" min="2" max="8" step="0.5" value="4">
                    </div>
                    
                    <div class="control-group">
                        <label>æŒ¯å¹…: <span class="value-display" id="ampDisplayB">30</span></label>
                        <input type="range" id="ampSliderB" min="10" max="50" step="5" value="30">
                    </div>
                    
                    <div class="control-group">
                        <label>é€Ÿåº¦: <span class="value-display" id="speedDisplayB">1.0x</span></label>
                        <input type="range" id="speedSliderB" min="0.2" max="2" step="0.2" value="1">
                    </div>
                    
                    <div class="button-group">
                        <button class="sim-button start" id="startBtnB">â–¶ ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
                        <button class="sim-button stop" id="stopBtnB">â¸ ã‚¹ãƒˆãƒƒãƒ—</button>
                        <button class="sim-button reset" id="resetBtnB">â†º ãƒªã‚»ãƒƒãƒˆ</button>
                    </div>
                </div>
                
                <div class="info-box">
                    <h4>ğŸ“š ç†è§£ã®ãƒã‚¤ãƒ³ãƒˆ</h4>
                    <p><strong>ç¸¦æ³¢ã®å¤‰ä½ï¼š</strong>å„ç²’å­ãŒåŸºæº–ä½ç½®ã‹ã‚‰ã€Œ+xæ–¹å‘ï¼ˆå³ï¼‰ã€ã¾ãŸã¯ã€Œ-xæ–¹å‘ï¼ˆå·¦ï¼‰ã€ã«ãšã‚ŒãŸé‡ã€‚</p>
                    <p><strong>æ¨ªæ³¢è¡¨è¨˜ã¸ã®å¤‰æ›ï¼š</strong>+xæ–¹å‘ã®å¤‰ä½ â†’ ã‚°ãƒ©ãƒ•ã®ä¸Šï¼ˆ+yï¼‰ã€-xæ–¹å‘ã®å¤‰ä½ â†’ ã‚°ãƒ©ãƒ•ã®ä¸‹ï¼ˆ-yï¼‰</p>
                    <p><strong>ã€Œå¯†ã€ã¨ã€Œç–ã€ï¼š</strong>ã€Œå¯†ã€ã¯æ¨ªæ³¢ã‚°ãƒ©ãƒ•ã§å‚¾ããŒè² ã®éƒ¨åˆ†ã€ã€Œç–ã€ã¯å‚¾ããŒæ­£ã®éƒ¨åˆ†ã«å¯¾å¿œã€‚</p>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    // =====================================================
    // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆæ©Ÿèƒ½
    // =====================================================
    function openTab(tabName) {
        var contents = document.getElementsByClassName("tab-content");
        for (var i = 0; i < contents.length; i++) {
            contents[i].style.display = "none";
            contents[i].classList.remove("active");
        }
        var buttons = document.getElementsByClassName("tab-btn");
        for (var i = 0; i < buttons.length; i++) {
            buttons[i].classList.remove("active");
        }
        document.getElementById(tabName).style.display = "block";
        document.getElementById(tabName).classList.add("active");
        if (event) {
            event.currentTarget.classList.add("active");
        }
        
        // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ãƒ–ãŒé–‹ã‹ã‚ŒãŸã‚‰ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚’ãƒªã‚µã‚¤ã‚º
        if (tabName === 'simulation') {
            resizeAllCanvases();
        }
    }
    
    function openSubTab(tabName) {
        var contents = document.getElementsByClassName("sub-tab-content");
        for (var i = 0; i < contents.length; i++) {
            contents[i].style.display = "none";
            contents[i].classList.remove("active");
        }
        var buttons = document.getElementsByClassName("sub-tab-btn");
        for (var i = 0; i < buttons.length; i++) {
            buttons[i].classList.remove("active");
        }
        document.getElementById(tabName).style.display = "block";
        document.getElementById(tabName).classList.add("active");
        if (event) {
            event.currentTarget.classList.add("active");
        }
        
        resizeAllCanvases();
    }
    
    // =====================================================
    // è§£èª¬ã‚¿ãƒ–ï¼šå‹•çš„ãƒ„ãƒ¼ãƒ«ï¼ˆæ³¢æºã‹ã‚‰ã®æ¨ªæ³¢ç™ºç”Ÿï¼‰
    // =====================================================
    const waveGenCanvas = document.getElementById('waveGenerationCanvas');
    const waveGenCtx = waveGenCanvas.getContext('2d');
    let waveGenTime = 0;
    let waveGenAnimId = null;
    
    function resizeWaveGenCanvas() {
        const parent = waveGenCanvas.parentElement;
        const canvasWidth = parent.clientWidth - 30;
        waveGenCanvas.width = canvasWidth;
        waveGenCanvas.height = 200;
        waveGenCanvas.style.width = canvasWidth + 'px';
        waveGenCanvas.style.height = '200px';
    }
    
    function drawWaveGeneration() {
        const w = waveGenCanvas.width;
        const h = waveGenCanvas.height;
        const cx = h / 2;
        
        waveGenCtx.clearRect(0, 0, w, h);
        
        // èƒŒæ™¯ã‚°ãƒªãƒƒãƒ‰
        waveGenCtx.strokeStyle = '#eee';
        waveGenCtx.lineWidth = 1;
        for (let y = 0; y <= h; y += 20) {
            waveGenCtx.beginPath();
            waveGenCtx.moveTo(0, y);
            waveGenCtx.lineTo(w, y);
            waveGenCtx.stroke();
        }
        
        // ä¸­å¿ƒç·š
        waveGenCtx.strokeStyle = '#ccc';
        waveGenCtx.lineWidth = 2;
        waveGenCtx.beginPath();
        waveGenCtx.moveTo(30, cx);
        waveGenCtx.lineTo(w - 20, cx);
        waveGenCtx.stroke();
        
        // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        const amplitude = 40;
        const wavelength = 120;
        const omega = 2;
        const k = 2 * Math.PI / wavelength;
        const numPoints = 40;
        const spacing = (w - 80) / numPoints;
        
        // æ³¢æºã®ä½ç½®
        const sourceX = 50;
        const sourceY = cx - amplitude * Math.sin(omega * waveGenTime);
        
        // æ³¢æºã‚’æç”»
        waveGenCtx.fillStyle = '#E91E63';
        waveGenCtx.beginPath();
        waveGenCtx.arc(sourceX, sourceY, 10, 0, Math.PI * 2);
        waveGenCtx.fill();
        
        // æ³¢æºã®ãƒ©ãƒ™ãƒ«
        waveGenCtx.fillStyle = '#E91E63';
        waveGenCtx.font = 'bold 12px sans-serif';
        waveGenCtx.fillText('æ³¢æº', sourceX - 12, cx + 60);
        
        // åª’è³ªç‚¹ã¨æ³¢å½¢ã‚’æç”»
        waveGenCtx.strokeStyle = '#667eea';
        waveGenCtx.lineWidth = 2;
        waveGenCtx.beginPath();
        
        for (let i = 0; i <= numPoints; i++) {
            const x = sourceX + i * spacing;
            const phase = k * (x - sourceX) - omega * waveGenTime;
            
            // æ³¢ãŒã¾ã å±Šã„ã¦ã„ãªã„éƒ¨åˆ†ã¯æç”»ã—ãªã„
            const waveSpeed = omega / k;
            const waveFront = sourceX + waveSpeed * waveGenTime * 60;
            
            let y;
            if (x <= waveFront) {
                y = cx - amplitude * Math.sin(phase);
            } else {
                y = cx;
            }
            
            if (i === 0) {
                waveGenCtx.moveTo(x, y);
            } else {
                waveGenCtx.lineTo(x, y);
            }
            
            // åª’è³ªç‚¹ã‚’æç”»ï¼ˆ5ç‚¹ã”ã¨ï¼‰
            if (i > 0 && i % 3 === 0 && x < w - 30) {
                waveGenCtx.fillStyle = '#2196F3';
                waveGenCtx.beginPath();
                waveGenCtx.arc(x, y, 5, 0, Math.PI * 2);
                waveGenCtx.fill();
                
                // å‚ç›´æ–¹å‘ã®å‹•ãã‚’ç¤ºã™ç·š
                if (x <= waveFront) {
                    waveGenCtx.strokeStyle = 'rgba(33, 150, 243, 0.3)';
                    waveGenCtx.lineWidth = 1;
                    waveGenCtx.setLineDash([3, 3]);
                    waveGenCtx.beginPath();
                    waveGenCtx.moveTo(x, cx - amplitude - 5);
                    waveGenCtx.lineTo(x, cx + amplitude + 5);
                    waveGenCtx.stroke();
                    waveGenCtx.setLineDash([]);
                }
                
                waveGenCtx.strokeStyle = '#667eea';
                waveGenCtx.lineWidth = 2;
            }
        }
        waveGenCtx.stroke();
        
        // é€²è¡Œæ–¹å‘ã®çŸ¢å°
        waveGenCtx.fillStyle = '#333';
        waveGenCtx.font = '14px sans-serif';
        waveGenCtx.fillText('æ³¢ã®é€²è¡Œæ–¹å‘ â†’', w - 130, 25);
        
        waveGenTime += 0.03;
        waveGenAnimId = requestAnimationFrame(drawWaveGeneration);
    }
    
    // =====================================================
    // è§£èª¬ã‚¿ãƒ–ï¼šé™çš„å›³è§£ï¼ˆæ³¢ã®æ§‹é€ ï¼‰
    // =====================================================
    const waveStructCanvas = document.getElementById('waveStructureCanvas');
    const waveStructCtx = waveStructCanvas.getContext('2d');
    
    function resizeWaveStructCanvas() {
        const parent = waveStructCanvas.parentElement;
        const canvasWidth = parent.clientWidth - 30;
        waveStructCanvas.width = canvasWidth;
        waveStructCanvas.height = 220;
        waveStructCanvas.style.width = canvasWidth + 'px';
        waveStructCanvas.style.height = '220px';
    }
    
    function drawWaveStructure() {
        const w = waveStructCanvas.width;
        const h = waveStructCanvas.height;
        const cx = h / 2 + 20;
        
        waveStructCtx.clearRect(0, 0, w, h);
        
        // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        const amplitude = 50;
        const wavelength = w / 3;
        
        // ä¸­å¿ƒç·šï¼ˆå¹³è¡¡ä½ç½®ï¼‰
        waveStructCtx.strokeStyle = '#999';
        waveStructCtx.lineWidth = 1;
        waveStructCtx.setLineDash([5, 5]);
        waveStructCtx.beginPath();
        waveStructCtx.moveTo(30, cx);
        waveStructCtx.lineTo(w - 30, cx);
        waveStructCtx.stroke();
        waveStructCtx.setLineDash([]);
        
        // æ­£å¼¦æ³¢ã‚’æç”»
        waveStructCtx.strokeStyle = '#667eea';
        waveStructCtx.lineWidth = 3;
        waveStructCtx.beginPath();
        for (let x = 30; x <= w - 30; x++) {
            const y = cx - amplitude * Math.sin(2 * Math.PI * (x - 30) / wavelength);
            if (x === 30) {
                waveStructCtx.moveTo(x, y);
            } else {
                waveStructCtx.lineTo(x, y);
            }
        }
        waveStructCtx.stroke();
        
        // æŒ¯å¹…ã®çŸ¢å°ï¼ˆå±±ï¼‰
        const peakX = 30 + wavelength / 4;
        waveStructCtx.strokeStyle = '#E91E63';
        waveStructCtx.lineWidth = 2;
        waveStructCtx.beginPath();
        waveStructCtx.moveTo(peakX, cx);
        waveStructCtx.lineTo(peakX, cx - amplitude);
        waveStructCtx.stroke();
        // çŸ¢å°ã®é ­
        waveStructCtx.beginPath();
        waveStructCtx.moveTo(peakX - 5, cx - amplitude + 10);
        waveStructCtx.lineTo(peakX, cx - amplitude);
        waveStructCtx.lineTo(peakX + 5, cx - amplitude + 10);
        waveStructCtx.stroke();
        waveStructCtx.fillStyle = '#E91E63';
        waveStructCtx.font = 'bold 14px sans-serif';
        waveStructCtx.fillText('æŒ¯å¹… A', peakX + 10, cx - amplitude / 2);
        
        // æ³¢é•·ã®çŸ¢å°
        const wlStartX = 30 + wavelength / 4;
        const wlEndX = wlStartX + wavelength;
        const wlY = cx - amplitude - 25;
        waveStructCtx.strokeStyle = '#4CAF50';
        waveStructCtx.lineWidth = 2;
        waveStructCtx.beginPath();
        waveStructCtx.moveTo(wlStartX, wlY);
        waveStructCtx.lineTo(wlEndX, wlY);
        waveStructCtx.stroke();
        // ä¸¡ç«¯ã®çŸ¢å°
        waveStructCtx.beginPath();
        waveStructCtx.moveTo(wlStartX + 10, wlY - 5);
        waveStructCtx.lineTo(wlStartX, wlY);
        waveStructCtx.lineTo(wlStartX + 10, wlY + 5);
        waveStructCtx.moveTo(wlEndX - 10, wlY - 5);
        waveStructCtx.lineTo(wlEndX, wlY);
        waveStructCtx.lineTo(wlEndX - 10, wlY + 5);
        waveStructCtx.stroke();
        waveStructCtx.fillStyle = '#4CAF50';
        waveStructCtx.fillText('æ³¢é•· Î»', (wlStartX + wlEndX) / 2 - 25, wlY - 8);
        
        // å±±ã¨è°·ã®ãƒ©ãƒ™ãƒ«
        waveStructCtx.fillStyle = '#667eea';
        waveStructCtx.font = '13px sans-serif';
        waveStructCtx.fillText('å±±', peakX - 8, cx - amplitude - 5);
        const valleyX = 30 + 3 * wavelength / 4;
        waveStructCtx.fillText('è°·', valleyX - 8, cx + amplitude + 18);
        
        // è»¸ãƒ©ãƒ™ãƒ«
        waveStructCtx.fillStyle = '#333';
        waveStructCtx.font = '12px sans-serif';
        waveStructCtx.fillText('å¤‰ä½ y', 5, 25);
        waveStructCtx.fillText('ä½ç½® x', w - 50, cx + 20);
        waveStructCtx.fillText('0', 15, cx + 5);
    }
    
    // =====================================================
    // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Aï¼šæ­£å¼¦æ³¢ã®ä¼æ’­
    // =====================================================
    const physCanvas = document.getElementById('physicsCanvas');
    const physCtx = physCanvas.getContext('2d');
    const graphCanvas = document.getElementById('graphCanvas');
    const graphCtx = graphCanvas.getContext('2d');
    
    let simARunning = false;
    let simATime = 0;
    let simAAnimId = null;
    let ytHistory = [];
    const maxHistory = 300;
    
    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    let simA_amplitude = 1.0;
    let simA_wavelength = 4.0;
    let simA_period = 2.0;
    let simA_observeX = 5.0;
    
    function resizeSimACanvases() {
        const container = document.getElementById('sim-container');
        if (container) {
            const canvasWidth = container.clientWidth - 40;
            physCanvas.width = canvasWidth;
            physCanvas.height = 300;
            physCanvas.style.width = canvasWidth + 'px';
            physCanvas.style.height = '300px';
        }
        const graphContainer = graphCanvas.parentElement;
        if (graphContainer) {
            // ã‚°ãƒ©ãƒ•ã‚­ãƒ£ãƒ³ãƒã‚¹ã®å¹…ã‚’è¦ªè¦ç´ ã«åˆã‚ã›ã‚‹ï¼ˆå†…éƒ¨è§£åƒåº¦ã¨è¡¨ç¤ºã‚µã‚¤ã‚ºã‚’ä¸€è‡´ã•ã›ã‚‹ï¼‰
            const canvasWidth = graphContainer.clientWidth - 30;
            graphCanvas.width = canvasWidth;
            graphCanvas.height = 200;
            graphCanvas.style.width = canvasWidth + 'px';
            graphCanvas.style.height = '200px';
        }
    }
    
    function updateSimAParams() {
        simA_amplitude = parseFloat(document.getElementById('ampSlider').value);
        simA_wavelength = parseFloat(document.getElementById('waveSlider').value);
        simA_period = parseFloat(document.getElementById('periodSlider').value);
        simA_observeX = parseFloat(document.getElementById('observeSlider').value);
        
        document.getElementById('ampDisplay').textContent = simA_amplitude.toFixed(1) + ' m';
        document.getElementById('waveDisplay').textContent = simA_wavelength.toFixed(1) + ' m';
        document.getElementById('periodDisplay').textContent = simA_period.toFixed(1) + ' s';
        document.getElementById('observeDisplay').textContent = simA_observeX.toFixed(1) + ' m';
        
        const velocity = simA_wavelength / simA_period;
        document.getElementById('velocityDisplay').textContent = velocity.toFixed(2);
        
        if (!simARunning) {
            drawSimA();
        }
    }
    
    function drawSimA() {
        const w = physCanvas.width;
        const h = physCanvas.height;
        const cx = h / 2;
        const margin = 60;
        const plotWidth = w - 2 * margin;
        const plotHeight = h - 80;
        
        // ç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ãƒ”ã‚¯ã‚»ãƒ«ã¸ã®å¤‰æ›
        const xMax = 16; // è¡¨ç¤ºã™ã‚‹xç¯„å›² [m]
        const yMax = 2.5; // è¡¨ç¤ºã™ã‚‹yç¯„å›² [m]
        const xScale = plotWidth / xMax;
        const yScale = plotHeight / (2 * yMax);
        
        const omega = 2 * Math.PI / simA_period;
        const k = 2 * Math.PI / simA_wavelength;
        
        physCtx.clearRect(0, 0, w, h);
        
        // ã‚°ãƒªãƒƒãƒ‰
        physCtx.strokeStyle = '#eee';
        physCtx.lineWidth = 1;
        for (let i = 0; i <= xMax; i += 2) {
            const px = margin + i * xScale;
            physCtx.beginPath();
            physCtx.moveTo(px, 30);
            physCtx.lineTo(px, h - 30);
            physCtx.stroke();
        }
        for (let i = -2; i <= 2; i++) {
            const py = cx - i * yScale;
            physCtx.beginPath();
            physCtx.moveTo(margin, py);
            physCtx.lineTo(w - margin + 20, py);
            physCtx.stroke();
        }
        
        // xè»¸
        physCtx.strokeStyle = '#333';
        physCtx.lineWidth = 2;
        physCtx.beginPath();
        physCtx.moveTo(margin, cx);
        physCtx.lineTo(w - margin + 20, cx);
        physCtx.stroke();
        // çŸ¢å°
        physCtx.beginPath();
        physCtx.moveTo(w - margin + 10, cx - 5);
        physCtx.lineTo(w - margin + 20, cx);
        physCtx.lineTo(w - margin + 10, cx + 5);
        physCtx.stroke();
        
        // yè»¸
        physCtx.beginPath();
        physCtx.moveTo(margin, h - 20);
        physCtx.lineTo(margin, 20);
        physCtx.stroke();
        // çŸ¢å°
        physCtx.beginPath();
        physCtx.moveTo(margin - 5, 30);
        physCtx.lineTo(margin, 20);
        physCtx.lineTo(margin + 5, 30);
        physCtx.stroke();
        
        // è»¸ãƒ©ãƒ™ãƒ«
        physCtx.fillStyle = '#333';
        physCtx.font = '14px sans-serif';
        physCtx.fillText('y [m]', margin - 25, 15);
        physCtx.fillText('x [m]', w - margin + 5, cx + 20);
        physCtx.fillText('0', margin - 15, cx + 5);
        
        // ç›®ç››ã‚Š
        physCtx.font = '11px sans-serif';
        for (let i = 2; i <= xMax; i += 2) {
            const px = margin + i * xScale;
            physCtx.fillText(i.toString(), px - 5, cx + 18);
        }
        for (let i = -2; i <= 2; i++) {
            if (i !== 0) {
                const py = cx - i * yScale;
                physCtx.fillText(i.toString(), margin - 20, py + 4);
            }
        }
        
        // æ³¢å½¢æç”»
        physCtx.strokeStyle = '#667eea';
        physCtx.lineWidth = 3;
        physCtx.beginPath();
        
        const v = simA_wavelength / simA_period;
        const waveFront = v * simATime;
        
        for (let px = margin; px <= w - margin; px++) {
            const x = (px - margin) / xScale;
            let y;
            if (x <= waveFront) {
                y = simA_amplitude * Math.sin(k * x - omega * simATime);
            } else {
                y = 0;
            }
            const py = cx - y * yScale;
            
            if (px === margin) {
                physCtx.moveTo(px, py);
            } else {
                physCtx.lineTo(px, py);
            }
        }
        physCtx.stroke();
        
        // åª’è³ªç‚¹ã‚’æç”»
        for (let x = 0; x <= xMax; x += 0.5) {
            const px = margin + x * xScale;
            let y;
            if (x <= waveFront) {
                y = simA_amplitude * Math.sin(k * x - omega * simATime);
            } else {
                y = 0;
            }
            const py = cx - y * yScale;
            
            physCtx.fillStyle = '#2196F3';
            physCtx.beginPath();
            physCtx.arc(px, py, 4, 0, Math.PI * 2);
            physCtx.fill();
        }
        
        // æ³¢æº
        const sourceY = simA_amplitude * Math.sin(-omega * simATime);
        const sourcePy = cx - sourceY * yScale;
        physCtx.fillStyle = '#E91E63';
        physCtx.beginPath();
        physCtx.arc(margin, sourcePy, 8, 0, Math.PI * 2);
        physCtx.fill();
        physCtx.fillStyle = '#E91E63';
        physCtx.font = '12px sans-serif';
        physCtx.fillText('æ³¢æº', margin - 12, h - 10);
        
        // è¦³æ¸¬ç‚¹
        const obsPx = margin + simA_observeX * xScale;
        let obsY;
        if (simA_observeX <= waveFront) {
            obsY = simA_amplitude * Math.sin(k * simA_observeX - omega * simATime);
        } else {
            obsY = 0;
        }
        const obsPy = cx - obsY * yScale;
        
        // è¦³æ¸¬ç‚¹ã®ç¸¦ç·š
        physCtx.strokeStyle = 'rgba(255, 152, 0, 0.5)';
        physCtx.lineWidth = 2;
        physCtx.setLineDash([5, 5]);
        physCtx.beginPath();
        physCtx.moveTo(obsPx, 30);
        physCtx.lineTo(obsPx, h - 30);
        physCtx.stroke();
        physCtx.setLineDash([]);
        
        // è¦³æ¸¬ç‚¹ãƒãƒ¼ã‚«ãƒ¼
        physCtx.fillStyle = '#ff9800';
        physCtx.beginPath();
        physCtx.arc(obsPx, obsPy, 7, 0, Math.PI * 2);
        physCtx.fill();
        physCtx.strokeStyle = '#fff';
        physCtx.lineWidth = 2;
        physCtx.stroke();
        
        physCtx.fillStyle = '#ff9800';
        physCtx.font = 'bold 12px sans-serif';
        physCtx.fillText('è¦³æ¸¬ç‚¹', obsPx - 18, 25);
        
        // çµŒéæ™‚é–“è¡¨ç¤º
        physCtx.fillStyle = '#333';
        physCtx.font = '14px sans-serif';
        physCtx.fillText('t = ' + simATime.toFixed(2) + ' s', w - 100, 25);
        
        // y-tå±¥æ­´ã«è¿½åŠ 
        if (simARunning) {
            ytHistory.push({ t: simATime, y: obsY });
            if (ytHistory.length > maxHistory) {
                ytHistory.shift();
            }
        }
        
        // y-tã‚°ãƒ©ãƒ•æç”»
        drawYTGraph();
    }
    
    function drawYTGraph() {
        const w = graphCanvas.width;
        const h = graphCanvas.height;
        const marginLeft = 50;
        const marginRight = 30;
        const plotWidth = w - marginLeft - marginRight;
        const plotHeight = h - 60;
        const cx = h / 2 + 10;
        
        const tWindow = 10; // è¡¨ç¤ºã™ã‚‹æ™‚é–“å¹…ï¼ˆç§’ï¼‰
        const yMax = 2.5;
        const tScale = plotWidth / tWindow; // ãƒ”ã‚¯ã‚»ãƒ«/ç§’
        const yScale = plotHeight / (2 * yMax);
        
        // è¡¨ç¤ºã™ã‚‹æ™‚é–“ç¯„å›²ã‚’æ±ºå®šï¼ˆt=0ã‹ã‚‰é–‹å§‹ã€tWindowç§’ã‚’è¶…ãˆãŸã‚‰ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰
        const latestT = ytHistory.length > 0 ? ytHistory[ytHistory.length - 1].t : 0;
        const startT = Math.max(0, latestT - tWindow);
        const endT = startT + tWindow;
        
        graphCtx.clearRect(0, 0, w, h);
        
        // ã‚°ãƒªãƒƒãƒ‰ï¼ˆ1ç§’ã”ã¨ï¼‰
        graphCtx.strokeStyle = '#eee';
        graphCtx.lineWidth = 1;
        for (let i = 0; i <= tWindow; i++) {
            const px = marginLeft + i * tScale;
            graphCtx.beginPath();
            graphCtx.moveTo(px, 20);
            graphCtx.lineTo(px, h - 20);
            graphCtx.stroke();
        }
        for (let i = -2; i <= 2; i++) {
            const py = cx - i * yScale;
            graphCtx.beginPath();
            graphCtx.moveTo(marginLeft, py);
            graphCtx.lineTo(marginLeft + plotWidth, py);
            graphCtx.stroke();
        }
        
        // è»¸
        graphCtx.strokeStyle = '#333';
        graphCtx.lineWidth = 2;
        // tè»¸
        graphCtx.beginPath();
        graphCtx.moveTo(marginLeft, cx);
        graphCtx.lineTo(marginLeft + plotWidth + 10, cx);
        graphCtx.stroke();
        // çŸ¢å°
        graphCtx.beginPath();
        graphCtx.moveTo(marginLeft + plotWidth + 5, cx - 4);
        graphCtx.lineTo(marginLeft + plotWidth + 10, cx);
        graphCtx.lineTo(marginLeft + plotWidth + 5, cx + 4);
        graphCtx.stroke();
        // yè»¸
        graphCtx.beginPath();
        graphCtx.moveTo(marginLeft, h - 15);
        graphCtx.lineTo(marginLeft, 15);
        graphCtx.stroke();
        
        // è»¸ãƒ©ãƒ™ãƒ«
        graphCtx.fillStyle = '#333';
        graphCtx.font = '14px sans-serif';
        graphCtx.fillText('y [m]', 10, 15);
        graphCtx.fillText('t [s]', marginLeft + plotWidth + 12, cx + 5);
        
        // ç›®ç››ã‚Šï¼ˆstartTã«åŸºã¥ã„ã¦è¡¨ç¤ºï¼‰
        graphCtx.font = '11px sans-serif';
        const firstTick = Math.ceil(startT);
        for (let tValue = firstTick; tValue <= Math.floor(endT); tValue++) {
            const px = marginLeft + (tValue - startT) * tScale;
            if (px >= marginLeft - 5 && px <= marginLeft + plotWidth + 5) {
                graphCtx.fillText(tValue.toString(), px - 5, cx + 15);
            }
        }
        for (let i = -2; i <= 2; i++) {
            if (i !== 0) {
                const py = cx - i * yScale;
                graphCtx.fillText(i.toString(), marginLeft - 18, py + 4);
            }
        }
        
        // y-tæ›²ç·šã‚’æç”»
        if (ytHistory.length > 1) {
            graphCtx.strokeStyle = '#ff9800';
            graphCtx.lineWidth = 2;
            graphCtx.beginPath();
            
            let first = true;
            for (let i = 0; i < ytHistory.length; i++) {
                const point = ytHistory[i];
                if (point.t >= startT && point.t <= endT) {
                    const px = marginLeft + (point.t - startT) * tScale;
                    const py = cx - point.y * yScale;
                    
                    // æç”»ç¯„å›²å†…ã®ã¿
                    if (px >= marginLeft && px <= marginLeft + plotWidth) {
                        if (first) {
                            graphCtx.moveTo(px, py);
                            first = false;
                        } else {
                            graphCtx.lineTo(px, py);
                        }
                    }
                }
            }
            graphCtx.stroke();
        }
        
        // ç¾åœ¨ã®è¦³æ¸¬ç‚¹ã®yå€¤ã‚’è¡¨ç¤ºï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒ¼ã‚«ãƒ¼ï¼‰
        if (ytHistory.length > 0) {
            const lastPoint = ytHistory[ytHistory.length - 1];
            if (lastPoint.t >= startT && lastPoint.t <= endT) {
                const px = marginLeft + (lastPoint.t - startT) * tScale;
                const py = cx - lastPoint.y * yScale;
                if (px >= marginLeft && px <= marginLeft + plotWidth) {
                    graphCtx.fillStyle = '#ff9800';
                    graphCtx.beginPath();
                    graphCtx.arc(px, py, 5, 0, Math.PI * 2);
                    graphCtx.fill();
                }
            }
        }
        
        // è¦³æ¸¬ç‚¹è¡¨ç¤º
        graphCtx.fillStyle = '#ff9800';
        graphCtx.font = '12px sans-serif';
        graphCtx.fillText('x = ' + simA_observeX.toFixed(1) + ' m ã§ã®å¤‰ä½', w - 150, 20);
    }
    
    function animateSimA() {
        if (!simARunning) return;
        
        simATime += 0.02;
        drawSimA();
        simAAnimId = requestAnimationFrame(animateSimA);
    }
    
    // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Aã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    document.getElementById('startBtnA').addEventListener('click', function() {
        simARunning = true;
        animateSimA();
    });
    
    document.getElementById('stopBtnA').addEventListener('click', function() {
        simARunning = false;
        if (simAAnimId) {
            cancelAnimationFrame(simAAnimId);
        }
    });
    
    document.getElementById('resetBtnA').addEventListener('click', function() {
        simARunning = false;
        simATime = 0;
        ytHistory = [];
        if (simAAnimId) {
            cancelAnimationFrame(simAAnimId);
        }
        drawSimA();
    });
    
    document.getElementById('ampSlider').addEventListener('input', updateSimAParams);
    document.getElementById('waveSlider').addEventListener('input', updateSimAParams);
    document.getElementById('periodSlider').addEventListener('input', updateSimAParams);
    document.getElementById('observeSlider').addEventListener('input', updateSimAParams);
    
    // =====================================================
    // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Bï¼šç¸¦æ³¢ã®æ¨ªæ³¢è¡¨è¨˜
    // =====================================================
    const refCanvas = document.getElementById('refCanvas');
    const refCtx = refCanvas.getContext('2d');
    const longCanvas = document.getElementById('longCanvas');
    const longCtx = longCanvas.getContext('2d');
    const transCanvas = document.getElementById('transCanvas');
    const transCtx = transCanvas.getContext('2d');
    
    let simBRunning = false;
    let simBTime = 0;
    let simBAnimId = null;
    
    let simB_wavelength = 4;
    let simB_amplitude = 30;
    let simB_speed = 1;
    
    const numParticles = 50;
    
    function resizeSimBCanvases() {
        const container = document.getElementById('sim-container-b');
        if (container) {
            const canvasWidth = container.clientWidth - 40;
            refCanvas.width = canvasWidth;
            refCanvas.height = 100;
            refCanvas.style.width = canvasWidth + 'px';
            refCanvas.style.height = '100px';
            
            longCanvas.width = canvasWidth;
            longCanvas.height = 120;
            longCanvas.style.width = canvasWidth + 'px';
            longCanvas.style.height = '120px';
            
            transCanvas.width = canvasWidth;
            transCanvas.height = 200;
            transCanvas.style.width = canvasWidth + 'px';
            transCanvas.style.height = '200px';
        }
    }
    
    function updateSimBParams() {
        simB_wavelength = parseFloat(document.getElementById('waveSliderB').value);
        simB_amplitude = parseFloat(document.getElementById('ampSliderB').value);
        simB_speed = parseFloat(document.getElementById('speedSliderB').value);
        
        document.getElementById('waveDisplayB').textContent = simB_wavelength.toFixed(1);
        document.getElementById('ampDisplayB').textContent = simB_amplitude;
        document.getElementById('speedDisplayB').textContent = simB_speed.toFixed(1) + 'x';
        
        if (!simBRunning) {
            drawSimB();
        }
    }
    
    function drawSimB() {
        const canvasWidth = refCanvas.width;
        const particleSpacing = (canvasWidth - 100) / numParticles;
        
        // â‘  åŸºæº–çŠ¶æ…‹
        refCtx.clearRect(0, 0, refCanvas.width, refCanvas.height);
        refCtx.strokeStyle = '#ccc';
        refCtx.lineWidth = 2;
        refCtx.beginPath();
        refCtx.moveTo(50, refCanvas.height / 2);
        refCtx.lineTo(canvasWidth - 50, refCanvas.height / 2);
        refCtx.stroke();
        
        for (let i = 0; i < numParticles; i++) {
            const x = 50 + i * particleSpacing;
            const y = refCanvas.height / 2;
            
            refCtx.fillStyle = '#2196F3';
            refCtx.beginPath();
            refCtx.arc(x, y, 4, 0, Math.PI * 2);
            refCtx.fill();
            
            if (i % 5 === 0) {
                refCtx.strokeStyle = '#ddd';
                refCtx.lineWidth = 1;
                refCtx.beginPath();
                refCtx.moveTo(x, 15);
                refCtx.lineTo(x, refCanvas.height - 15);
                refCtx.stroke();
                
                refCtx.fillStyle = '#999';
                refCtx.font = '10px sans-serif';
                refCtx.fillText(i, x - 5, 12);
            }
        }
        
        // â‘¡ ç¸¦æ³¢ã®å‹•ã
        longCtx.clearRect(0, 0, longCanvas.width, longCanvas.height);
        longCtx.strokeStyle = '#ccc';
        longCtx.lineWidth = 2;
        longCtx.beginPath();
        longCtx.moveTo(50, longCanvas.height / 2);
        longCtx.lineTo(canvasWidth - 50, longCanvas.height / 2);
        longCtx.stroke();
        
        const densityRegions = [];
        
        for (let i = 0; i < numParticles; i++) {
            const baseX = 50 + i * particleSpacing;
            const phase = (i / numParticles) * Math.PI * 2 * simB_wavelength - simBTime;
            const displacement = Math.sin(phase) * simB_amplitude;
            const x = baseX + displacement;
            const y = longCanvas.height / 2;
            
            const density = Math.abs(Math.cos(phase));
            const size = 3 + density * 3;
            const alpha = 0.4 + density * 0.6;
            
            longCtx.fillStyle = `rgba(76, 175, 80, ${alpha})`;
            longCtx.beginPath();
            longCtx.arc(x, y, size, 0, Math.PI * 2);
            longCtx.fill();
            
            if (i % 5 === 0) {
                longCtx.strokeStyle = '#ddd';
                longCtx.lineWidth = 1;
                longCtx.beginPath();
                longCtx.moveTo(baseX, 15);
                longCtx.lineTo(baseX, longCanvas.height - 15);
                longCtx.stroke();
            }
            
            densityRegions.push({ x: baseX, density: density, phase: phase });
        }
        
        // å¯†ãƒ»ç–ãƒ©ãƒ™ãƒ«
        longCtx.font = '12px sans-serif';
        for (let i = 0; i < densityRegions.length; i++) {
            const d = densityRegions[i];
            if (d.density > 0.8) {
                longCtx.fillStyle = '#4CAF50';
                longCtx.fillText('å¯†', d.x - 8, longCanvas.height - 8);
            } else if (d.density < 0.2 && i > 0) {
                longCtx.fillStyle = '#ff9800';
                longCtx.fillText('ç–', d.x - 8, longCanvas.height - 8);
            }
        }
        
        // â‘¢ æ¨ªæ³¢è¡¨è¨˜
        transCtx.clearRect(0, 0, transCanvas.width, transCanvas.height);
        
        // ã‚°ãƒªãƒƒãƒ‰
        transCtx.strokeStyle = '#eee';
        transCtx.lineWidth = 1;
        for (let i = 0; i <= 10; i++) {
            const y = 25 + (transCanvas.height - 50) * (i / 10);
            transCtx.beginPath();
            transCtx.moveTo(50, y);
            transCtx.lineTo(canvasWidth - 50, y);
            transCtx.stroke();
        }
        
        // ä¸­å¿ƒç·š
        transCtx.strokeStyle = '#333';
        transCtx.lineWidth = 2;
        transCtx.beginPath();
        transCtx.moveTo(50, transCanvas.height / 2);
        transCtx.lineTo(canvasWidth - 50, transCanvas.height / 2);
        transCtx.stroke();
        
        // æ¨ªæ³¢ã‚°ãƒ©ãƒ•
        transCtx.strokeStyle = '#E91E63';
        transCtx.lineWidth = 3;
        transCtx.beginPath();
        
        for (let i = 0; i < numParticles; i++) {
            const x = 50 + i * particleSpacing;
            const phase = (i / numParticles) * Math.PI * 2 * simB_wavelength - simBTime;
            const displacement = Math.sin(phase) * simB_amplitude;
            const y = transCanvas.height / 2 - displacement;
            
            if (i === 0) {
                transCtx.moveTo(x, y);
            } else {
                transCtx.lineTo(x, y);
            }
        }
        transCtx.stroke();
        
        // å¤‰ä½ã‚’ç¤ºã™ç‚¹ã¨ç·š
        for (let i = 0; i < numParticles; i += 3) {
            const x = 50 + i * particleSpacing;
            const phase = (i / numParticles) * Math.PI * 2 * simB_wavelength - simBTime;
            const displacement = Math.sin(phase) * simB_amplitude;
            const y = transCanvas.height / 2 - displacement;
            
            transCtx.fillStyle = '#E91E63';
            transCtx.beginPath();
            transCtx.arc(x, y, 4, 0, Math.PI * 2);
            transCtx.fill();
            
            transCtx.strokeStyle = 'rgba(233, 30, 99, 0.4)';
            transCtx.lineWidth = 1;
            transCtx.setLineDash([3, 3]);
            transCtx.beginPath();
            transCtx.moveTo(x, transCanvas.height / 2);
            transCtx.lineTo(x, y);
            transCtx.stroke();
            transCtx.setLineDash([]);
        }
        
        // è»¸ãƒ©ãƒ™ãƒ«
        transCtx.fillStyle = '#666';
        transCtx.font = '12px sans-serif';
        transCtx.fillText('å¤‰ä½', 10, transCanvas.height / 2 - 10);
        transCtx.fillText('(æ¨ªæ³¢è¡¨è¨˜)', 5, transCanvas.height / 2 + 15);
        transCtx.fillText('0', 30, transCanvas.height / 2 + 5);
        transCtx.fillText('+', 30, 35);
        transCtx.fillText('-', 30, transCanvas.height - 25);
    }
    
    function animateSimB() {
        if (!simBRunning) return;
        
        simBTime += 0.05 * simB_speed;
        drawSimB();
        simBAnimId = requestAnimationFrame(animateSimB);
    }
    
    // ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³Bã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
    document.getElementById('startBtnB').addEventListener('click', function() {
        simBRunning = true;
        animateSimB();
    });
    
    document.getElementById('stopBtnB').addEventListener('click', function() {
        simBRunning = false;
        if (simBAnimId) {
            cancelAnimationFrame(simBAnimId);
        }
    });
    
    document.getElementById('resetBtnB').addEventListener('click', function() {
        simBRunning = false;
        simBTime = 0;
        if (simBAnimId) {
            cancelAnimationFrame(simBAnimId);
        }
        drawSimB();
    });
    
    document.getElementById('waveSliderB').addEventListener('input', updateSimBParams);
    document.getElementById('ampSliderB').addEventListener('input', updateSimBParams);
    document.getElementById('speedSliderB').addEventListener('input', updateSimBParams);
    
    // =====================================================
    // åˆæœŸåŒ–ã¨ãƒªã‚µã‚¤ã‚ºå¯¾å¿œ
    // =====================================================
    function resizeAllCanvases() {
        resizeWaveGenCanvas();
        resizeWaveStructCanvas();
        resizeSimACanvases();
        resizeSimBCanvases();
        
        drawWaveStructure();
        drawSimA();
        drawSimB();
    }
    
    window.addEventListener('resize', resizeAllCanvases);
    
    // åˆæœŸæç”»
    window.addEventListener('load', function() {
        resizeAllCanvases();
        drawWaveGeneration(); // è§£èª¬ã‚¿ãƒ–ã®å‹•çš„ãƒ„ãƒ¼ãƒ«ã‚’é–‹å§‹
        updateSimAParams();
        updateSimBParams();
    });
    </script>
</body>
</html>